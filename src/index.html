<!doctype html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description"
    content="Real-time cycling power meter with Bluetooth connectivity for tracking power, heart rate, and cadence data" />

  <!-- Cache control for fresh updates -->
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />

  <title>Web Bluetooth Power Meter</title>

  <!-- PWA Manifest -->
  <link rel="manifest" href="manifest.json">

  <!-- Theme color for browser UI -->
  <meta name="theme-color" content="#00ff00">

  <!-- Apple-specific meta tags for iOS PWA -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="Power Meter">
  <link rel="apple-touch-icon" href="icons/icon-152x152.png">
  <link rel="apple-touch-icon" sizes="72x72" href="icons/icon-72x72.png">
  <link rel="apple-touch-icon" sizes="96x96" href="icons/icon-96x96.png">
  <link rel="apple-touch-icon" sizes="128x128" href="icons/icon-128x128.png">
  <link rel="apple-touch-icon" sizes="144x144" href="icons/icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="icons/icon-152x152.png">
  <link rel="apple-touch-icon" sizes="192x192" href="icons/icon-192x192.png">

  <!-- MS Tile for Windows -->
  <meta name="msapplication-TileColor" content="#1a1a1a">
  <meta name="msapplication-TileImage" content="icons/icon-144x144.png">

  <!-- Favicon -->
  <link rel="icon" type="image/png" sizes="32x32" href="icons/icon-72x72.png">

  <link rel="stylesheet" href="styles.css">
  <link rel="stylesheet" href="pwa-styles.css">
</head>

<body>
  <!-- Hamburger Menu -->
  <div class="hamburger-menu">
    <button class="hamburger-button" id="hamburgerButton">
      <div class="hamburger-icon">
        <span class="hamburger-line"></span>
        <span class="hamburger-line"></span>
        <span class="hamburger-line"></span>
      </div>
    </button>
    <div class="menu-dropdown" id="menuDropdown">
      <div class="menu-item" id="togglePowerMetricMenuItem">
        <span class="menu-item-text">‚ö° Power Metric</span>
        <div class="menu-toggle" id="powerMetricToggle">
          <div class="menu-toggle-slider"></div>
        </div>
      </div>
      <div class="menu-item" id="toggleHeartRateMetricMenuItem">
        <span class="menu-item-text">‚ù§Ô∏è Heart Rate Metric</span>
        <div class="menu-toggle" id="heartRateMetricToggle">
          <div class="menu-toggle-slider"></div>
        </div>
      </div>
      <div class="menu-item" id="toggleCadenceMetricMenuItem">
        <span class="menu-item-text">üö¥ Cadence Metric</span>
        <div class="menu-toggle" id="cadenceMetricToggle">
          <div class="menu-toggle-slider"></div>
        </div>
      </div>
      <div class="menu-item" id="togglePowerAveragesMenuItem">
        <span class="menu-item-text">üìä Power Averages</span>
        <div class="menu-toggle" id="powerAveragesToggle">
          <div class="menu-toggle-slider"></div>
        </div>
      </div>
      <div class="menu-item" id="exportMenuItem">
        <span class="menu-item-text">üì§ Export workout data</span>
      </div>
      <div class="menu-item" id="exportUtilsMenuItem">
        <span class="menu-item-text">üõ†Ô∏è Utilities</span>
      </div>
      <div class="menu-item" id="showInfoMenuItem">
        <span class="menu-item-text">‚ÑπÔ∏è App Info</span>
      </div>
    </div>
  </div>

  <main class="dashboard">
    <!-- Row 1: Power Metric -->
    <div class="metric-card power-card">
      <div class="metric-display">
        <button class="metric-connect-button" id="connectButton" data-connected="false"
          aria-label="Connect Power Meter">
          <span class="emoji">‚ö°</span>
          <span class="connect-text">Connect</span>
        </button>
        <div class="metric-value" id="power-value" aria-live="polite">--</div>
        <span class="metric-unit">watts</span>
      </div>
    </div>

    <!-- Row 2: Heart Rate and Cadence -->
    <div class="metrics-row">
      <div class="metric-card hr-card">
        <div class="metric-display">
          <button class="metric-connect-button" id="hrConnectButton" data-connected="false"
            aria-label="Connect Heart Rate">
            <span class="emoji">‚ù§Ô∏è</span>
            <span class="connect-text">Connect</span>
          </button>
          <div class="metric-value" id="hr-value" aria-live="polite">--</div>
          <span class="metric-unit">bpm</span>
        </div>
      </div>

      <div class="metric-card cadence-card">
        <div class="metric-display">
          <button class="metric-connect-button" id="speedCadenceConnectButton" data-connected="false"
            aria-label="Connect Cadence">
            <span class="emoji">üö¥</span>
            <span class="connect-text">Connect</span>
          </button>
          <div class="metric-value" id="cadence-value" aria-live="polite">--</div>
          <span class="metric-unit">rpm</span>
        </div>
      </div>
    </div>
  </main>

  <!-- Row 3: Power Averages Section - Always Visible -->
  <section class="power-averages-section" id="powerAveragesSection">
    <div class="averages-tables">
      <!-- Short Duration Table -->
      <div class="averages-table-container2">
        <table class="power-averages-table">
          <thead>
            <tr>
              <th></th>
              <th>10s</th>
              <th>20s</th>
              <th>30s</th>
              <th>40s</th>
              <th>50s</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="row-label">Current</td>
              <td><span id="avg10s-current">--</span></td>
              <td><span id="avg20s-current">--</span></td>
              <td><span id="avg30s-current">--</span></td>
              <td><span id="avg40s-current">--</span></td>
              <td><span id="avg50s-current">--</span></td>
            </tr>
            <tr>
              <td class="row-label">Best</td>
              <td><span id="avg10s-best">--</span></td>
              <td><span id="avg20s-best">--</span></td>
              <td><span id="avg30s-best">--</span></td>
              <td><span id="avg40s-best">--</span></td>
              <td><span id="avg50s-best">--</span></td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- Long Duration Table -->
      <div class="averages-table-container2">
        <table class="power-averages-table">
          <thead>
            <tr>
              <th></th>
              <th>1m</th>
              <th>2m</th>
              <th>3m</th>
              <th>4m</th>
              <th>5m</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="row-label">Current</td>
              <td><span id="avg1m-current">--</span></td>
              <td><span id="avg2m-current">--</span></td>
              <td><span id="avg3m-current">--</span></td>
              <td><span id="avg4m-current">--</span></td>
              <td><span id="avg5m-current">--</span></td>
            </tr>
            <tr>
              <td class="row-label">Best</td>
              <td><span id="avg1m-best">--</span></td>
              <td><span id="avg2m-best">--</span></td>
              <td><span id="avg3m-best">--</span></td>
              <td><span id="avg4m-best">--</span></td>
              <td><span id="avg5m-best">--</span></td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </section>

  <script type="module" src="script.js"></script>
</body>

</html>
<!doctype html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Web Bluetooth Power Meter</title>
  <link rel="stylesheet" href="styles.css">
</head>

<body>
  <!-- Hamburger Menu -->
  <div class="hamburger-menu">
    <button class="hamburger-button" id="hamburgerButton">
      <div class="hamburger-icon">
        <span class="hamburger-line"></span>
        <span class="hamburger-line"></span>
        <span class="hamburger-line"></span>
      </div>
    </button>
    <div class="menu-dropdown" id="menuDropdown">
      <div class="menu-item" id="togglePowerAveragesMenuItem">
        <span class="menu-item-text">Power Averages</span>
        <div class="menu-toggle" id="powerAveragesToggle">
          <div class="menu-toggle-slider"></div>
        </div>
      </div>
      <div class="menu-item" id="togglePowerMetricMenuItem">
        <span class="menu-item-text">Power Metric</span>
        <div class="menu-toggle" id="powerMetricToggle">
          <div class="menu-toggle-slider"></div>
        </div>
      </div>
      <div class="menu-item" id="toggleHeartRateMetricMenuItem">
        <span class="menu-item-text">Heart Rate Metric</span>
        <div class="menu-toggle" id="heartRateMetricToggle">
          <div class="menu-toggle-slider"></div>
        </div>
      </div>
      <div class="menu-item" id="toggleCadenceMetricMenuItem">
        <span class="menu-item-text">Cadence Metric</span>
        <div class="menu-toggle" id="cadenceMetricToggle">
          <div class="menu-toggle-slider"></div>
        </div>
      </div>
      <div class="menu-item" id="toggleConnectSectionMenuItem">
        <span class="menu-item-text">Connect Devices</span>
        <div class="menu-toggle" id="connectSectionToggle">
          <div class="menu-toggle-slider"></div>
        </div>
      </div>
      <div class="menu-item" id="toggleExportSectionMenuItem">
        <span class="menu-item-text">Export Data</span>
        <div class="menu-toggle" id="exportSectionToggle">
          <div class="menu-toggle-slider"></div>
        </div>
      </div>
      <div class="menu-item" id="toggleSpyModeMenuItem">
        <span class="menu-item-text">üïµÔ∏è Spy Mode</span>
        <div class="menu-toggle" id="spyModeToggle">
          <div class="menu-toggle-slider"></div>
        </div>
      </div>
      <div class="menu-item" id="showInfoMenuItem">
        <span class="menu-item-text">‚ÑπÔ∏è App Info</span>
      </div>
      <div class="menu-item" id="showQrCodeMenuItem">
        <span class="menu-item-text">üì± Share QR Code</span>
      </div>
    </div>
  </div>

  <main class="dashboard">
    <div class="metrics-grid" role="group" aria-label="Power meter metrics">
      <div class="metric-card power-card">
        <div class="metric-row">
          <div class="metric-value" id="power-value" aria-live="polite">--</div>
          <div class="metric-info">
            <div class="metric-label">Power Output</div>
            <div class="metric-unit">Watts</div>
          </div>
        </div>
      </div>

      <div class="metric-card hr-card">
        <div class="metric-row">
          <div class="metric-value" id="hr-value" aria-live="polite">--</div>
          <div class="metric-info">
            <div class="metric-label">Heart Rate</div>
            <div class="metric-unit">BPM</div>
          </div>
        </div>
        <div class="status-text" id="hrStatus"></div>
      </div>

      <div class="metric-card cadence-card">
        <div class="metric-row">
          <div class="metric-value" id="cadence-value" aria-live="polite">--</div>
          <div class="metric-info">
            <div class="metric-label">Cadence</div>
            <div class="metric-unit">RPM</div>
          </div>
        </div>
        <div class="status-text" id="cadenceStatus"></div>
      </div>

    </div>
  </main>

  <!-- Spy Mode Section -->
  <section class="spy-mode-section" id="spyModeSection">
    <div class="spy-content">
      <div class="metric-card spy-card" title="Click to connect to spy power meter" role="button" tabindex="0"
        aria-label="Connect to spy power meter">
        <div class="metric-row">
          <div class="metric-value" id="spy-value" aria-live="polite">--</div>
          <div class="metric-info">
            <div class="metric-label">üïµÔ∏è Spy Power</div>
            <div class="metric-unit">Watts</div>
          </div>
        </div>
        <div class="status-text" id="spyStatus"></div>
        <div class="spy-instructions" id="spyInstructions">
          Click to connect</div>
      </div>
    </div>
    </div>

    <!-- Power Averages Section -->
    <section class="power-averages-section" id="powerAveragesSection">
      <div class="averages-tables">
        <!-- Short Duration Table -->
        <div class="averages-table-container2">
          <table class="power-averages-table">
            <thead>
              <tr>
                <th>Power averages</th>
                <th>10s</th>
                <th>30s</th>
                <th>1m</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="row-label">Current</td>
                <td><span id="avg10s-current">--</span> W</td>
                <td><span id="avg30s-current">--</span> W</td>
                <td><span id="avg1m-current">--</span> W</td>
              </tr>
              <tr>
                <td class="row-label">Best</td>
                <td><span id="avg10s-best">--</span> W</td>
                <td><span id="avg30s-best">--</span> W</td>
                <td><span id="avg1m-best">--</span> W</td>
              </tr>
            </tbody>
          </table>
        </div>

        <!-- Long Duration Table -->
        <div class="averages-table-container2">
          <table class="power-averages-table">
            <thead>
              <tr>
                <th>Power averages</th>
                <th>2m</th>
                <th>4m</th>
                <th>8m</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="row-label">Current</td>
                <td><span id="avg2m-current">--</span> W</td>
                <td><span id="avg4m-current">--</span> W</td>
                <td><span id="avg8m-current">--</span> W</td>
              </tr>
              <tr>
                <td class="row-label">Best</td>
                <td><span id="avg2m-best">--</span> W</td>
                <td><span id="avg4m-best">--</span> W</td>
                <td><span id="avg8m-best">--</span> W</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      </div>

      <!-- Bottom Controls - Always Visible -->
      <div class="bottom-controls">
        <!-- Connect Controls Section -->
        <section class="controls-container" id="connectSection">
          <header class="section-header">
            <button id="toggleConnectSection" class="section-toggle-button" aria-expanded="true"
              aria-controls="connectSection">
              <span id="connectToggleText">Hide Connect Devices</span>
              <span class="toggle-icon" aria-hidden="true">‚ñ≤</span>
            </button>
          </header>
          <button id="connectButton">
            Connect Power Meter
            <div class="status-text" id="status">Disconnected</div>
            <div class="device-name" id="device-name"></div>
          </button>
          <button id="hrConnectButton">
            Connect Heart Rate Monitor
            <div class="status-text" id="hrConnectionStatus">Disconnected</div>
            <div class="device-name" id="hrDeviceName"></div>
          </button>
          <button id="speedCadenceConnectButton">
            Connect Speed & Cadence
            <div class="status-text" id="cadenceConnectionStatus">Disconnected</div>
            <div class="device-name" id="cadenceDeviceName"></div>
          </button>
      </div>

      <!-- Export Controls Section -->
      <section class="export-section" id="exportSection">
        <header class="section-header">
          <button id="toggleExportSection" class="section-toggle-button" aria-expanded="false"
            aria-controls="export-buttons">
            <span id="exportToggleText">Hide Export Data</span>
            <span class="toggle-icon" aria-hidden="true">‚ñ≤</span>
          </button>
        </header>
        <div class="export-buttons" id="export-buttons">
          <button id="exportJsonButton">Export Summary JSON</button>
          <button id="exportCsvButton">Export Summary CSV</button>
          <button id="exportTcxButton">Export TCX</button>
          <button id="exportRawJsonButton">Export Raw Measurements JSON</button>
          <button id="exportRawCsvButton">Export Raw Measurements CSV</button>
          <button id="exportImageButton" aria-label="Export summary as image">
            üìä Export Summary Image
          </button>
          <button id="clearSessionButton" aria-label="Clear all session data">
            Clear Session Data
          </button>
        </div>
        </div>
        </div>

        <script type="module" src="script.js"></script>
</body>

</html>
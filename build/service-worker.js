(()=>{var e=globalThis,t={},r={},c=e.parcelRequire7677;null==c&&((c=function(e){if(e in t)return t[e].exports;if(e in r){var c=r[e];delete r[e];var n={id:e,exports:{}};return t[e]=n,c.call(n.exports,n,n.exports),n.exports}var s=Error("Cannot find module '"+e+"'");throw s.code="MODULE_NOT_FOUND",s}).register=function(e,t){r[e]=t},e.parcelRequire7677=c),(0,c.register)("ezAIq",function(e,t){let r="1761050056410",c=`power-meter-static-${r}`,n=`power-meter-dynamic-${r}`,s=["./","./index.html"];self.addEventListener("install",e=>{console.log("[Service Worker] Installing..."),e.waitUntil(caches.open(c).then(e=>(console.log("[Service Worker] Caching static assets"),e.addAll(s))).then(()=>(console.log("[Service Worker] Skip waiting"),self.skipWaiting())).catch(e=>{console.error("[Service Worker] Installation failed:",e)}))}),self.addEventListener("activate",e=>{console.log("[Service Worker] Activating..."),e.waitUntil(caches.keys().then(e=>Promise.all(e.map(e=>{if(e.startsWith("power-meter-")&&e!==c&&e!==n)return console.log("[Service Worker] Deleting old cache:",e),caches.delete(e)}))).then(()=>(console.log("[Service Worker] Claiming clients"),self.clients.claim())))}),self.addEventListener("fetch",e=>{if("GET"!==e.request.method||!e.request.url.startsWith("http"))return;let t=new URL(e.request.url);if(e.request.headers.get("accept")?.includes("text/html")||t.pathname.endsWith(".html")||"/"===t.pathname||"/index.html"===t.pathname)return void e.respondWith(fetch(e.request).then(t=>{if(t&&200===t.status){let r=t.clone();caches.open(c).then(t=>{t.put(e.request,r)})}return t}).catch(()=>caches.match(e.request).then(t=>t?(console.log("[Service Worker] Serving HTML from cache (offline):",e.request.url),t):caches.match("./index.html"))));e.respondWith(caches.match(e.request).then(t=>t?(console.log("[Service Worker] Serving from cache:",e.request.url),t):fetch(e.request.clone()).then(t=>{if(!t||200!==t.status||"error"===t.type)return t;let r=t.clone();return caches.open(n).then(t=>{console.log("[Service Worker] Caching new resource:",e.request.url),t.put(e.request,r)}),t}).catch(e=>(console.error("[Service Worker] Fetch failed:",e),caches.match("./index.html")))))}),self.addEventListener("message",e=>{e.data&&"SKIP_WAITING"===e.data.type&&self.skipWaiting(),e.data&&"CLEAR_CACHE"===e.data.type&&e.waitUntil(caches.keys().then(e=>Promise.all(e.map(e=>{if(e.startsWith("power-meter-"))return console.log("[Service Worker] Clearing cache:",e),caches.delete(e)}))).then(()=>{console.log("[Service Worker] All caches cleared"),self.clients.matchAll().then(e=>{e.forEach(e=>{e.postMessage({type:"CACHE_CLEARED"})})})}))})}),c("ezAIq")})();
//# sourceMappingURL=service-worker.js.map

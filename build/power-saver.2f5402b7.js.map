{"mappings":"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","sources":["<anon>","src/script.js","src/session-data.js","src/power-averaging.js","src/ui-management.js","src/bluetooth-connections.js","src/heart-rate.js","src/wake-lock.js","src/export-modals.js","src/data-export.js","src/create-tcx.js","src/create-image.js","src/notifications.js","src/ui-event-handlers.js","src/app-info-modal.js","src/qr-code-modal.js"],"sourcesContent":["/**\n * Power Saver Main Application\n * Coordinates all modules and manages the application state\n */ // Import all required modules\n// Data Persistence Functions\nconst $cc35ee5c64337d79$var$SESSION_STORAGE_KEY = 'powerMeterSession';\nconst $cc35ee5c64337d79$var$SESSION_TIMEOUT = 86400000; // 24 hours in milliseconds\n/**\n * Save current session data to localStorage\n * @param {Object} dataStore - Object containing all session data\n */ function $cc35ee5c64337d79$export$3b97cfd23e0d13d8(dataStore) {\n    try {\n        const sessionData = {\n            timestamp: Date.now(),\n            powerData: dataStore.powerData,\n            heartData: dataStore.heartData,\n            cadenceData: dataStore.cadenceData,\n            rawPowerMeasurements: dataStore.rawPowerMeasurements,\n            powerReadings: dataStore.getPowerReadings(),\n            powerAverages: dataStore.getPowerAverages(),\n            lastPowerValue: dataStore.lastPowerValue,\n            lastHeartRateValue: dataStore.lastHeartRateValue,\n            lastCadenceValue: dataStore.lastCadenceValue,\n            sessionStartTime: dataStore.sessionStartTime\n        };\n        localStorage.setItem($cc35ee5c64337d79$var$SESSION_STORAGE_KEY, JSON.stringify(sessionData));\n    } catch (error) {\n        console.warn('Failed to save session data:', error);\n    }\n}\n/**\n * Load session data from localStorage if available and recent\n * Returns the session data object if available, null if not\n */ function $cc35ee5c64337d79$export$5ae208508f6870b() {\n    try {\n        const savedData = localStorage.getItem($cc35ee5c64337d79$var$SESSION_STORAGE_KEY);\n        if (!savedData) return null;\n        const sessionData = JSON.parse(savedData);\n        const now = Date.now();\n        // Check if session is too old (older than 24 hours)\n        if (now - sessionData.timestamp > $cc35ee5c64337d79$var$SESSION_TIMEOUT) {\n            localStorage.removeItem($cc35ee5c64337d79$var$SESSION_STORAGE_KEY);\n            return null;\n        }\n        return sessionData;\n    } catch (error) {\n        console.warn('Failed to load session data:', error);\n        localStorage.removeItem($cc35ee5c64337d79$var$SESSION_STORAGE_KEY);\n        return null;\n    }\n}\n/**\n * Clear session data from localStorage\n */ function $cc35ee5c64337d79$export$37b6cafab9b29f47() {\n    localStorage.removeItem($cc35ee5c64337d79$var$SESSION_STORAGE_KEY);\n}\n\n\n/**\n * Power Averaging Module\n * Handles power data collection, averaging calculations, and display updates\n */ // Power averaging data structures\nlet $d8d8e1ee9f4f63bb$var$powerReadings = []; // Array to store timestamped power readings\nlet $d8d8e1ee9f4f63bb$var$powerAverages = {\n    '10s': {\n        current: 0,\n        best: 0\n    },\n    '20s': {\n        current: 0,\n        best: 0\n    },\n    '30s': {\n        current: 0,\n        best: 0\n    },\n    '40s': {\n        current: 0,\n        best: 0\n    },\n    '50s': {\n        current: 0,\n        best: 0\n    },\n    '1m': {\n        current: 0,\n        best: 0\n    },\n    '2m': {\n        current: 0,\n        best: 0\n    },\n    '3m': {\n        current: 0,\n        best: 0\n    },\n    '4m': {\n        current: 0,\n        best: 0\n    },\n    '5m': {\n        current: 0,\n        best: 0\n    }\n};\n// DOM elements for power averages display\nlet $d8d8e1ee9f4f63bb$var$avg10sCurrentElement, $d8d8e1ee9f4f63bb$var$avg10sBestElement;\nlet $d8d8e1ee9f4f63bb$var$avg20sCurrentElement, $d8d8e1ee9f4f63bb$var$avg20sBestElement;\nlet $d8d8e1ee9f4f63bb$var$avg30sCurrentElement, $d8d8e1ee9f4f63bb$var$avg30sBestElement;\nlet $d8d8e1ee9f4f63bb$var$avg40sCurrentElement, $d8d8e1ee9f4f63bb$var$avg40sBestElement;\nlet $d8d8e1ee9f4f63bb$var$avg50sCurrentElement, $d8d8e1ee9f4f63bb$var$avg50sBestElement;\nlet $d8d8e1ee9f4f63bb$var$avg1mCurrentElement, $d8d8e1ee9f4f63bb$var$avg1mBestElement;\nlet $d8d8e1ee9f4f63bb$var$avg2mCurrentElement, $d8d8e1ee9f4f63bb$var$avg2mBestElement;\nlet $d8d8e1ee9f4f63bb$var$avg3mCurrentElement, $d8d8e1ee9f4f63bb$var$avg3mBestElement;\nlet $d8d8e1ee9f4f63bb$var$avg4mCurrentElement, $d8d8e1ee9f4f63bb$var$avg4mBestElement;\nlet $d8d8e1ee9f4f63bb$var$avg5mCurrentElement, $d8d8e1ee9f4f63bb$var$avg5mBestElement;\nfunction $d8d8e1ee9f4f63bb$export$38b6955d4a0211f4() {\n    // Get DOM elements\n    $d8d8e1ee9f4f63bb$var$avg10sCurrentElement = document.getElementById('avg10s-current');\n    $d8d8e1ee9f4f63bb$var$avg10sBestElement = document.getElementById('avg10s-best');\n    $d8d8e1ee9f4f63bb$var$avg20sCurrentElement = document.getElementById('avg20s-current');\n    $d8d8e1ee9f4f63bb$var$avg20sBestElement = document.getElementById('avg20s-best');\n    $d8d8e1ee9f4f63bb$var$avg30sCurrentElement = document.getElementById('avg30s-current');\n    $d8d8e1ee9f4f63bb$var$avg30sBestElement = document.getElementById('avg30s-best');\n    $d8d8e1ee9f4f63bb$var$avg40sCurrentElement = document.getElementById('avg40s-current');\n    $d8d8e1ee9f4f63bb$var$avg40sBestElement = document.getElementById('avg40s-best');\n    $d8d8e1ee9f4f63bb$var$avg50sCurrentElement = document.getElementById('avg50s-current');\n    $d8d8e1ee9f4f63bb$var$avg50sBestElement = document.getElementById('avg50s-best');\n    $d8d8e1ee9f4f63bb$var$avg1mCurrentElement = document.getElementById('avg1m-current');\n    $d8d8e1ee9f4f63bb$var$avg1mBestElement = document.getElementById('avg1m-best');\n    $d8d8e1ee9f4f63bb$var$avg2mCurrentElement = document.getElementById('avg2m-current');\n    $d8d8e1ee9f4f63bb$var$avg2mBestElement = document.getElementById('avg2m-best');\n    $d8d8e1ee9f4f63bb$var$avg3mCurrentElement = document.getElementById('avg3m-current');\n    $d8d8e1ee9f4f63bb$var$avg3mBestElement = document.getElementById('avg3m-best');\n    $d8d8e1ee9f4f63bb$var$avg4mCurrentElement = document.getElementById('avg4m-current');\n    $d8d8e1ee9f4f63bb$var$avg4mBestElement = document.getElementById('avg4m-best');\n    $d8d8e1ee9f4f63bb$var$avg5mCurrentElement = document.getElementById('avg5m-current');\n    $d8d8e1ee9f4f63bb$var$avg5mBestElement = document.getElementById('avg5m-best');\n}\nfunction $d8d8e1ee9f4f63bb$export$3f67e616c0b42d09(power) {\n    const now = Date.now();\n    $d8d8e1ee9f4f63bb$var$powerReadings.push({\n        timestamp: now,\n        power: power\n    });\n    // Keep only the last 5 minutes of readings (plus some buffer)\n    const fiveMinutesAgo = now - 360000; // 6 minutes to be safe\n    $d8d8e1ee9f4f63bb$var$powerReadings = $d8d8e1ee9f4f63bb$var$powerReadings.filter((reading)=>reading.timestamp > fiveMinutesAgo);\n    // Calculate current averages\n    $d8d8e1ee9f4f63bb$var$calculatePowerAverages();\n    $d8d8e1ee9f4f63bb$var$updatePowerAveragesDisplay();\n}\n/**\n * Calculate power averages for all time periods\n */ function $d8d8e1ee9f4f63bb$var$calculatePowerAverages() {\n    const now = Date.now();\n    const periods = {\n        '10s': 10000,\n        '20s': 20000,\n        '30s': 30000,\n        '40s': 40000,\n        '50s': 50000,\n        '1m': 60000,\n        '2m': 120000,\n        '3m': 180000,\n        '4m': 240000,\n        '5m': 300000\n    };\n    for (const [periodKey, periodMs] of Object.entries(periods)){\n        const cutoffTime = now - periodMs;\n        const relevantReadings = $d8d8e1ee9f4f63bb$var$powerReadings.filter((reading)=>reading.timestamp >= cutoffTime);\n        if (relevantReadings.length > 0) {\n            const sum = relevantReadings.reduce((total, reading)=>total + reading.power, 0);\n            const average = Math.round(sum / relevantReadings.length);\n            $d8d8e1ee9f4f63bb$var$powerAverages[periodKey].current = average;\n            // Update best if current is better\n            if (average > $d8d8e1ee9f4f63bb$var$powerAverages[periodKey].best) $d8d8e1ee9f4f63bb$var$powerAverages[periodKey].best = average;\n        } else $d8d8e1ee9f4f63bb$var$powerAverages[periodKey].current = 0;\n    }\n}\n/**\n * Update the power averages display in the UI\n */ function $d8d8e1ee9f4f63bb$var$updatePowerAveragesDisplay() {\n    if (!$d8d8e1ee9f4f63bb$var$avg10sCurrentElement) return; // Elements not initialized\n    $d8d8e1ee9f4f63bb$var$avg10sCurrentElement.textContent = $d8d8e1ee9f4f63bb$var$powerAverages['10s'].current || '--';\n    $d8d8e1ee9f4f63bb$var$avg10sBestElement.textContent = $d8d8e1ee9f4f63bb$var$powerAverages['10s'].best || '--';\n    $d8d8e1ee9f4f63bb$var$avg20sCurrentElement.textContent = $d8d8e1ee9f4f63bb$var$powerAverages['20s'].current || '--';\n    $d8d8e1ee9f4f63bb$var$avg20sBestElement.textContent = $d8d8e1ee9f4f63bb$var$powerAverages['20s'].best || '--';\n    $d8d8e1ee9f4f63bb$var$avg30sCurrentElement.textContent = $d8d8e1ee9f4f63bb$var$powerAverages['30s'].current || '--';\n    $d8d8e1ee9f4f63bb$var$avg30sBestElement.textContent = $d8d8e1ee9f4f63bb$var$powerAverages['30s'].best || '--';\n    $d8d8e1ee9f4f63bb$var$avg40sCurrentElement.textContent = $d8d8e1ee9f4f63bb$var$powerAverages['40s'].current || '--';\n    $d8d8e1ee9f4f63bb$var$avg40sBestElement.textContent = $d8d8e1ee9f4f63bb$var$powerAverages['40s'].best || '--';\n    $d8d8e1ee9f4f63bb$var$avg50sCurrentElement.textContent = $d8d8e1ee9f4f63bb$var$powerAverages['50s'].current || '--';\n    $d8d8e1ee9f4f63bb$var$avg50sBestElement.textContent = $d8d8e1ee9f4f63bb$var$powerAverages['50s'].best || '--';\n    $d8d8e1ee9f4f63bb$var$avg1mCurrentElement.textContent = $d8d8e1ee9f4f63bb$var$powerAverages['1m'].current || '--';\n    $d8d8e1ee9f4f63bb$var$avg1mBestElement.textContent = $d8d8e1ee9f4f63bb$var$powerAverages['1m'].best || '--';\n    $d8d8e1ee9f4f63bb$var$avg2mCurrentElement.textContent = $d8d8e1ee9f4f63bb$var$powerAverages['2m'].current || '--';\n    $d8d8e1ee9f4f63bb$var$avg2mBestElement.textContent = $d8d8e1ee9f4f63bb$var$powerAverages['2m'].best || '--';\n    $d8d8e1ee9f4f63bb$var$avg3mCurrentElement.textContent = $d8d8e1ee9f4f63bb$var$powerAverages['3m'].current || '--';\n    $d8d8e1ee9f4f63bb$var$avg3mBestElement.textContent = $d8d8e1ee9f4f63bb$var$powerAverages['3m'].best || '--';\n    $d8d8e1ee9f4f63bb$var$avg4mCurrentElement.textContent = $d8d8e1ee9f4f63bb$var$powerAverages['4m'].current || '--';\n    $d8d8e1ee9f4f63bb$var$avg4mBestElement.textContent = $d8d8e1ee9f4f63bb$var$powerAverages['4m'].best || '--';\n    $d8d8e1ee9f4f63bb$var$avg5mCurrentElement.textContent = $d8d8e1ee9f4f63bb$var$powerAverages['5m'].current || '--';\n    $d8d8e1ee9f4f63bb$var$avg5mBestElement.textContent = $d8d8e1ee9f4f63bb$var$powerAverages['5m'].best || '--';\n}\nfunction $d8d8e1ee9f4f63bb$export$153010588d52d05c() {\n    $d8d8e1ee9f4f63bb$var$powerReadings = [];\n    for (const period of Object.keys($d8d8e1ee9f4f63bb$var$powerAverages)){\n        $d8d8e1ee9f4f63bb$var$powerAverages[period].current = 0;\n        $d8d8e1ee9f4f63bb$var$powerAverages[period].best = 0;\n    }\n    $d8d8e1ee9f4f63bb$var$updatePowerAveragesDisplay();\n}\nfunction $d8d8e1ee9f4f63bb$export$2a4541f58dbec1bb() {\n    return {\n        ...$d8d8e1ee9f4f63bb$var$powerAverages\n    };\n}\nfunction $d8d8e1ee9f4f63bb$export$2abb6eba483cf221(averages) {\n    Object.assign($d8d8e1ee9f4f63bb$var$powerAverages, averages);\n    $d8d8e1ee9f4f63bb$var$updatePowerAveragesDisplay();\n}\nfunction $d8d8e1ee9f4f63bb$export$329e6150de04eb88() {\n    return [\n        ...$d8d8e1ee9f4f63bb$var$powerReadings\n    ];\n}\nfunction $d8d8e1ee9f4f63bb$export$60ad2ad39402c700(readings) {\n    $d8d8e1ee9f4f63bb$var$powerReadings = [\n        ...readings\n    ];\n}\nfunction $d8d8e1ee9f4f63bb$export$d710e02c06779035() {\n    $d8d8e1ee9f4f63bb$var$updatePowerAveragesDisplay();\n}\n\n\n/**\n * UI Management Module\n * Handles DOM element references, event listeners, and UI state management\n */ // DOM element references\nconst $26bf0f38c1315f82$export$7a5d735b2ab6389d = {\n    // Main metric displays\n    powerValueElement: null,\n    hrValueElement: null,\n    cadenceValueElement: null,\n    // Device info displays\n    deviceNameElement: null,\n    hrDeviceName: null,\n    cadenceDeviceName: null,\n    // Status displays\n    statusText: null,\n    hrStatusText: null,\n    cadenceStatusText: null,\n    hrConnectionStatus: null,\n    cadenceConnectionStatus: null,\n    // Buttons\n    powerMeterConnectButton: null,\n    hrConnectButton: null,\n    speedCadenceConnectButton: null,\n    exportButtons: {\n        json: null,\n        csv: null,\n        tcx: null,\n        rawJson: null,\n        rawCsv: null,\n        image: null,\n        clearSession: null,\n        googleDocs: null,\n        googleSheets: null,\n        googleAuth: null,\n        configureGoogleApi: null,\n        intervals: null,\n        configureIntervals: null\n    },\n    // Toggle elements\n    powerAveragesSection: null,\n    // Hamburger menu elements\n    hamburgerBtn: null,\n    menuDropdown: null,\n    powerAveragesToggle: null,\n    powerMetricToggle: null,\n    heartRateMetricToggle: null,\n    cadenceMetricToggle: null,\n    showInfoMenuItem: null,\n    showQrCodeMenuItem: null,\n    spyModeToggle: null,\n    // Metric card elements\n    powerCard: null,\n    heartRateCard: null,\n    cadenceCard: null,\n    spyCard: null,\n    spyModeSection: null,\n    // Spy mode elements\n    spyValueElement: null,\n    spyStatusElement: null,\n    spyInstructionsElement: null\n};\nfunction $26bf0f38c1315f82$export$a57455d21a15702b() {\n    // Main metric displays\n    $26bf0f38c1315f82$export$7a5d735b2ab6389d.powerValueElement = document.getElementById('power-value');\n    $26bf0f38c1315f82$export$7a5d735b2ab6389d.hrValueElement = document.getElementById('hr-value');\n    $26bf0f38c1315f82$export$7a5d735b2ab6389d.cadenceValueElement = document.getElementById('cadence-value');\n    // Device info displays\n    $26bf0f38c1315f82$export$7a5d735b2ab6389d.deviceNameElement = document.getElementById('device-name');\n    $26bf0f38c1315f82$export$7a5d735b2ab6389d.hrDeviceName = document.getElementById('hrDeviceName');\n    $26bf0f38c1315f82$export$7a5d735b2ab6389d.cadenceDeviceName = document.getElementById('cadenceDeviceName');\n    // Status displays\n    $26bf0f38c1315f82$export$7a5d735b2ab6389d.statusText = document.getElementById('status');\n    $26bf0f38c1315f82$export$7a5d735b2ab6389d.hrStatusText = document.getElementById('hrStatus');\n    $26bf0f38c1315f82$export$7a5d735b2ab6389d.cadenceStatusText = document.getElementById('cadenceStatus');\n    $26bf0f38c1315f82$export$7a5d735b2ab6389d.hrConnectionStatus = document.getElementById('hrConnectionStatus');\n    $26bf0f38c1315f82$export$7a5d735b2ab6389d.cadenceConnectionStatus = document.getElementById('cadenceConnectionStatus');\n    // Buttons\n    $26bf0f38c1315f82$export$7a5d735b2ab6389d.powerMeterConnectButton = document.getElementById('connectButton');\n    $26bf0f38c1315f82$export$7a5d735b2ab6389d.hrConnectButton = document.getElementById('hrConnectButton');\n    $26bf0f38c1315f82$export$7a5d735b2ab6389d.speedCadenceConnectButton = document.getElementById('speedCadenceConnectButton');\n    // Toggle elements\n    $26bf0f38c1315f82$export$7a5d735b2ab6389d.powerAveragesSection = document.getElementById('powerAveragesSection');\n    // Hamburger menu elements\n    $26bf0f38c1315f82$export$7a5d735b2ab6389d.hamburgerBtn = document.getElementById('hamburgerButton');\n    $26bf0f38c1315f82$export$7a5d735b2ab6389d.menuDropdown = document.getElementById('menuDropdown');\n    $26bf0f38c1315f82$export$7a5d735b2ab6389d.powerAveragesToggle = document.getElementById('powerAveragesToggle');\n    $26bf0f38c1315f82$export$7a5d735b2ab6389d.powerMetricToggle = document.getElementById('powerMetricToggle');\n    $26bf0f38c1315f82$export$7a5d735b2ab6389d.heartRateMetricToggle = document.getElementById('heartRateMetricToggle');\n    $26bf0f38c1315f82$export$7a5d735b2ab6389d.cadenceMetricToggle = document.getElementById('cadenceMetricToggle');\n    $26bf0f38c1315f82$export$7a5d735b2ab6389d.showInfoMenuItem = document.getElementById('showInfoMenuItem');\n    $26bf0f38c1315f82$export$7a5d735b2ab6389d.showQrCodeMenuItem = document.getElementById('showQrCodeMenuItem');\n    $26bf0f38c1315f82$export$7a5d735b2ab6389d.spyModeToggle = document.getElementById('spyModeToggle');\n    // Metric card elements\n    $26bf0f38c1315f82$export$7a5d735b2ab6389d.powerCard = document.querySelector('.power-card');\n    $26bf0f38c1315f82$export$7a5d735b2ab6389d.heartRateCard = document.querySelector('.hr-card');\n    $26bf0f38c1315f82$export$7a5d735b2ab6389d.cadenceCard = document.querySelector('.cadence-card');\n    $26bf0f38c1315f82$export$7a5d735b2ab6389d.spyCard = document.querySelector('.spy-card');\n    $26bf0f38c1315f82$export$7a5d735b2ab6389d.spyModeSection = document.getElementById('spyModeSection');\n    // Spy mode elements\n    $26bf0f38c1315f82$export$7a5d735b2ab6389d.spyValueElement = document.getElementById('spy-value');\n    $26bf0f38c1315f82$export$7a5d735b2ab6389d.spyStatusElement = document.getElementById('spyStatus');\n    $26bf0f38c1315f82$export$7a5d735b2ab6389d.spyInstructionsElement = document.getElementById('spyInstructions');\n    // Initialize connection status to disconnected state\n    if ($26bf0f38c1315f82$export$7a5d735b2ab6389d.hrConnectionStatus) $26bf0f38c1315f82$export$7a5d735b2ab6389d.hrConnectionStatus.textContent = 'Disconnected';\n    if ($26bf0f38c1315f82$export$7a5d735b2ab6389d.cadenceConnectionStatus) $26bf0f38c1315f82$export$7a5d735b2ab6389d.cadenceConnectionStatus.textContent = 'Disconnected';\n}\nfunction $26bf0f38c1315f82$export$38408f60e368349d(value) {\n    if (!$26bf0f38c1315f82$export$7a5d735b2ab6389d.powerValueElement) return;\n    const displayValue = value || '--';\n    $26bf0f38c1315f82$export$7a5d735b2ab6389d.powerValueElement.textContent = displayValue;\n    $26bf0f38c1315f82$export$7a5d735b2ab6389d.powerValueElement.setAttribute('data-value', displayValue);\n}\nfunction $26bf0f38c1315f82$export$3c5e864d031b110c(values) {\n    if (values.power !== undefined) $26bf0f38c1315f82$export$38408f60e368349d(values.power);\n    if (values.heartRate !== undefined && $26bf0f38c1315f82$export$7a5d735b2ab6389d.hrValueElement) $26bf0f38c1315f82$export$7a5d735b2ab6389d.hrValueElement.textContent = values.heartRate || '--';\n    if (values.cadence !== undefined && $26bf0f38c1315f82$export$7a5d735b2ab6389d.cadenceValueElement) $26bf0f38c1315f82$export$7a5d735b2ab6389d.cadenceValueElement.textContent = values.cadence || '--';\n}\nfunction $26bf0f38c1315f82$export$d9870def68db0ffb() {\n    $26bf0f38c1315f82$export$38408f60e368349d('--');\n    if ($26bf0f38c1315f82$export$7a5d735b2ab6389d.hrValueElement) $26bf0f38c1315f82$export$7a5d735b2ab6389d.hrValueElement.textContent = '--';\n    if ($26bf0f38c1315f82$export$7a5d735b2ab6389d.cadenceValueElement) $26bf0f38c1315f82$export$7a5d735b2ab6389d.cadenceValueElement.textContent = '--';\n}\nfunction $26bf0f38c1315f82$export$b5051178064abb72() {\n    const now = new Date();\n    const year = now.getFullYear();\n    const month = String(now.getMonth() + 1).padStart(2, '0');\n    const day = String(now.getDate()).padStart(2, '0');\n    return `${year}-${month}-${day}`;\n}\n\n\n/**\n * Bluetooth Power Meter Connection Module\n * Handles Bluetooth connections for power meters, heart rate monitors, and cadence sensors\n */ /**\n * The heart rate measurement is a DataView object.\n * The first byte is a flag, and the subsequent byte(s) are the heart rate value.\n * We need to check the first bit of the flag to see if the value is 8-bit or 16-bit.\n */ function $1e429c7e804734cb$export$c0b45cad129009bc(value) {\n    const flags = value.getUint8(0);\n    // Check if the heart rate value format is UINT16 (bit 0 is 1) or UINT8 (bit 0 is 0)\n    const is16bit = flags & 0x1;\n    if (is16bit) // If 16-bit, read 2 bytes starting from the second byte\n    return value.getUint16(1, /*littleEndian=*/ true);\n    else // If 8-bit, read 1 byte starting from the second byte\n    return value.getUint8(1);\n}\n\n\n/**\n * Screen Wake Lock Management Module\n * Handles requesting and releasing screen wake locks to prevent device sleep during sessions\n */ let $ee8dba17fe5eb4b4$var$wakeLock = null;\nasync function $ee8dba17fe5eb4b4$export$1d0d101be0e1eace() {\n    if ('wakeLock' in navigator) try {\n        $ee8dba17fe5eb4b4$var$wakeLock = await navigator.wakeLock.request('screen');\n        $ee8dba17fe5eb4b4$var$wakeLock.addEventListener('release', ()=>{\n            // Wake lock was released\n            console.log('Wake lock was released');\n        });\n    } catch (err) {\n        console.error(`${err.name}, ${err.message}`);\n    }\n}\nasync function $ee8dba17fe5eb4b4$export$59fac9bdf8c1da6a() {\n    if ($ee8dba17fe5eb4b4$var$wakeLock !== null) {\n        await $ee8dba17fe5eb4b4$var$wakeLock.release();\n        $ee8dba17fe5eb4b4$var$wakeLock = null;\n    }\n}\nfunction $ee8dba17fe5eb4b4$export$9db35d3a32ab0a16() {\n    return $ee8dba17fe5eb4b4$var$wakeLock !== null;\n}\n\n\n// Bluetooth service UUIDs\nconst $305aaf8b9a43c26d$var$CYCLING_POWER_SERVICE_UUID = 'cycling_power';\nconst $305aaf8b9a43c26d$var$CYCLING_POWER_MEASUREMENT_CHARACTERISTIC_UUID = 'cycling_power_measurement';\nconst $305aaf8b9a43c26d$var$CYCLING_POWER_FEATURE_CHARACTERISTIC_UUID = 'cycling_power_feature';\nconst $305aaf8b9a43c26d$var$CYCLING_CADENCE_SERVICE_UUID = 'cycling_speed_and_cadence';\nconst $305aaf8b9a43c26d$var$CSC_MEASUREMENT_CHARACTERISTIC_UUID = 'csc_measurement';\n// Device connection state\nlet $305aaf8b9a43c26d$var$powerMeterDevice = null;\nlet $305aaf8b9a43c26d$var$hrBluetoothDevice = null;\nlet $305aaf8b9a43c26d$var$speedCadenceBluetoothDevice = null;\nlet $305aaf8b9a43c26d$var$spyMeterDevice = null;\n// Store event listener references for proper cleanup\nlet $305aaf8b9a43c26d$var$powerMeterDisconnectHandler = null;\nlet $305aaf8b9a43c26d$var$hrDisconnectHandler = null;\nlet $305aaf8b9a43c26d$var$speedCadenceDisconnectHandler = null;\nlet $305aaf8b9a43c26d$var$spyMeterDisconnectHandler = null;\n// Cadence calculation variables\nlet $305aaf8b9a43c26d$var$lastCrankRevs = 0;\nlet $305aaf8b9a43c26d$var$lastCrankTime = 0;\nlet $305aaf8b9a43c26d$var$cadenceResetTimer = null;\nasync function $305aaf8b9a43c26d$export$7cd63989f2e13954(callbacks, elements) {\n    await (0, $ee8dba17fe5eb4b4$export$1d0d101be0e1eace)();\n    if (!navigator.bluetooth) {\n        callbacks.onStatusUpdate('Web Bluetooth API is not available.');\n        return;\n    }\n    try {\n        callbacks.onStatusUpdate('Scanning for power meters...');\n        // Scan specifically for devices advertising the Cycling Power service\n        $305aaf8b9a43c26d$var$powerMeterDevice = await navigator.bluetooth.requestDevice({\n            filters: [\n                {\n                    services: [\n                        $305aaf8b9a43c26d$var$CYCLING_POWER_SERVICE_UUID\n                    ]\n                }\n            ]\n        });\n        callbacks.onStatusUpdate('Connecting to device...');\n        if (elements.deviceNameElement) elements.deviceNameElement.textContent = `Device: ${$305aaf8b9a43c26d$var$powerMeterDevice.name || 'Unknown Device'}`;\n        $305aaf8b9a43c26d$var$powerMeterDevice.addEventListener('gattserverdisconnected', ()=>{\n            $305aaf8b9a43c26d$var$onPowerMeterDisconnected(callbacks, elements);\n        });\n        const server = await $305aaf8b9a43c26d$var$powerMeterDevice.gatt.connect();\n        const service = await server.getPrimaryService($305aaf8b9a43c26d$var$CYCLING_POWER_SERVICE_UUID);\n        const characteristic = await service.getCharacteristic($305aaf8b9a43c26d$var$CYCLING_POWER_MEASUREMENT_CHARACTERISTIC_UUID);\n        // Check for and subscribe to advanced power features if available\n        try {\n            const featureCharacteristic = await service.getCharacteristic($305aaf8b9a43c26d$var$CYCLING_POWER_FEATURE_CHARACTERISTIC_UUID);\n            // eslint-disable-next-line no-unused-vars\n            const features = await featureCharacteristic.readValue();\n        // This value can be used to determine what the power meter supports,\n        // but for now we just parse what's in the measurement characteristic.\n        } catch  {\n        // Cycling Power Feature characteristic not found\n        }\n        // Subscribe to power measurement notifications\n        await characteristic.startNotifications();\n        characteristic.addEventListener('characteristicvaluechanged', (event)=>{\n            $305aaf8b9a43c26d$var$handlePowerMeasurement(event, callbacks);\n        });\n        callbacks.onStatusUpdate('Connected and receiving data!');\n        if (elements.powerMeterConnectButton) elements.powerMeterConnectButton.disabled = true;\n        return true;\n    } catch (error) {\n        callbacks.onStatusUpdate(`Error: ${error.message}`);\n        console.error('Connection failed:', error);\n        if ($305aaf8b9a43c26d$var$powerMeterDevice) $305aaf8b9a43c26d$var$powerMeterDevice.removeEventListener('gattserverdisconnected', ()=>{\n            $305aaf8b9a43c26d$var$onPowerMeterDisconnected(callbacks, elements);\n        });\n        return false;\n    }\n}\nasync function $305aaf8b9a43c26d$export$830e9b592dbab083(callbacks, elements) {\n    await (0, $ee8dba17fe5eb4b4$export$1d0d101be0e1eace)();\n    if (!navigator.bluetooth) {\n        callbacks.onStatusUpdate('Web Bluetooth API is not available.');\n        return;\n    }\n    try {\n        callbacks.onStatusUpdate('Scanning for devices...');\n        if (elements.hrConnectionStatus) elements.hrConnectionStatus.textContent = 'Connecting...';\n        // Filter for devices that advertise the 'heart_rate' service\n        $305aaf8b9a43c26d$var$hrBluetoothDevice = await navigator.bluetooth.requestDevice({\n            filters: [\n                {\n                    services: [\n                        'heart_rate'\n                    ]\n                }\n            ]\n        });\n        callbacks.onStatusUpdate('Connecting to device...');\n        if (elements.hrDeviceName) elements.hrDeviceName.textContent = `Device: ${$305aaf8b9a43c26d$var$hrBluetoothDevice.name}`;\n        // Add a listener for when the device gets disconnected\n        $305aaf8b9a43c26d$var$hrBluetoothDevice.addEventListener('gattserverdisconnected', ()=>{\n            $305aaf8b9a43c26d$var$onHeartRateDisconnected(callbacks, elements);\n        });\n        const hrServer = await $305aaf8b9a43c26d$var$hrBluetoothDevice.gatt.connect();\n        const hrService = await hrServer.getPrimaryService('heart_rate');\n        const hrCharacteristic = await hrService.getCharacteristic('heart_rate_measurement');\n        // Start notifications to receive heart rate data\n        await hrCharacteristic.startNotifications();\n        hrCharacteristic.addEventListener('characteristicvaluechanged', (event)=>{\n            $305aaf8b9a43c26d$var$handleHeartRateChanged(event, callbacks);\n        });\n        callbacks.onStatusUpdate('Connected!');\n        if (elements.hrConnectionStatus) elements.hrConnectionStatus.textContent = 'Connected';\n        if (elements.hrConnectButton) elements.hrConnectButton.disabled = true;\n        return true;\n    } catch (error) {\n        callbacks.onStatusUpdate(`Error: ${error.message}`);\n        if (elements.hrConnectionStatus) elements.hrConnectionStatus.textContent = 'Connection Failed';\n        console.error('Connection failed:', error);\n        return false;\n    }\n}\nasync function $305aaf8b9a43c26d$export$15696ad475844a91(callbacks, elements) {\n    await (0, $ee8dba17fe5eb4b4$export$1d0d101be0e1eace)();\n    if (!navigator.bluetooth) {\n        callbacks.onStatusUpdate('Web Bluetooth API is not available.');\n        return;\n    }\n    try {\n        callbacks.onStatusUpdate('Scanning for sensors...');\n        if (elements.cadenceConnectionStatus) elements.cadenceConnectionStatus.textContent = 'Connecting...';\n        // Reset cadence variables for clean start\n        if ($305aaf8b9a43c26d$var$cadenceResetTimer) {\n            clearTimeout($305aaf8b9a43c26d$var$cadenceResetTimer);\n            $305aaf8b9a43c26d$var$cadenceResetTimer = null;\n        }\n        $305aaf8b9a43c26d$var$lastCrankRevs = 0;\n        $305aaf8b9a43c26d$var$lastCrankTime = 0;\n        $305aaf8b9a43c26d$var$speedCadenceBluetoothDevice = await navigator.bluetooth.requestDevice({\n            filters: [\n                {\n                    services: [\n                        $305aaf8b9a43c26d$var$CYCLING_CADENCE_SERVICE_UUID\n                    ]\n                }\n            ]\n        });\n        callbacks.onStatusUpdate('Connecting to device...');\n        if (elements.cadenceDeviceName) elements.cadenceDeviceName.textContent = `Device: ${$305aaf8b9a43c26d$var$speedCadenceBluetoothDevice.name}`;\n        $305aaf8b9a43c26d$var$speedCadenceBluetoothDevice.addEventListener('gattserverdisconnected', ()=>{\n            $305aaf8b9a43c26d$var$onCadenceDisconnected(callbacks, elements);\n        });\n        const server = await $305aaf8b9a43c26d$var$speedCadenceBluetoothDevice.gatt.connect();\n        const service = await server.getPrimaryService($305aaf8b9a43c26d$var$CYCLING_CADENCE_SERVICE_UUID);\n        const characteristic = await service.getCharacteristic($305aaf8b9a43c26d$var$CSC_MEASUREMENT_CHARACTERISTIC_UUID);\n        await characteristic.startNotifications();\n        characteristic.addEventListener('characteristicvaluechanged', (event)=>{\n            $305aaf8b9a43c26d$var$handleSpeedCadenceMeasurement(event, callbacks);\n        });\n        callbacks.onStatusUpdate('Connected!');\n        if (elements.cadenceConnectionStatus) elements.cadenceConnectionStatus.textContent = 'Connected';\n        if (elements.speedCadenceConnectButton) elements.speedCadenceConnectButton.disabled = true;\n        return true;\n    } catch (error) {\n        callbacks.onStatusUpdate(`Error: ${error.message}`);\n        if (elements.cadenceConnectionStatus) elements.cadenceConnectionStatus.textContent = 'Connection Failed';\n        console.error('Speed/Cadence connection failed:', error);\n        return false;\n    }\n}\nasync function $305aaf8b9a43c26d$export$bee1a28fa3cc4e9a(callbacks, elements) {\n    if (!navigator.bluetooth) {\n        console.error('Web Bluetooth API is not available.');\n        return;\n    }\n    try {\n        if (elements.spyInstructionsElement) elements.spyInstructionsElement.style.display = 'none';\n        if (elements.spyStatusElement) {\n            elements.spyStatusElement.textContent = 'Scanning for spy power meter...';\n            elements.spyStatusElement.style.display = 'block';\n        }\n        // Scan for devices advertising the Cycling Power service\n        $305aaf8b9a43c26d$var$spyMeterDevice = await navigator.bluetooth.requestDevice({\n            filters: [\n                {\n                    services: [\n                        $305aaf8b9a43c26d$var$CYCLING_POWER_SERVICE_UUID\n                    ]\n                }\n            ]\n        });\n        if (elements.spyStatusElement) elements.spyStatusElement.textContent = 'Connecting to spy device...';\n        $305aaf8b9a43c26d$var$spyMeterDevice.addEventListener('gattserverdisconnected', ()=>{\n            $305aaf8b9a43c26d$var$onSpyDisconnected(elements);\n        });\n        const server = await $305aaf8b9a43c26d$var$spyMeterDevice.gatt.connect();\n        const service = await server.getPrimaryService($305aaf8b9a43c26d$var$CYCLING_POWER_SERVICE_UUID);\n        const characteristic = await service.getCharacteristic($305aaf8b9a43c26d$var$CYCLING_POWER_MEASUREMENT_CHARACTERISTIC_UUID);\n        // Subscribe to power measurement notifications\n        await characteristic.startNotifications();\n        characteristic.addEventListener('characteristicvaluechanged', (event)=>{\n            $305aaf8b9a43c26d$var$handleSpyPowerMeasurement(event, elements);\n        });\n        if (elements.spyStatusElement) {\n            elements.spyStatusElement.textContent = 'Spy connected!';\n            elements.spyStatusElement.style.display = 'none';\n        }\n        return true;\n    } catch (error) {\n        if (elements.spyStatusElement) elements.spyStatusElement.textContent = `Spy Error: ${error.message}`;\n        console.error('Spy connection failed:', error);\n        if ($305aaf8b9a43c26d$var$spyMeterDevice) {\n            $305aaf8b9a43c26d$var$spyMeterDevice.removeEventListener('gattserverdisconnected', ()=>{\n                $305aaf8b9a43c26d$var$onSpyDisconnected(elements);\n            });\n            $305aaf8b9a43c26d$var$spyMeterDevice = null;\n        }\n        // Show instructions again if connection failed\n        setTimeout(()=>{\n            if (elements.spyStatusElement) elements.spyStatusElement.style.display = 'none';\n            if (elements.spyInstructionsElement) elements.spyInstructionsElement.style.display = 'block';\n        }, 3000);\n        return false;\n    }\n}\nfunction $305aaf8b9a43c26d$export$f8a9e6c57769fd82(elements) {\n    if ($305aaf8b9a43c26d$var$spyMeterDevice && $305aaf8b9a43c26d$var$spyMeterDevice.gatt.connected) $305aaf8b9a43c26d$var$spyMeterDevice.gatt.disconnect();\n    $305aaf8b9a43c26d$var$spyMeterDevice = null;\n    if (elements.spyValueElement) elements.spyValueElement.textContent = '--';\n    if (elements.spyStatusElement) elements.spyStatusElement.style.display = 'none';\n    if (elements.spyInstructionsElement) elements.spyInstructionsElement.style.display = 'block';\n}\nfunction $305aaf8b9a43c26d$export$3aa2dffa9bc119b1() {\n    return $305aaf8b9a43c26d$var$powerMeterDevice && $305aaf8b9a43c26d$var$powerMeterDevice.gatt.connected;\n}\nfunction $305aaf8b9a43c26d$export$298d6450d7b1b0fe() {\n    return $305aaf8b9a43c26d$var$spyMeterDevice && $305aaf8b9a43c26d$var$spyMeterDevice.gatt.connected;\n}\n// Event handlers\nfunction $305aaf8b9a43c26d$var$handlePowerMeasurement(event, callbacks) {\n    const value = event.target.value;\n    const timestamp = Date.now();\n    // Store simplified raw measurement data\n    const rawMeasurement = {\n        timestamp: timestamp,\n        flags: value.getUint16(0, true),\n        rawBytes: Array.from(new Uint8Array(value.buffer)).map((b)=>b.toString(16).padStart(2, '0')).join(' '),\n        dataLength: value.byteLength\n    };\n    // The data is a DataView object with a flags field and the power value.\n    // Ref: https://www.bluetooth.com/specifications/gatt/viewer?attributeXmlFile=org.bluetooth.characteristic.cycling_power_measurement.xml\n    // eslint-disable-next-line no-unused-vars\n    const flags = value.getUint16(0, true);\n    let offset = 2;\n    // Power is always present\n    const power = value.getInt16(offset, true);\n    rawMeasurement.instantaneousPower = power;\n    callbacks.onPowerMeasurement(power, rawMeasurement);\n}\nfunction $305aaf8b9a43c26d$var$handleHeartRateChanged(event, callbacks) {\n    const value = event.target.value;\n    const heartRate = (0, $1e429c7e804734cb$export$c0b45cad129009bc)(value);\n    callbacks.onHeartRateChange(heartRate);\n}\nfunction $305aaf8b9a43c26d$var$handleSpeedCadenceMeasurement(event, callbacks) {\n    const value = event.target.value;\n    const flags = value.getUint8(0);\n    let offset = 1;\n    const wheelRevsPresent = flags & 0x01;\n    const crankRevsPresent = flags & 0x02;\n    // Skip wheel revolution data since we don't need speed/distance\n    if (wheelRevsPresent) offset += 6; // Skip wheel data\n    if (crankRevsPresent) {\n        const cumulativeCrankRevolutions = value.getUint16(offset, true);\n        const lastCrankEventTime = value.getUint16(offset + 2, true); // 1/1024 seconds\n        if ($305aaf8b9a43c26d$var$lastCrankRevs > 0) {\n            const revs = cumulativeCrankRevolutions - $305aaf8b9a43c26d$var$lastCrankRevs;\n            const time = (lastCrankEventTime - $305aaf8b9a43c26d$var$lastCrankTime) / 1024; // in seconds\n            if (time > 0) {\n                const cadence = revs / time * 60; // RPM\n                const roundedCadence = Math.round(cadence);\n                callbacks.onCadenceChange(roundedCadence);\n                // Clear any existing reset timer\n                if ($305aaf8b9a43c26d$var$cadenceResetTimer) clearTimeout($305aaf8b9a43c26d$var$cadenceResetTimer);\n                // Set timer to reset cadence to 0 if no new data comes in for 3 seconds\n                $305aaf8b9a43c26d$var$cadenceResetTimer = setTimeout(()=>{\n                    callbacks.onCadenceChange(0);\n                    $305aaf8b9a43c26d$var$cadenceResetTimer = null;\n                }, 3000);\n            }\n        }\n        $305aaf8b9a43c26d$var$lastCrankRevs = cumulativeCrankRevolutions;\n        $305aaf8b9a43c26d$var$lastCrankTime = lastCrankEventTime;\n    }\n}\nfunction $305aaf8b9a43c26d$var$handleSpyPowerMeasurement(event, elements) {\n    const value = event.target.value;\n    const data = new Uint8Array(value.buffer);\n    // Parse cycling power measurement data (same format as main power meter)\n    let instantaneousPower = 0;\n    if (data.length >= 4) // Read instantaneous power (16-bit unsigned integer, little endian)\n    instantaneousPower = data[2] + (data[3] << 8);\n    if (elements.spyValueElement) elements.spyValueElement.textContent = instantaneousPower;\n}\n// Disconnection handlers\nfunction $305aaf8b9a43c26d$var$onPowerMeterDisconnected(callbacks, elements) {\n    callbacks.onStatusUpdate('Device disconnected.');\n    if (elements.deviceNameElement) elements.deviceNameElement.textContent = '';\n    if (elements.powerMeterConnectButton) elements.powerMeterConnectButton.disabled = false;\n    if ($305aaf8b9a43c26d$var$powerMeterDevice) {\n        $305aaf8b9a43c26d$var$powerMeterDevice.removeEventListener('gattserverdisconnected', ()=>{\n            $305aaf8b9a43c26d$var$onPowerMeterDisconnected(callbacks, elements);\n        });\n        $305aaf8b9a43c26d$var$powerMeterDevice = null;\n    }\n    callbacks.onDisconnected();\n}\nfunction $305aaf8b9a43c26d$var$onHeartRateDisconnected(callbacks, elements) {\n    callbacks.onStatusUpdate('Device disconnected.');\n    if (elements.hrConnectionStatus) elements.hrConnectionStatus.textContent = 'Disconnected';\n    if (elements.hrDeviceName) elements.hrDeviceName.textContent = '';\n    if (elements.hrConnectButton) elements.hrConnectButton.disabled = false;\n    $305aaf8b9a43c26d$var$hrBluetoothDevice = null;\n    callbacks.onHeartRateChange(0);\n}\nfunction $305aaf8b9a43c26d$var$onCadenceDisconnected(callbacks, elements) {\n    callbacks.onStatusUpdate('Device disconnected.');\n    if (elements.cadenceConnectionStatus) elements.cadenceConnectionStatus.textContent = 'Disconnected';\n    if (elements.cadenceDeviceName) elements.cadenceDeviceName.textContent = '';\n    if (elements.speedCadenceConnectButton) elements.speedCadenceConnectButton.disabled = false;\n    $305aaf8b9a43c26d$var$speedCadenceBluetoothDevice = null;\n    callbacks.onCadenceChange(0);\n    // Clear cadence reset timer and reset variables\n    if ($305aaf8b9a43c26d$var$cadenceResetTimer) {\n        clearTimeout($305aaf8b9a43c26d$var$cadenceResetTimer);\n        $305aaf8b9a43c26d$var$cadenceResetTimer = null;\n    }\n    $305aaf8b9a43c26d$var$lastCrankRevs = 0;\n    $305aaf8b9a43c26d$var$lastCrankTime = 0;\n}\nfunction $305aaf8b9a43c26d$var$onSpyDisconnected(elements) {\n    $305aaf8b9a43c26d$var$spyMeterDevice = null;\n    if (elements.spyValueElement) elements.spyValueElement.textContent = '--';\n    if (elements.spyStatusElement) {\n        elements.spyStatusElement.textContent = 'Spy disconnected';\n        elements.spyStatusElement.style.display = 'block';\n    }\n    setTimeout(()=>{\n        if (elements.spyStatusElement) elements.spyStatusElement.style.display = 'none';\n        if (elements.spyInstructionsElement) elements.spyInstructionsElement.style.display = 'block';\n    }, 3000);\n}\nfunction $305aaf8b9a43c26d$export$47445d94160b987c() {\n    if ($305aaf8b9a43c26d$var$powerMeterDevice && $305aaf8b9a43c26d$var$powerMeterDisconnectHandler) {\n        $305aaf8b9a43c26d$var$powerMeterDevice.removeEventListener('gattserverdisconnected', $305aaf8b9a43c26d$var$powerMeterDisconnectHandler);\n        $305aaf8b9a43c26d$var$powerMeterDisconnectHandler = null;\n    }\n    if ($305aaf8b9a43c26d$var$hrBluetoothDevice && $305aaf8b9a43c26d$var$hrDisconnectHandler) {\n        $305aaf8b9a43c26d$var$hrBluetoothDevice.removeEventListener('gattserverdisconnected', $305aaf8b9a43c26d$var$hrDisconnectHandler);\n        $305aaf8b9a43c26d$var$hrDisconnectHandler = null;\n    }\n    if ($305aaf8b9a43c26d$var$speedCadenceBluetoothDevice && $305aaf8b9a43c26d$var$speedCadenceDisconnectHandler) {\n        $305aaf8b9a43c26d$var$speedCadenceBluetoothDevice.removeEventListener('gattserverdisconnected', $305aaf8b9a43c26d$var$speedCadenceDisconnectHandler);\n        $305aaf8b9a43c26d$var$speedCadenceDisconnectHandler = null;\n    }\n    if ($305aaf8b9a43c26d$var$spyMeterDevice && $305aaf8b9a43c26d$var$spyMeterDisconnectHandler) {\n        $305aaf8b9a43c26d$var$spyMeterDevice.removeEventListener('gattserverdisconnected', $305aaf8b9a43c26d$var$spyMeterDisconnectHandler);\n        $305aaf8b9a43c26d$var$spyMeterDisconnectHandler = null;\n    }\n}\n\n\n/**\n * Export Modals Module\n * Handles modal-based export functionality\n */ // Import required functions from data-export module\n/**\n * Data Export Module\n * Handles all data export functionality including JSON, CSV, TCX, image, and cloud exports\n * \n * Cloud Export Features:\n * - Google Docs: Creates formatted documents with session summaries\n * - Google Sheets: Creates spreadsheets with detailed data analysis\n * - More cloud services can be added following the established patterns\n * \n * @global gapi - Google API client (loaded dynamically)\n */ // TCX Generation Functions\n/**\n * Creates a trackpoint XML element for a single data point\n * @param {Object} dataPoint - Data point with time, power, heartRate, cadence\n * @returns {string} XML trackpoint string\n */ function $bdf94e4d5edca10a$var$createTrackpoint(dataPoint) {\n    const translations = {\n        time: (time)=>`<Time>${new Date(time).toISOString()}</Time>`,\n        heartRate: (hr)=>`\n<HeartRateBpm>\n  <Value>${hr}</Value>\n</HeartRateBpm>\n            `.trim(),\n        cadence: (cad)=>`<Cadence>${cad}</Cadence>`,\n        power: (pw)=>`\n<Extensions>\n  <ns2:TPX>\n    <ns2:Watts>${pw}</ns2:Watts>\n  </ns2:TPX>\n</Extensions>\n            `.trim()\n    };\n    const contents = Object.keys(translations).map((key)=>{\n        if (dataPoint[key] === undefined) return '';\n        return translations[key](dataPoint[key]);\n    }).filter((x)=>x).join('\\n');\n    return `\n<Trackpoint>\n  ${contents}\n</Trackpoint>\n`.trim();\n}\n/**\n * Generates TCX XML string from power data for cycling activities\n * @param {Array<Object>} powerData - Array of power measurement objects\n * @returns {string} Complete TCX XML string\n */ function $bdf94e4d5edca10a$export$84088f6ac1d2df1d(powerData) {\n    // Validate input data\n    if (!Array.isArray(powerData) || powerData.length === 0) return '';\n    // Filter and normalize data\n    const validDataPoints = powerData.filter((dataPoint)=>dataPoint && typeof dataPoint === 'object' && dataPoint.timestamp !== undefined && !isNaN(new Date(dataPoint.timestamp).getTime()));\n    if (validDataPoints.length === 0) return '';\n    // Transform data\n    const normalizeDataPoint = (item)=>({\n            time: item.timestamp,\n            ...item.power !== undefined && {\n                power: item.power\n            },\n            ...item.heartRate !== undefined && {\n                heartRate: item.heartRate\n            },\n            ...item.cadence !== undefined && {\n                cadence: item.cadence\n            }\n        });\n    // Process data\n    let processedData = validDataPoints.map(normalizeDataPoint).sort((a, b)=>a.time - b.time);\n    // Remove leading/trailing entries without power\n    const isEmptyPower = (dataPoint)=>!dataPoint.power || dataPoint.power <= 0;\n    while(processedData.length > 0 && isEmptyPower(processedData[0]))processedData.shift();\n    while(processedData.length > 0 && isEmptyPower(processedData[processedData.length - 1]))processedData.pop();\n    if (processedData.length === 0) return '';\n    // Generate XML\n    const trackpoints = processedData.map($bdf94e4d5edca10a$var$createTrackpoint).join('\\n');\n    const startTime = processedData[0].time;\n    const startTimeISO = new Date(startTime).toISOString();\n    const rawXml = `<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<TrainingCenterDatabase\n  xmlns=\"http://www.garmin.com/xmlschemas/TrainingCenterDatabase/v2\"\n  xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n  xsi:schemaLocation=\"http://www.garmin.com/xmlschemas/TrainingCenterDatabase/v2 http://www.garmin.com/xmlschemas/TrainingCenterDatabasev2.xsd\"\n  xmlns:ns2=\"http://www.garmin.com/xmlschemas/ActivityExtension/v2\">\n  <Activities>\n    <Activity Sport=\"Biking\">\n      <Id>${startTimeISO}</Id>\n      <Name>E Bike Indoor Cycling Trainer</Name>\n      <Lap StartTime=\"${startTimeISO}\">\n        <Track>\n        ${trackpoints}\n        </Track>\n      </Lap>\n    </Activity>\n  </Activities>\n</TrainingCenterDatabase>`;\n    return rawXml;\n}\n\n\n// Summary Image Generation Functions\n/**\n * Generates a comprehensive summary        const averagesData = [\n            { label: '10s', data: powerAverages['10s'] },\n            { label: '20s', data: powerAverages['20s'] },\n            { label: '30s', data: powerAverages['30s'] },\n            { label: '40s', data: powerAverages['40s'] },\n            { label: '50s', data: powerAverages['50s'] },\n            { label: '1m', data: powerAverages['1m'] },\n            { label: '2m', data: powerAverages['2m'] },\n            { label: '3m', data: powerAverages['3m'] },\n            { label: '4m', data: powerAverages['4m'] },\n            { label: '5m', data: powerAverages['5m'] },\n        ];ith power averages and timeline charts\n * @returns {Promise<HTMLCanvasElement>} Canvas containing the summary image\n */ async function $d219c9d45f0beb41$export$a7718992a1148ad7({ dataPoints: dataPoints, powerAverages: powerAverages }) {\n    const hrDataPoints = dataPoints.filter((d)=>d.heartRate !== undefined);\n    const cadenceDataPoints = dataPoints.filter((d)=>d.cadence !== undefined);\n    const powerDataPoints = dataPoints.filter((d)=>d.power !== undefined);\n    const canvas = document.createElement('canvas');\n    const ctx = canvas.getContext('2d');\n    // Calculate required height based on available data\n    let requiredHeight = 200; // Base height for title and headers\n    // Add height for power averages if available\n    if (Object.values(powerAverages).some((avg)=>avg.current > 0 || avg.best > 0)) requiredHeight += 200;\n    // Add height for heart rate statistics if available\n    if (hrDataPoints.length > 0 && hrDataPoints.some((d)=>d.heartRate > 0)) requiredHeight += 140;\n    // Add height for cadence statistics if available\n    if (cadenceDataPoints.length > 0 && cadenceDataPoints.some((d)=>d.cadence > 0)) requiredHeight += 140;\n    // Add height for each chart\n    const singleChartHeight = 350;\n    if (powerDataPoints.length > 0) requiredHeight += singleChartHeight;\n    if (hrDataPoints.length > 0) requiredHeight += singleChartHeight;\n    if (cadenceDataPoints.length > 0) requiredHeight += singleChartHeight;\n    // Set canvas size for high resolution export\n    const width = 1200;\n    const height = Math.max(600, requiredHeight);\n    canvas.width = width;\n    canvas.height = height;\n    // Set background\n    ctx.fillStyle = '#1a1a2e';\n    ctx.fillRect(0, 0, width, height);\n    // Title\n    ctx.fillStyle = '#ffffff';\n    ctx.font = 'bold 36px Arial, sans-serif';\n    ctx.textAlign = 'center';\n    ctx.fillText('Power Meter Summary', width / 2, 50);\n    // Date and time\n    ctx.font = '18px Arial, sans-serif';\n    ctx.fillStyle = '#cccccc';\n    const now = new Date();\n    ctx.fillText(now.toLocaleDateString() + ' ' + now.toLocaleTimeString(), width / 2, 80);\n    // Session duration\n    if (powerDataPoints.length > 0) {\n        const sessionEnd = powerDataPoints[powerDataPoints.length - 1].timestamp;\n        const sessionStart = powerDataPoints[0].timestamp;\n        const sessionSeconds = Math.round((sessionEnd - sessionStart) / 1000);\n        const durationMinutes = Math.round(sessionSeconds / 60); // minutes\n        ctx.fillText(`Session Duration: ${durationMinutes} minutes`, width / 2, 105);\n    }\n    let yOffset = 130;\n    // Power Averages Section\n    if (Object.values(powerAverages).some((avg)=>avg.current > 0 || avg.best > 0)) {\n        ctx.fillStyle = '#ffffff';\n        ctx.font = 'bold 24px Arial, sans-serif';\n        ctx.textAlign = 'left';\n        ctx.fillText('Power Averages', 50, yOffset);\n        yOffset += 40;\n        const avgData = [\n            {\n                label: '10s',\n                data: powerAverages['10s']\n            },\n            {\n                label: '30s',\n                data: powerAverages['30s']\n            },\n            {\n                label: '1m',\n                data: powerAverages['1m']\n            },\n            {\n                label: '2m',\n                data: powerAverages['2m']\n            },\n            {\n                label: '4m',\n                data: powerAverages['4m']\n            },\n            {\n                label: '8m',\n                data: powerAverages['8m']\n            }\n        ];\n        // Draw power averages table\n        ctx.font = '16px Arial, sans-serif';\n        ctx.fillStyle = '#cccccc';\n        ctx.fillText('Duration', 70, yOffset);\n        ctx.fillText('Best', 220, yOffset);\n        ctx.fillText('Duration', 470, yOffset);\n        ctx.fillText('Best', 620, yOffset);\n        yOffset += 30;\n        // Draw averages in two columns\n        for(let i = 0; i < avgData.length; i++){\n            const avg = avgData[i];\n            const xBase = i < 3 ? 70 : 470;\n            const row = i < 3 ? i : i - 3;\n            const y = yOffset + row * 25;\n            ctx.fillStyle = '#ffffff';\n            ctx.fillText(avg.label, xBase, y);\n            ctx.fillStyle = avg.data.best > 0 ? '#e74c3c' : '#666666';\n            ctx.fillText(avg.data.best + 'W', xBase + 150, y);\n        }\n        yOffset += 100;\n    }\n    // Heart Rate Statistics Section\n    if (hrDataPoints.length > 0) {\n        const heartRates = hrDataPoints.map((d)=>d.heartRate).filter((hr)=>hr > 0);\n        if (heartRates.length > 0) {\n            ctx.fillStyle = '#ffffff';\n            ctx.font = 'bold 24px Arial, sans-serif';\n            ctx.textAlign = 'left';\n            ctx.fillText('Heart Rate Statistics', 50, yOffset);\n            yOffset += 40;\n            const maxHR = Math.max(...heartRates);\n            const minHR = Math.min(...heartRates);\n            const avgHR = Math.round(heartRates.reduce((a, b)=>a + b, 0) / heartRates.length);\n            ctx.font = '16px Arial, sans-serif';\n            ctx.fillStyle = '#cccccc';\n            ctx.fillText('Average:', 70, yOffset);\n            ctx.fillStyle = '#e74c3c';\n            ctx.fillText(`${avgHR} BPM`, 200, yOffset);\n            yOffset += 25;\n            ctx.fillStyle = '#cccccc';\n            ctx.fillText('Maximum:', 70, yOffset);\n            ctx.fillStyle = '#e74c3c';\n            ctx.fillText(`${maxHR} BPM`, 200, yOffset);\n            yOffset += 25;\n            ctx.fillStyle = '#cccccc';\n            ctx.fillText('Minimum:', 70, yOffset);\n            ctx.fillStyle = '#e74c3c';\n            ctx.fillText(`${minHR} BPM`, 200, yOffset);\n            yOffset += 40;\n        }\n    }\n    // Cadence Statistics Section\n    if (cadenceDataPoints.length > 0) {\n        const clampCadence = (cad)=>Math.max(0, Math.min(200, cad));\n        const cadences = cadenceDataPoints.map((d)=>d.cadence).filter((cad)=>cad > 0).map(clampCadence);\n        if (cadences.length > 0) {\n            ctx.fillStyle = '#ffffff';\n            ctx.font = 'bold 24px Arial, sans-serif';\n            ctx.textAlign = 'left';\n            ctx.fillText('Cadence Statistics', 50, yOffset);\n            yOffset += 40;\n            const maxCadence = Math.max(...cadences);\n            const minCadence = Math.min(...cadences);\n            const avgCadence = Math.round(cadences.reduce((a, b)=>a + b, 0) / cadences.length);\n            ctx.font = '16px Arial, sans-serif';\n            ctx.fillStyle = '#cccccc';\n            ctx.fillText('Average:', 70, yOffset);\n            ctx.fillStyle = '#f39c12';\n            ctx.fillText(`${avgCadence} RPM`, 200, yOffset);\n            yOffset += 25;\n            ctx.fillStyle = '#cccccc';\n            ctx.fillText('Maximum:', 70, yOffset);\n            ctx.fillStyle = '#f39c12';\n            ctx.fillText(`${maxCadence} RPM`, 200, yOffset);\n            yOffset += 25;\n            ctx.fillStyle = '#cccccc';\n            ctx.fillText('Minimum:', 70, yOffset);\n            ctx.fillStyle = '#f39c12';\n            ctx.fillText(`${minCadence} RPM`, 200, yOffset);\n            yOffset += 40;\n        }\n    }\n    // If no data is available, show a message\n    const hasData = powerDataPoints.length > 0 || hrDataPoints.length > 0 || cadenceDataPoints.length > 0;\n    if (!hasData) {\n        ctx.fillStyle = '#cccccc';\n        ctx.font = '24px Arial, sans-serif';\n        ctx.textAlign = 'center';\n        ctx.fillText('No data recorded yet', width / 2, height / 2);\n        ctx.font = '16px Arial, sans-serif';\n        ctx.fillText('Start recording to see your activity summary', width / 2, height / 2 + 40);\n        return canvas;\n    }\n    // Charts section\n    const chartHeight = 300;\n    const chartWidth = width - 100;\n    const chartStartX = 50;\n    // Power Chart\n    if (powerDataPoints.length > 0) {\n        yOffset += 20;\n        ctx.fillStyle = '#ffffff';\n        ctx.font = 'bold 20px Arial, sans-serif';\n        ctx.fillText('Power Timeline', chartStartX, yOffset);\n        yOffset += 30;\n        $d219c9d45f0beb41$var$drawTimelineChart(ctx, powerDataPoints, 'power', chartStartX, yOffset, chartWidth, chartHeight, '#3498db', 'W');\n        yOffset += chartHeight + 50;\n    }\n    // Heart Rate Chart\n    if (hrDataPoints.length > 0) {\n        ctx.fillStyle = '#ffffff';\n        ctx.font = 'bold 20px Arial, sans-serif';\n        ctx.fillText('Heart Rate Timeline', chartStartX, yOffset);\n        yOffset += 30;\n        $d219c9d45f0beb41$var$drawTimelineChart(ctx, hrDataPoints, 'heartRate', chartStartX, yOffset, chartWidth, chartHeight, '#e74c3c', 'BPM');\n        yOffset += chartHeight + 50;\n    }\n    // Cadence Chart\n    if (cadenceDataPoints.length > 0) {\n        ctx.fillStyle = '#ffffff';\n        ctx.font = 'bold 20px Arial, sans-serif';\n        ctx.fillText('Cadence Timeline', chartStartX, yOffset);\n        yOffset += 30;\n        $d219c9d45f0beb41$var$drawTimelineChart(ctx, cadenceDataPoints, 'cadence', chartStartX, yOffset, chartWidth, chartHeight, '#f39c12', 'RPM');\n        yOffset += chartHeight + 50;\n    }\n    return canvas;\n}\n/**\n * Draws a timeline chart for the given data\n */ function $d219c9d45f0beb41$var$drawTimelineChart(ctx, data, valueKey, x, y, width, height, color, unit) {\n    if (data.length === 0) return;\n    // Draw chart background\n    ctx.fillStyle = 'rgba(255, 255, 255, 0.05)';\n    ctx.fillRect(x, y, width, height);\n    // Draw border\n    ctx.strokeStyle = 'rgba(255, 255, 255, 0.2)';\n    ctx.lineWidth = 1;\n    ctx.strokeRect(x, y, width, height);\n    // Find min/max values for scaling\n    const values = data.map((d)=>d[valueKey]).filter((v)=>v > 0);\n    if (values.length === 0) return;\n    const minValue = Math.min(...values);\n    const maxValue = Math.max(...values);\n    const range = maxValue - minValue || 1;\n    // Draw Y-axis labels\n    ctx.fillStyle = '#cccccc';\n    ctx.font = '12px Arial, sans-serif';\n    ctx.textAlign = 'right';\n    for(let i = 0; i <= 4; i++){\n        const value = Math.round(minValue + range * i / 4);\n        const labelY = y + height - height * i / 4;\n        ctx.fillText(value + unit, x - 10, labelY + 4);\n    }\n    // Draw chart line\n    ctx.strokeStyle = color;\n    ctx.lineWidth = 2;\n    ctx.beginPath();\n    let firstPoint = true;\n    for(let i = 0; i < data.length; i++){\n        const point = data[i];\n        const value = point[valueKey];\n        if (value > 0) {\n            const chartX = x + i / (data.length - 1) * width;\n            const chartY = y + height - (value - minValue) / range * height;\n            if (firstPoint) {\n                ctx.moveTo(chartX, chartY);\n                firstPoint = false;\n            } else ctx.lineTo(chartX, chartY);\n        }\n    }\n    ctx.stroke();\n    // Draw data points\n    ctx.fillStyle = color;\n    for(let i = 0; i < data.length; i += Math.max(1, Math.floor(data.length / 50))){\n        const point = data[i];\n        const value = point[valueKey];\n        if (value > 0) {\n            const chartX = x + i / (data.length - 1) * width;\n            const chartY = y + height - (value - minValue) / range * height;\n            ctx.beginPath();\n            ctx.arc(chartX, chartY, 3, 0, 2 * Math.PI);\n            ctx.fill();\n        }\n    }\n    // Draw grid lines\n    ctx.strokeStyle = 'rgba(255, 255, 255, 0.1)';\n    ctx.lineWidth = 1;\n    // Horizontal grid lines\n    for(let i = 1; i < 4; i++){\n        const gridY = y + height * i / 4;\n        ctx.beginPath();\n        ctx.moveTo(x, gridY);\n        ctx.lineTo(x + width, gridY);\n        ctx.stroke();\n    }\n    // Add time axis labels\n    if (data.length > 1) {\n        ctx.fillStyle = '#cccccc';\n        ctx.font = '12px Arial, sans-serif';\n        ctx.textAlign = 'center';\n        const startTime = new Date(data[0].timestamp);\n        const endTime = new Date(data[data.length - 1].timestamp);\n        // Start time\n        ctx.fillText(startTime.toLocaleTimeString(), x, y + height + 20);\n        // End time\n        ctx.fillText(endTime.toLocaleTimeString(), x + width, y + height + 20);\n        // Middle time if session is long enough\n        if (data.length > 10) {\n            const middleTime = new Date(data[Math.floor(data.length / 2)].timestamp);\n            ctx.fillText(middleTime.toLocaleTimeString(), x + width / 2, y + height + 20);\n        }\n    }\n    // Add min/max annotations\n    ctx.fillStyle = '#ffffff';\n    ctx.font = '12px Arial, sans-serif';\n    ctx.textAlign = 'left';\n    ctx.fillText(`Max: ${maxValue}${unit}`, x + 10, y + 20);\n    ctx.fillText(`Min: ${minValue}${unit}`, x + 10, y + 35);\n    ctx.fillText(`Avg: ${Math.round(values.reduce((a, b)=>a + b, 0) / values.length)}${unit}`, x + 10, y + 50);\n}\n\n\n\n/* ==========================================================================\n   Cloud Export Configuration\n   ========================================================================== */ /**\n * Google API configuration for cloud exports\n * @constant {Object}\n */ const $8ca4b0f2a2d350fa$var$GOOGLE_API_CONFIG = {\n    CLIENT_ID: '',\n    API_KEY: '',\n    DISCOVERY_DOCS: [\n        'https://docs.googleapis.com/$discovery/rest?version=v1',\n        'https://sheets.googleapis.com/$discovery/rest?version=v4'\n    ],\n    SCOPES: [\n        'https://www.googleapis.com/auth/documents',\n        'https://www.googleapis.com/auth/spreadsheets',\n        'https://www.googleapis.com/auth/drive.file'\n    ]\n};\n/**\n * intervals.icu API configuration for cycling analytics export\n * @constant {Object}\n */ const $8ca4b0f2a2d350fa$var$INTERVALS_CONFIG = {\n    BASE_URL: 'https://intervals.icu/api/v1',\n    API_KEY: '',\n    ATHLETE_ID: '',\n    SUPPORTED_FORMATS: [\n        'fit',\n        'tcx',\n        'gpx'\n    ],\n    MAX_FILE_SIZE: 52428800,\n    UPLOAD_ENDPOINTS: {\n        activities: '/activities',\n        wellness: '/wellness'\n    }\n};\n/**\n * Cloud export state management\n * @type {Object}\n */ const $8ca4b0f2a2d350fa$var$cloudExportState = {\n    isGoogleApiLoaded: false,\n    isUserSignedIn: false,\n    authInstance: null,\n    lastError: null,\n    intervals: {\n        isConfigured: false,\n        apiKey: null,\n        athleteId: null,\n        lastUpload: null\n    }\n};\nfunction $8ca4b0f2a2d350fa$export$20b155984c11fcae(powerData) {\n    if (!powerData || !Array.isArray(powerData) || powerData.length === 0) throw new Error('No valid power data available to export as JSON');\n    const jsonString = JSON.stringify(powerData, null, 2);\n    const blob = new Blob([\n        jsonString\n    ], {\n        type: 'application/json'\n    });\n    $8ca4b0f2a2d350fa$var$downloadFile(blob, `power_data_${(0, $26bf0f38c1315f82$export$b5051178064abb72)()}.json`);\n}\nfunction $8ca4b0f2a2d350fa$export$dfe05421fb7443f9(powerData) {\n    if (!powerData || !Array.isArray(powerData) || powerData.length === 0) throw new Error('No valid power data available to export as CSV');\n    let csvContent = 'timestamp,power,heartRate,cadence\\n';\n    powerData.forEach((row)=>{\n        // Safely handle missing properties\n        const timestamp = row.timestamp || '';\n        const power = row.power || 0;\n        const heartRate = row.heartRate || 0;\n        const cadence = row.cadence || 0;\n        csvContent += `${timestamp},${power},${heartRate},${cadence}\\n`;\n    });\n    const blob = new Blob([\n        csvContent\n    ], {\n        type: 'text/csv;charset=utf-8;'\n    });\n    $8ca4b0f2a2d350fa$var$downloadFile(blob, `power_data_${(0, $26bf0f38c1315f82$export$b5051178064abb72)()}.csv`);\n}\nfunction $8ca4b0f2a2d350fa$export$bb00655dce19035c(rawPowerMeasurements) {\n    const jsonString = JSON.stringify(rawPowerMeasurements, null, 2);\n    const blob = new Blob([\n        jsonString\n    ], {\n        type: 'application/json'\n    });\n    $8ca4b0f2a2d350fa$var$downloadFile(blob, `raw_power_measurements_${(0, $26bf0f38c1315f82$export$b5051178064abb72)()}.json`);\n}\nfunction $8ca4b0f2a2d350fa$export$5e37402f32542f6f(rawPowerMeasurements) {\n    let csvContent = 'timestamp,flags,dataLength,instantaneousPower,rawBytes\\n';\n    rawPowerMeasurements.forEach((measurement)=>{\n        csvContent += `${measurement.timestamp},${measurement.flags},${measurement.dataLength},${measurement.instantaneousPower},\"${measurement.rawBytes}\"\\n`;\n    });\n    const blob = new Blob([\n        csvContent\n    ], {\n        type: 'text/csv;charset=utf-8;'\n    });\n    $8ca4b0f2a2d350fa$var$downloadFile(blob, `raw_power_measurements_${(0, $26bf0f38c1315f82$export$b5051178064abb72)()}.csv`);\n}\nfunction $8ca4b0f2a2d350fa$export$55f444e58fd8eb49(powerData) {\n    try {\n        if (powerData.length === 0) throw new Error('No power data available to export.');\n        const tcxContent = (0, $bdf94e4d5edca10a$export$84088f6ac1d2df1d)(powerData);\n        const blob = new Blob([\n            tcxContent\n        ], {\n            type: 'application/xml;charset=utf-8;'\n        });\n        $8ca4b0f2a2d350fa$var$downloadFile(blob, `power_data_${(0, $26bf0f38c1315f82$export$b5051178064abb72)()}.tcx`);\n    } catch (error) {\n        console.error('Error generating TCX:', error);\n        throw error;\n    }\n}\nasync function $8ca4b0f2a2d350fa$export$ee1eca645500f8af(data) {\n    try {\n        if (data.dataPoints.length === 0) throw new Error('No data available to export. Please record some activity first.');\n        const canvas = await (0, $d219c9d45f0beb41$export$a7718992a1148ad7)({\n            dataPoints: data.dataPoints,\n            powerAverages: data.powerAverages\n        });\n        return new Promise((resolve, reject)=>{\n            canvas.toBlob((blob)=>{\n                if (blob) {\n                    $8ca4b0f2a2d350fa$var$downloadFile(blob, `power_meter_summary_${(0, $26bf0f38c1315f82$export$b5051178064abb72)()}.png`);\n                    resolve();\n                } else reject(new Error('Failed to generate image blob'));\n            }, 'image/png');\n        });\n    } catch (error) {\n        console.error('Error generating summary image:', error);\n        throw error;\n    }\n}\n/**\n * Helper function to trigger file download\n * @param {Blob} blob - The blob to download\n * @param {string} filename - The filename for the download\n */ function $8ca4b0f2a2d350fa$var$downloadFile(blob, filename) {\n    try {\n        if (!blob || !(blob instanceof Blob)) throw new Error('Invalid blob provided for download');\n        if (!filename || typeof filename !== 'string') throw new Error('Invalid filename provided for download');\n        const url = URL.createObjectURL(blob);\n        const a = document.createElement('a');\n        a.href = url;\n        a.download = filename;\n        document.body.appendChild(a);\n        a.click();\n        document.body.removeChild(a);\n        URL.revokeObjectURL(url);\n    } catch (error) {\n        console.error('Error during file download:', error);\n        throw error;\n    }\n}\nasync function $8ca4b0f2a2d350fa$export$49c155b083d14004(clientId, apiKey) {\n    try {\n        // Set configuration\n        $8ca4b0f2a2d350fa$var$GOOGLE_API_CONFIG.CLIENT_ID = clientId;\n        $8ca4b0f2a2d350fa$var$GOOGLE_API_CONFIG.API_KEY = apiKey;\n        // Load Google API if not already loaded\n        if (!window.gapi) await $8ca4b0f2a2d350fa$var$loadGoogleAPIScript();\n        // Initialize the API\n        await new Promise((resolve, reject)=>{\n            window.gapi.load('auth2:client', {\n                callback: resolve,\n                onerror: reject\n            });\n        });\n        // Initialize auth and client\n        await window.gapi.client.init({\n            apiKey: $8ca4b0f2a2d350fa$var$GOOGLE_API_CONFIG.API_KEY,\n            clientId: $8ca4b0f2a2d350fa$var$GOOGLE_API_CONFIG.CLIENT_ID,\n            discoveryDocs: $8ca4b0f2a2d350fa$var$GOOGLE_API_CONFIG.DISCOVERY_DOCS,\n            scope: $8ca4b0f2a2d350fa$var$GOOGLE_API_CONFIG.SCOPES.join(' ')\n        });\n        $8ca4b0f2a2d350fa$var$cloudExportState.authInstance = window.gapi.auth2.getAuthInstance();\n        $8ca4b0f2a2d350fa$var$cloudExportState.isGoogleApiLoaded = true;\n        $8ca4b0f2a2d350fa$var$cloudExportState.isUserSignedIn = $8ca4b0f2a2d350fa$var$cloudExportState.authInstance.isSignedIn.get();\n        console.log('Google API initialized successfully');\n        return true;\n    } catch (error) {\n        console.error('Failed to initialize Google API:', error);\n        $8ca4b0f2a2d350fa$var$cloudExportState.lastError = error.message;\n        return false;\n    }\n}\n/**\n * Load Google API script dynamically\n * @async\n * @returns {Promise<void>}\n */ function $8ca4b0f2a2d350fa$var$loadGoogleAPIScript() {\n    return new Promise((resolve, reject)=>{\n        if (document.querySelector('script[src*=\"apis.google.com\"]')) {\n            resolve();\n            return;\n        }\n        const script = document.createElement('script');\n        script.src = 'https://apis.google.com/js/api.js';\n        script.onload = resolve;\n        script.onerror = ()=>reject(new Error('Failed to load Google API script'));\n        document.head.appendChild(script);\n    });\n}\nasync function $8ca4b0f2a2d350fa$export$e4bd7e369fe3a1ee() {\n    try {\n        if (!$8ca4b0f2a2d350fa$var$cloudExportState.isGoogleApiLoaded) throw new Error('Google API not initialized. Please configure API credentials first.');\n        if (!$8ca4b0f2a2d350fa$var$cloudExportState.isUserSignedIn) {\n            await $8ca4b0f2a2d350fa$var$cloudExportState.authInstance.signIn();\n            $8ca4b0f2a2d350fa$var$cloudExportState.isUserSignedIn = $8ca4b0f2a2d350fa$var$cloudExportState.authInstance.isSignedIn.get();\n        }\n        return $8ca4b0f2a2d350fa$var$cloudExportState.isUserSignedIn;\n    } catch (error) {\n        console.error('Google authentication failed:', error);\n        $8ca4b0f2a2d350fa$var$cloudExportState.lastError = error.message;\n        return false;\n    }\n}\nasync function $8ca4b0f2a2d350fa$export$6ec42103ddca7218() {\n    try {\n        if ($8ca4b0f2a2d350fa$var$cloudExportState.authInstance && $8ca4b0f2a2d350fa$var$cloudExportState.isUserSignedIn) {\n            await $8ca4b0f2a2d350fa$var$cloudExportState.authInstance.signOut();\n            $8ca4b0f2a2d350fa$var$cloudExportState.isUserSignedIn = false;\n        }\n    } catch (error) {\n        console.error('Google sign out failed:', error);\n    }\n}\nfunction $8ca4b0f2a2d350fa$export$d6129adf4612fdfb() {\n    return $8ca4b0f2a2d350fa$var$cloudExportState.isUserSignedIn;\n}\nfunction $8ca4b0f2a2d350fa$export$86579fbd7854cc47() {\n    return $8ca4b0f2a2d350fa$var$cloudExportState.lastError;\n}\nfunction $8ca4b0f2a2d350fa$export$1aa14f7a5d6e27b0(apiKey, athleteId) {\n    try {\n        if (!apiKey || typeof apiKey !== 'string' || apiKey.trim().length === 0) throw new Error('Valid API key is required');\n        if (!athleteId || typeof athleteId !== 'string' || athleteId.trim().length === 0) throw new Error('Valid athlete ID is required');\n        // Sanitize inputs\n        const cleanApiKey = apiKey.trim();\n        const cleanAthleteId = athleteId.trim();\n        $8ca4b0f2a2d350fa$var$INTERVALS_CONFIG.API_KEY = cleanApiKey;\n        $8ca4b0f2a2d350fa$var$INTERVALS_CONFIG.ATHLETE_ID = cleanAthleteId;\n        $8ca4b0f2a2d350fa$var$cloudExportState.intervals.isConfigured = true;\n        $8ca4b0f2a2d350fa$var$cloudExportState.intervals.apiKey = cleanApiKey;\n        $8ca4b0f2a2d350fa$var$cloudExportState.intervals.athleteId = cleanAthleteId;\n        console.log('intervals.icu configuration initialized successfully');\n        return true;\n    } catch (error) {\n        console.error('Failed to initialize intervals.icu configuration:', error);\n        $8ca4b0f2a2d350fa$var$cloudExportState.lastError = error.message;\n        return false;\n    }\n}\nfunction $8ca4b0f2a2d350fa$export$abbccf31f198d0dc() {\n    return $8ca4b0f2a2d350fa$var$cloudExportState.intervals.isConfigured && $8ca4b0f2a2d350fa$var$cloudExportState.intervals.apiKey && $8ca4b0f2a2d350fa$var$cloudExportState.intervals.athleteId;\n}\nasync function $8ca4b0f2a2d350fa$export$7eff8e3a92135016(data) {\n    try {\n        // Ensure configuration\n        if (!$8ca4b0f2a2d350fa$export$abbccf31f198d0dc()) throw new Error('intervals.icu not configured. Please set up API credentials first.');\n        const { powerData: powerData, sessionStartTime: sessionStartTime, powerAverages: powerAverages, activityName: activityName, description: description } = data;\n        if (!powerData || powerData.length === 0) throw new Error('No power data available to export');\n        // Generate TCX content for intervals.icu\n        const tcxContent = $8ca4b0f2a2d350fa$var$generateIntervalsCompatibleTCX({\n            powerData: powerData,\n            sessionStartTime: sessionStartTime,\n            powerAverages: powerAverages,\n            activityName: activityName || `Power Meter Session - ${new Date(sessionStartTime).toLocaleDateString()}`,\n            description: description || 'Exported from Power Saver Web App'\n        });\n        // Upload to intervals.icu\n        const activityId = await $8ca4b0f2a2d350fa$var$uploadToIntervals(tcxContent, {\n            name: activityName || `Power Meter Session - ${new Date(sessionStartTime).toLocaleDateString()}`,\n            description: description || 'Exported from Power Saver Web App',\n            type: 'Ride'\n        });\n        console.log('Successfully exported to intervals.icu:', activityId);\n        $8ca4b0f2a2d350fa$var$cloudExportState.intervals.lastUpload = new Date().toISOString();\n        return activityId;\n    } catch (error) {\n        console.error('Error exporting to intervals.icu:', error);\n        $8ca4b0f2a2d350fa$var$cloudExportState.lastError = error.message;\n        throw new Error(`Failed to export to intervals.icu: ${error.message}`);\n    }\n}\n/**\n * Upload TCX content to intervals.icu\n * @async\n * @param {string} tcxContent - TCX file content\n * @param {Object} metadata - Activity metadata\n * @returns {Promise<string>} Activity ID\n */ async function $8ca4b0f2a2d350fa$var$uploadToIntervals(tcxContent, metadata) {\n    try {\n        // Create form data for file upload\n        const formData = new FormData();\n        const tcxBlob = new Blob([\n            tcxContent\n        ], {\n            type: 'application/xml'\n        });\n        formData.append('file', tcxBlob, `power-session-${Date.now()}.tcx`);\n        formData.append('name', metadata.name);\n        formData.append('description', metadata.description);\n        formData.append('type', metadata.type);\n        // Upload to intervals.icu\n        const response = await fetch(`${$8ca4b0f2a2d350fa$var$INTERVALS_CONFIG.BASE_URL}/athlete/${$8ca4b0f2a2d350fa$var$INTERVALS_CONFIG.ATHLETE_ID}/activities`, {\n            method: 'POST',\n            headers: {\n                'Authorization': `Basic ${btoa(`${$8ca4b0f2a2d350fa$var$INTERVALS_CONFIG.API_KEY}:`)}`\n            },\n            body: formData\n        });\n        if (!response.ok) {\n            const errorText = await response.text();\n            throw new Error(`intervals.icu API error: ${response.status} - ${errorText}`);\n        }\n        const result = await response.json();\n        return result.id || result.activity_id || 'uploaded';\n    } catch (error) {\n        console.error('Upload to intervals.icu failed:', error);\n        throw error;\n    }\n}\n/**\n * Generate intervals.icu compatible TCX content\n * @param {Object} data - Activity data\n * @returns {string} TCX content\n */ function $8ca4b0f2a2d350fa$var$generateIntervalsCompatibleTCX(data) {\n    const { powerData: powerData, sessionStartTime: sessionStartTime, description: description } = data;\n    const startTime = new Date(sessionStartTime).toISOString();\n    let tcxContent = `<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n`;\n    tcxContent += `<TrainingCenterDatabase xsi:schemaLocation=\"http://www.garmin.com/xmlschemas/TrainingCenterDatabase/v2 http://www.garmin.com/xmlschemas/TrainingCenterDatabasev2.xsd\" xmlns:ns5=\"http://www.garmin.com/xmlschemas/ActivityGoals/v1\" xmlns:ns3=\"http://www.garmin.com/xmlschemas/ActivityExtension/v2\" xmlns:ns2=\"http://www.garmin.com/xmlschemas/UserProfile/v2\" xmlns=\"http://www.garmin.com/xmlschemas/TrainingCenterDatabase/v2\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:ns4=\"http://www.garmin.com/xmlschemas/ProfileExtension/v1\">\\n`;\n    tcxContent += `  <Activities>\\n`;\n    tcxContent += `    <Activity Sport=\"Biking\">\\n`;\n    tcxContent += `      <Id>${startTime}</Id>\\n`;\n    tcxContent += `      <Notes>${description}</Notes>\\n`;\n    tcxContent += `      <Lap StartTime=\"${startTime}\">\\n`;\n    // Calculate lap statistics\n    const lapStats = $8ca4b0f2a2d350fa$var$calculateLapStatistics(powerData);\n    tcxContent += `        <TotalTimeSeconds>${lapStats.totalTime}</TotalTimeSeconds>\\n`;\n    tcxContent += `        <DistanceMeters>${lapStats.distance}</DistanceMeters>\\n`;\n    tcxContent += `        <MaximumSpeed>${lapStats.maxSpeed}</MaximumSpeed>\\n`;\n    tcxContent += `        <Calories>${lapStats.calories}</Calories>\\n`;\n    if (lapStats.avgHeartRate > 0) {\n        tcxContent += `        <AverageHeartRateBpm><Value>${Math.round(lapStats.avgHeartRate)}</Value></AverageHeartRateBpm>\\n`;\n        tcxContent += `        <MaximumHeartRateBpm><Value>${lapStats.maxHeartRate}</Value></MaximumHeartRateBpm>\\n`;\n    }\n    tcxContent += `        <Intensity>Active</Intensity>\\n`;\n    tcxContent += `        <TriggerMethod>Manual</TriggerMethod>\\n`;\n    tcxContent += `        <Track>\\n`;\n    // Add trackpoints\n    powerData.forEach((point)=>{\n        const timestamp = new Date(point.timestamp).toISOString();\n        tcxContent += `          <Trackpoint>\\n`;\n        tcxContent += `            <Time>${timestamp}</Time>\\n`;\n        if (point.heartRate && point.heartRate > 0) tcxContent += `            <HeartRateBpm><Value>${point.heartRate}</Value></HeartRateBpm>\\n`;\n        if (point.cadence && point.cadence > 0) tcxContent += `            <Cadence>${point.cadence}</Cadence>\\n`;\n        // Add power data in extensions\n        tcxContent += `            <Extensions>\\n`;\n        tcxContent += `              <ns3:TPX>\\n`;\n        if (point.power && point.power > 0) tcxContent += `                <ns3:Watts>${point.power}</ns3:Watts>\\n`;\n        tcxContent += `              </ns3:TPX>\\n`;\n        tcxContent += `            </Extensions>\\n`;\n        tcxContent += `          </Trackpoint>\\n`;\n    });\n    tcxContent += `        </Track>\\n`;\n    // Add power extensions for the lap\n    tcxContent += `        <Extensions>\\n`;\n    tcxContent += `          <ns3:LX>\\n`;\n    if (lapStats.avgPower > 0) {\n        tcxContent += `            <ns3:AvgWatts>${Math.round(lapStats.avgPower)}</ns3:AvgWatts>\\n`;\n        tcxContent += `            <ns3:MaxWatts>${lapStats.maxPower}</ns3:MaxWatts>\\n`;\n    }\n    tcxContent += `          </ns3:LX>\\n`;\n    tcxContent += `        </Extensions>\\n`;\n    tcxContent += `      </Lap>\\n`;\n    // Add activity-level power data\n    tcxContent += `      <Extensions>\\n`;\n    tcxContent += `        <ns3:ActivityExtensions>\\n`;\n    if (lapStats.avgPower > 0) {\n        tcxContent += `          <ns3:AvgWatts>${Math.round(lapStats.avgPower)}</ns3:AvgWatts>\\n`;\n        tcxContent += `          <ns3:MaxWatts>${lapStats.maxPower}</ns3:MaxWatts>\\n`;\n    }\n    tcxContent += `        </ns3:ActivityExtensions>\\n`;\n    tcxContent += `      </Extensions>\\n`;\n    tcxContent += `    </Activity>\\n`;\n    tcxContent += `  </Activities>\\n`;\n    tcxContent += `</TrainingCenterDatabase>`;\n    return tcxContent;\n}\n/**\n * Calculate lap statistics for TCX export\n * @param {Array} powerData - Array of power data points\n * @returns {Object} Lap statistics\n */ function $8ca4b0f2a2d350fa$var$calculateLapStatistics(powerData) {\n    if (powerData.length === 0) return {\n        totalTime: 0,\n        distance: 0,\n        maxSpeed: 0,\n        calories: 0,\n        avgHeartRate: 0,\n        maxHeartRate: 0,\n        avgPower: 0,\n        maxPower: 0\n    };\n    const startTime = new Date(powerData[0].timestamp).getTime();\n    const endTime = new Date(powerData[powerData.length - 1].timestamp).getTime();\n    const totalTime = (endTime - startTime) / 1000; // seconds\n    const powers = powerData.map((p)=>p.power || 0).filter((p)=>p > 0);\n    const heartRates = powerData.map((p)=>p.heartRate || 0).filter((hr)=>hr > 0);\n    // Estimate distance based on power (rough approximation)\n    const avgPower = powers.length > 0 ? powers.reduce((a, b)=>a + b, 0) / powers.length : 0;\n    const estimatedSpeed = avgPower > 0 ? Math.sqrt(avgPower / 3.6) : 15; // km/h estimate\n    const distance = estimatedSpeed / 3.6 * totalTime; // meters\n    // Estimate calories based on power and time\n    const calories = avgPower > 0 ? Math.round(avgPower * totalTime * 4.18 / 1000) : Math.round(totalTime * 10);\n    return {\n        totalTime: Math.round(totalTime),\n        distance: Math.round(distance),\n        maxSpeed: Math.round(estimatedSpeed * 1.2 / 3.6 * 100) / 100,\n        calories: calories,\n        avgHeartRate: heartRates.length > 0 ? heartRates.reduce((a, b)=>a + b, 0) / heartRates.length : 0,\n        maxHeartRate: heartRates.length > 0 ? Math.max(...heartRates) : 0,\n        avgPower: avgPower,\n        maxPower: powers.length > 0 ? Math.max(...powers) : 0\n    };\n}\nasync function $8ca4b0f2a2d350fa$export$33ba7bf2bc167957(data) {\n    try {\n        // Ensure authentication\n        if (!await $8ca4b0f2a2d350fa$export$e4bd7e369fe3a1ee()) throw new Error('Google authentication required');\n        const { powerData: powerData, powerAverages: powerAverages, sessionStartTime: sessionStartTime } = data;\n        const sessionDate = sessionStartTime ? new Date(sessionStartTime) : new Date();\n        const documentTitle = `Power Meter Session - ${sessionDate.toLocaleDateString()}`;\n        // Create document structure\n        const documentContent = $8ca4b0f2a2d350fa$var$generateGoogleDocsContent(powerData, powerAverages, sessionDate);\n        // Create the document\n        const response = await window.gapi.client.docs.documents.create({\n            resource: {\n                title: documentTitle\n            }\n        });\n        const documentId = response.result.documentId;\n        // Add content to the document\n        await window.gapi.client.docs.documents.batchUpdate({\n            documentId: documentId,\n            resource: {\n                requests: documentContent\n            }\n        });\n        // Open the document in a new tab\n        const documentUrl = `https://docs.google.com/document/d/${documentId}/edit`;\n        window.open(documentUrl, '_blank');\n        console.log('Successfully exported to Google Docs:', documentId);\n        return documentId;\n    } catch (error) {\n        console.error('Error exporting to Google Docs:', error);\n        throw new Error(`Failed to export to Google Docs: ${error.message}`);\n    }\n}\nasync function $8ca4b0f2a2d350fa$export$c2a66907bba54045(data) {\n    try {\n        // Ensure authentication\n        if (!await $8ca4b0f2a2d350fa$export$e4bd7e369fe3a1ee()) throw new Error('Google authentication required');\n        const { powerData: powerData, rawMeasurements: rawMeasurements, sessionStartTime: sessionStartTime } = data;\n        const sessionDate = sessionStartTime ? new Date(sessionStartTime) : new Date();\n        const spreadsheetTitle = `Power Meter Data - ${sessionDate.toLocaleDateString()}`;\n        // Create the spreadsheet\n        const response = await window.gapi.client.sheets.spreadsheets.create({\n            resource: {\n                properties: {\n                    title: spreadsheetTitle\n                },\n                sheets: [\n                    {\n                        properties: {\n                            title: 'Summary Data',\n                            gridProperties: {\n                                rowCount: Math.max(1000, powerData.length + 10),\n                                columnCount: 10\n                            }\n                        }\n                    },\n                    {\n                        properties: {\n                            title: 'Raw Measurements',\n                            gridProperties: {\n                                rowCount: Math.max(1000, rawMeasurements.length + 10),\n                                columnCount: 8\n                            }\n                        }\n                    }\n                ]\n            }\n        });\n        const spreadsheetId = response.result.spreadsheetId;\n        // Prepare data for sheets\n        const summaryData = $8ca4b0f2a2d350fa$var$generateSheetsData(powerData, 'summary');\n        const rawData = $8ca4b0f2a2d350fa$var$generateSheetsData(rawMeasurements, 'raw');\n        // Update the sheets with data\n        await window.gapi.client.sheets.spreadsheets.values.batchUpdate({\n            spreadsheetId: spreadsheetId,\n            resource: {\n                valueInputOption: 'RAW',\n                data: [\n                    {\n                        range: 'Summary Data!A1',\n                        values: summaryData\n                    },\n                    {\n                        range: 'Raw Measurements!A1',\n                        values: rawData\n                    }\n                ]\n            }\n        });\n        // Apply formatting\n        await $8ca4b0f2a2d350fa$var$formatGoogleSheet(spreadsheetId);\n        // Open the spreadsheet in a new tab\n        const spreadsheetUrl = `https://docs.google.com/spreadsheets/d/${spreadsheetId}/edit`;\n        window.open(spreadsheetUrl, '_blank');\n        console.log('Successfully exported to Google Sheets:', spreadsheetId);\n        return spreadsheetId;\n    } catch (error) {\n        console.error('Error exporting to Google Sheets:', error);\n        throw new Error(`Failed to export to Google Sheets: ${error.message}`);\n    }\n}\n/* ==========================================================================\n   Google Docs Content Generation\n   ========================================================================== */ /**\n * Generate Google Docs document content with rich formatting\n * @param {Array} powerData - Array of power data points\n * @param {Object} powerAverages - Power averages object\n * @param {Date} sessionDate - Session date\n * @returns {Array} Array of Google Docs API requests\n */ function $8ca4b0f2a2d350fa$var$generateGoogleDocsContent(powerData, powerAverages, sessionDate) {\n    const requests = [];\n    let insertIndex = 1;\n    // Document title and header\n    const headerText = `Power Meter Session Report\\n${sessionDate.toLocaleDateString()} ${sessionDate.toLocaleTimeString()}\\n\\n`;\n    requests.push({\n        insertText: {\n            location: {\n                index: insertIndex\n            },\n            text: headerText\n        }\n    });\n    insertIndex += headerText.length;\n    // Format header\n    requests.push({\n        updateTextStyle: {\n            range: {\n                startIndex: 1,\n                endIndex: headerText.indexOf('\\n')\n            },\n            textStyle: {\n                bold: true,\n                fontSize: {\n                    magnitude: 18,\n                    unit: 'PT'\n                }\n            },\n            fields: 'bold,fontSize'\n        }\n    });\n    // Session Summary\n    const summaryText = $8ca4b0f2a2d350fa$var$generateSessionSummary(powerData, powerAverages);\n    requests.push({\n        insertText: {\n            location: {\n                index: insertIndex\n            },\n            text: summaryText\n        }\n    });\n    insertIndex += summaryText.length;\n    // Data table\n    if (powerData.length > 0) {\n        const tableData = $8ca4b0f2a2d350fa$var$generateDocumentTable(powerData);\n        requests.push({\n            insertTable: {\n                location: {\n                    index: insertIndex\n                },\n                rows: tableData.length,\n                columns: tableData[0].length\n            }\n        });\n        // Fill table with data (simplified for document formatting)\n        // Note: Actual table insertion would require more complex API calls\n        insertIndex += 50; // Approximate offset for table content\n    }\n    return requests;\n}\n/**\n * Generate session summary text for Google Docs\n * @param {Array} powerData - Array of power data points\n * @param {Object} powerAverages - Power averages object\n * @returns {string} Formatted summary text\n */ function $8ca4b0f2a2d350fa$var$generateSessionSummary(powerData, powerAverages) {\n    if (powerData.length === 0) return \"Session Summary\\n\\nNo data recorded during this session.\\n\\n\";\n    const duration = $8ca4b0f2a2d350fa$var$calculateSessionDuration(powerData);\n    const stats = $8ca4b0f2a2d350fa$var$calculateSessionStats(powerData);\n    let summary = \"Session Summary\\n\\n\";\n    summary += `Duration: ${$8ca4b0f2a2d350fa$var$formatDuration(duration)}\\n`;\n    summary += `Total Data Points: ${powerData.length}\\n`;\n    summary += `Average Power: ${stats.avgPower.toFixed(1)} W\\n`;\n    summary += `Maximum Power: ${stats.maxPower} W\\n`;\n    summary += `Minimum Power: ${stats.minPower} W\\n`;\n    if (stats.avgHeartRate > 0) {\n        summary += `Average Heart Rate: ${stats.avgHeartRate.toFixed(0)} BPM\\n`;\n        summary += `Maximum Heart Rate: ${stats.maxHeartRate} BPM\\n`;\n    }\n    if (stats.avgCadence > 0) {\n        summary += `Average Cadence: ${stats.avgCadence.toFixed(0)} RPM\\n`;\n        summary += `Maximum Cadence: ${stats.maxCadence} RPM\\n`;\n    }\n    if (powerAverages) {\n        summary += \"\\nPower Averages:\\n\";\n        if (powerAverages.fiveSecond) summary += `5-second: ${powerAverages.fiveSecond.toFixed(1)} W\\n`;\n        if (powerAverages.thirtySecond) summary += `30-second: ${powerAverages.thirtySecond.toFixed(1)} W\\n`;\n        if (powerAverages.oneMinute) summary += `1-minute: ${powerAverages.oneMinute.toFixed(1)} W\\n`;\n        if (powerAverages.fiveMinute) summary += `5-minute: ${powerAverages.fiveMinute.toFixed(1)} W\\n`;\n    }\n    return summary + \"\\n\\nDetailed Data\\n\\n\";\n}\n/**\n * Generate table data for Google Docs\n * @param {Array} powerData - Array of power data points\n * @returns {Array<Array>} 2D array representing table data\n */ function $8ca4b0f2a2d350fa$var$generateDocumentTable(powerData) {\n    const table = [\n        [\n            'Time',\n            'Power (W)',\n            'Heart Rate (BPM)',\n            'Cadence (RPM)'\n        ]\n    ];\n    powerData.slice(0, 50).forEach((point)=>{\n        const time = new Date(point.timestamp).toLocaleTimeString();\n        table.push([\n            time,\n            point.power || '--',\n            point.heartRate || '--',\n            point.cadence || '--'\n        ]);\n    });\n    if (powerData.length > 50) {\n        table.push([\n            '...',\n            '...',\n            '...',\n            '...'\n        ]);\n        table.push([\n            `${powerData.length} total data points`,\n            '',\n            '',\n            ''\n        ]);\n    }\n    return table;\n}\n/* ==========================================================================\n   Google Sheets Content Generation\n   ========================================================================== */ /**\n * Generate data for Google Sheets\n * @param {Array} data - Array of data points\n * @param {string} type - Type of data ('summary' or 'raw')\n * @returns {Array<Array>} 2D array for Google Sheets\n */ function $8ca4b0f2a2d350fa$var$generateSheetsData(data, type) {\n    if (type === 'summary') return $8ca4b0f2a2d350fa$var$generateSummarySheetData(data);\n    else if (type === 'raw') return $8ca4b0f2a2d350fa$var$generateRawSheetData(data);\n    return [];\n}\n/**\n * Generate summary sheet data\n * @param {Array} powerData - Array of power data points\n * @returns {Array<Array>} 2D array for summary sheet\n */ function $8ca4b0f2a2d350fa$var$generateSummarySheetData(powerData) {\n    const headers = [\n        'Timestamp',\n        'Power (W)',\n        'Heart Rate (BPM)',\n        'Cadence (RPM)',\n        'Time (s)'\n    ];\n    const rows = [\n        headers\n    ];\n    powerData.forEach((point, index)=>{\n        const timestamp = new Date(point.timestamp).toISOString();\n        const timeSeconds = index; // Approximate time in seconds\n        rows.push([\n            timestamp,\n            point.power || '',\n            point.heartRate || '',\n            point.cadence || '',\n            timeSeconds\n        ]);\n    });\n    return rows;\n}\n/**\n * Generate raw measurements sheet data\n * @param {Array} rawMeasurements - Array of raw measurement data\n * @returns {Array<Array>} 2D array for raw measurements sheet\n */ function $8ca4b0f2a2d350fa$var$generateRawSheetData(rawMeasurements) {\n    const headers = [\n        'Timestamp',\n        'Flags',\n        'Data Length',\n        'Instantaneous Power',\n        'Raw Bytes'\n    ];\n    const rows = [\n        headers\n    ];\n    rawMeasurements.forEach((measurement)=>{\n        const timestamp = new Date(measurement.timestamp).toISOString();\n        rows.push([\n            timestamp,\n            measurement.flags || '',\n            measurement.dataLength || '',\n            measurement.instantaneousPower || '',\n            measurement.rawBytes || ''\n        ]);\n    });\n    return rows;\n}\n/**\n * Apply formatting to Google Sheets\n * @async\n * @param {string} spreadsheetId - Spreadsheet ID\n * @returns {Promise<void>}\n */ async function $8ca4b0f2a2d350fa$var$formatGoogleSheet(spreadsheetId) {\n    try {\n        const requests = [\n            // Format headers\n            {\n                repeatCell: {\n                    range: {\n                        sheetId: 0,\n                        startRowIndex: 0,\n                        endRowIndex: 1\n                    },\n                    cell: {\n                        userEnteredFormat: {\n                            backgroundColor: {\n                                red: 0.9,\n                                green: 0.9,\n                                blue: 0.9\n                            },\n                            textFormat: {\n                                bold: true\n                            }\n                        }\n                    },\n                    fields: 'userEnteredFormat(backgroundColor,textFormat)'\n                }\n            },\n            // Format headers for second sheet\n            {\n                repeatCell: {\n                    range: {\n                        sheetId: 1,\n                        startRowIndex: 0,\n                        endRowIndex: 1\n                    },\n                    cell: {\n                        userEnteredFormat: {\n                            backgroundColor: {\n                                red: 0.9,\n                                green: 0.9,\n                                blue: 0.9\n                            },\n                            textFormat: {\n                                bold: true\n                            }\n                        }\n                    },\n                    fields: 'userEnteredFormat(backgroundColor,textFormat)'\n                }\n            },\n            // Auto-resize columns\n            {\n                autoResizeDimensions: {\n                    dimensions: {\n                        sheetId: 0,\n                        dimension: 'COLUMNS',\n                        startIndex: 0,\n                        endIndex: 5\n                    }\n                }\n            },\n            {\n                autoResizeDimensions: {\n                    dimensions: {\n                        sheetId: 1,\n                        dimension: 'COLUMNS',\n                        startIndex: 0,\n                        endIndex: 5\n                    }\n                }\n            }\n        ];\n        await window.gapi.client.sheets.spreadsheets.batchUpdate({\n            spreadsheetId: spreadsheetId,\n            resource: {\n                requests: requests\n            }\n        });\n    } catch (error) {\n        console.warn('Failed to apply formatting to Google Sheet:', error);\n    }\n}\n/* ==========================================================================\n   Utility Functions for Cloud Exports\n   ========================================================================== */ /**\n * Calculate session duration from power data\n * @param {Array} powerData - Array of power data points\n * @returns {number} Duration in milliseconds\n */ function $8ca4b0f2a2d350fa$var$calculateSessionDuration(powerData) {\n    if (powerData.length < 2) return 0;\n    const firstTimestamp = new Date(powerData[0].timestamp).getTime();\n    const lastTimestamp = new Date(powerData[powerData.length - 1].timestamp).getTime();\n    return lastTimestamp - firstTimestamp;\n}\n/**\n * Calculate session statistics\n * @param {Array} powerData - Array of power data points\n * @returns {Object} Statistics object\n */ function $8ca4b0f2a2d350fa$var$calculateSessionStats(powerData) {\n    if (powerData.length === 0) return {\n        avgPower: 0,\n        maxPower: 0,\n        minPower: 0,\n        avgHeartRate: 0,\n        maxHeartRate: 0,\n        avgCadence: 0,\n        maxCadence: 0\n    };\n    const powers = powerData.map((p)=>p.power || 0).filter((p)=>p > 0);\n    const heartRates = powerData.map((p)=>p.heartRate || 0).filter((hr)=>hr > 0);\n    const cadences = powerData.map((p)=>p.cadence || 0).filter((c)=>c > 0);\n    return {\n        avgPower: powers.length > 0 ? powers.reduce((a, b)=>a + b, 0) / powers.length : 0,\n        maxPower: powers.length > 0 ? Math.max(...powers) : 0,\n        minPower: powers.length > 0 ? Math.min(...powers) : 0,\n        avgHeartRate: heartRates.length > 0 ? heartRates.reduce((a, b)=>a + b, 0) / heartRates.length : 0,\n        maxHeartRate: heartRates.length > 0 ? Math.max(...heartRates) : 0,\n        avgCadence: cadences.length > 0 ? cadences.reduce((a, b)=>a + b, 0) / cadences.length : 0,\n        maxCadence: cadences.length > 0 ? Math.max(...cadences) : 0\n    };\n}\n/**\n * Format duration in a human-readable format\n * @param {number} duration - Duration in milliseconds\n * @returns {string} Formatted duration string\n */ function $8ca4b0f2a2d350fa$var$formatDuration(duration) {\n    const seconds = Math.floor(duration / 1000);\n    const minutes = Math.floor(seconds / 60);\n    const hours = Math.floor(minutes / 60);\n    if (hours > 0) return `${hours}h ${minutes % 60}m ${seconds % 60}s`;\n    else if (minutes > 0) return `${minutes}m ${seconds % 60}s`;\n    else return `${seconds}s`;\n}\nfunction $8ca4b0f2a2d350fa$export$6e5af75f57c7818f() {\n    // Create modal backdrop\n    const backdrop = document.createElement('div');\n    backdrop.className = 'modal-backdrop';\n    backdrop.style.cssText = `\n        position: fixed;\n        top: 0;\n        left: 0;\n        width: 100%;\n        height: 100%;\n        background: rgba(0, 0, 0, 0.8);\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        z-index: 10000;\n    `;\n    // Create modal dialog\n    const modal = document.createElement('div');\n    modal.className = 'config-modal';\n    modal.style.cssText = `\n        background: linear-gradient(135deg, #2a2a2a 0%, #1e1e1e 100%);\n        border-radius: 12px;\n        padding: 2rem;\n        max-width: 500px;\n        width: 90%;\n        color: white;\n        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);\n        border: 1px solid rgba(255, 255, 255, 0.1);\n    `;\n    // Get current values\n    const currentClientId = localStorage.getItem('google_client_id') || '';\n    const currentApiKey = localStorage.getItem('google_api_key') || '';\n    modal.innerHTML = `\n        <h3 style=\"margin: 0 0 1.5rem 0; color: #4CAF50;\">Google API Configuration</h3>\n        <p style=\"margin-bottom: 1.5rem; color: #ccc; line-height: 1.5;\">\n            To enable cloud exports, you need to configure Google API credentials. \n            <a href=\"https://console.developers.google.com/\" target=\"_blank\" style=\"color: #4CAF50;\">\n                Get credentials from Google Cloud Console\n            </a>\n        </p>\n        \n        <div style=\"margin-bottom: 1.5rem;\">\n            <label style=\"display: block; margin-bottom: 0.5rem; color: #ddd; font-weight: 500;\">\n                Google Client ID:\n            </label>\n            <input type=\"text\" id=\"clientIdInput\" value=\"${currentClientId}\" \n                   style=\"width: 100%; padding: 0.75rem; border: 1px solid #555; border-radius: 6px; \n                          background: #333; color: white; font-size: 0.9rem;\" \n                   placeholder=\"your-client-id.googleusercontent.com\">\n        </div>\n        \n        <div style=\"margin-bottom: 2rem;\">\n            <label style=\"display: block; margin-bottom: 0.5rem; color: #ddd; font-weight: 500;\">\n                Google API Key:\n            </label>\n            <input type=\"text\" id=\"apiKeyInput\" value=\"${currentApiKey}\" \n                   style=\"width: 100%; padding: 0.75rem; border: 1px solid #555; border-radius: 6px; \n                          background: #333; color: white; font-size: 0.9rem;\" \n                   placeholder=\"your-api-key\">\n        </div>\n        \n        <div style=\"display: flex; gap: 1rem; justify-content: flex-end;\">\n            <button id=\"cancelConfig\" style=\"padding: 0.75rem 1.5rem; border: 1px solid #666; \n                                           background: transparent; color: white; border-radius: 6px; \n                                           cursor: pointer; transition: all 0.3s ease;\">\n                Cancel\n            </button>\n            <button id=\"saveConfig\" style=\"padding: 0.75rem 1.5rem; border: none; \n                                         background: linear-gradient(135deg, #4CAF50 0%, #388E3C 100%); \n                                         color: white; border-radius: 6px; cursor: pointer; \n                                         transition: all 0.3s ease; font-weight: 500;\">\n                Save & Reload\n            </button>\n        </div>\n    `;\n    backdrop.appendChild(modal);\n    document.body.appendChild(backdrop);\n    // Handle button clicks\n    modal.querySelector('#cancelConfig').addEventListener('click', ()=>{\n        document.body.removeChild(backdrop);\n    });\n    modal.querySelector('#saveConfig').addEventListener('click', ()=>{\n        const clientId = modal.querySelector('#clientIdInput').value.trim();\n        const apiKey = modal.querySelector('#apiKeyInput').value.trim();\n        if (clientId && apiKey) {\n            localStorage.setItem('google_client_id', clientId);\n            localStorage.setItem('google_api_key', apiKey);\n            document.body.removeChild(backdrop);\n            // Show success message and reload\n            alert('Google API credentials saved successfully! The page will reload to apply changes.');\n            window.location.reload();\n        } else alert('Please enter both Client ID and API Key.');\n    });\n    // Handle backdrop click\n    backdrop.addEventListener('click', (e)=>{\n        if (e.target === backdrop) document.body.removeChild(backdrop);\n    });\n    // Focus on first input\n    setTimeout(()=>{\n        modal.querySelector('#clientIdInput').focus();\n    }, 100);\n}\nfunction $8ca4b0f2a2d350fa$export$7175fb5d7bb0d68b() {\n    // Create modal backdrop\n    const backdrop = document.createElement('div');\n    backdrop.className = 'modal-backdrop';\n    backdrop.style.cssText = `\n        position: fixed;\n        top: 0;\n        left: 0;\n        width: 100%;\n        height: 100%;\n        background: rgba(0, 0, 0, 0.8);\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        z-index: 10000;\n    `;\n    // Create modal dialog\n    const modal = document.createElement('div');\n    modal.className = 'config-modal';\n    modal.style.cssText = `\n        background: linear-gradient(135deg, #2a2a2a 0%, #1e1e1e 100%);\n        border-radius: 12px;\n        padding: 2rem;\n        max-width: 500px;\n        width: 90%;\n        color: white;\n        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);\n        border: 1px solid rgba(255, 255, 255, 0.1);\n    `;\n    // Get current values\n    const currentApiKey = localStorage.getItem('intervals_api_key') || '';\n    const currentAthleteId = localStorage.getItem('intervals_athlete_id') || '';\n    modal.innerHTML = `\n        <h3 style=\"margin: 0 0 1.5rem 0; color: #FF6B35;\">intervals.icu Configuration</h3>\n        <p style=\"margin-bottom: 1.5rem; color: #ccc; line-height: 1.5;\">\n            Configure your intervals.icu credentials to export activities directly. \n            <a href=\"https://intervals.icu/settings\" target=\"_blank\" style=\"color: #FF6B35;\">\n                Get your API key from intervals.icu settings\n            </a>\n        </p>\n        \n        <div style=\"margin-bottom: 1.5rem;\">\n            <label style=\"display: block; margin-bottom: 0.5rem; color: #ddd; font-weight: 500;\">\n                API Key:\n            </label>\n            <input type=\"text\" id=\"intervalsApiKeyInput\" value=\"${currentApiKey}\" \n                   style=\"width: 100%; padding: 0.75rem; border: 1px solid #555; border-radius: 6px; \n                          background: #333; color: white; font-size: 0.9rem;\" \n                   placeholder=\"your-intervals-api-key\">\n            <small style=\"color: #aaa; font-size: 0.8rem;\">\n                Found in intervals.icu \\u{2192} Settings \\u{2192} Developer\n            </small>\n        </div>\n        \n        <div style=\"margin-bottom: 2rem;\">\n            <label style=\"display: block; margin-bottom: 0.5rem; color: #ddd; font-weight: 500;\">\n                Athlete ID:\n            </label>\n            <input type=\"text\" id=\"intervalsAthleteIdInput\" value=\"${currentAthleteId}\" \n                   style=\"width: 100%; padding: 0.75rem; border: 1px solid #555; border-radius: 6px; \n                          background: #333; color: white; font-size: 0.9rem;\" \n                   placeholder=\"i123456\">\n            <small style=\"color: #aaa; font-size: 0.8rem;\">\n                Your athlete ID (usually starts with 'i' followed by numbers)\n            </small>\n        </div>\n        \n        <div style=\"display: flex; gap: 1rem; justify-content: flex-end;\">\n            <button id=\"cancelIntervalsConfig\" style=\"padding: 0.75rem 1.5rem; border: 1px solid #666; \n                                                    background: transparent; color: white; border-radius: 6px; \n                                                    cursor: pointer; transition: all 0.3s ease;\">\n                Cancel\n            </button>\n            <button id=\"saveIntervalsConfig\" style=\"padding: 0.75rem 1.5rem; border: none; \n                                                   background: linear-gradient(135deg, #FF6B35 0%, #E55A2B 100%); \n                                                   color: white; border-radius: 6px; cursor: pointer; \n                                                   transition: all 0.3s ease; font-weight: 500;\">\n                Save & Test\n            </button>\n        </div>\n    `;\n    backdrop.appendChild(modal);\n    document.body.appendChild(backdrop);\n    // Handle button clicks\n    modal.querySelector('#cancelIntervalsConfig').addEventListener('click', ()=>{\n        document.body.removeChild(backdrop);\n    });\n    modal.querySelector('#saveIntervalsConfig').addEventListener('click', async ()=>{\n        const apiKey = modal.querySelector('#intervalsApiKeyInput').value.trim();\n        const athleteId = modal.querySelector('#intervalsAthleteIdInput').value.trim();\n        if (apiKey && athleteId) try {\n            // Test the configuration\n            const testResult = await $8ca4b0f2a2d350fa$var$testIntervalsConnection(apiKey, athleteId);\n            if (testResult.success) {\n                localStorage.setItem('intervals_api_key', apiKey);\n                localStorage.setItem('intervals_athlete_id', athleteId);\n                $8ca4b0f2a2d350fa$export$1aa14f7a5d6e27b0(apiKey, athleteId);\n                document.body.removeChild(backdrop);\n                alert(`intervals.icu configured successfully!\\\\nAthlete: ${testResult.athleteName || athleteId}`);\n            } else alert(`Configuration test failed: ${testResult.error}`);\n        } catch (error) {\n            alert(`Error testing configuration: ${error.message}`);\n        }\n        else alert('Please enter both API Key and Athlete ID.');\n    });\n    // Handle backdrop click\n    backdrop.addEventListener('click', (e)=>{\n        if (e.target === backdrop) document.body.removeChild(backdrop);\n    });\n    // Focus on first input\n    setTimeout(()=>{\n        modal.querySelector('#intervalsApiKeyInput').focus();\n    }, 100);\n}\n/**\n * Test intervals.icu connection with provided credentials\n * @async\n * @param {string} apiKey - intervals.icu API key\n * @param {string} athleteId - intervals.icu athlete ID\n * @returns {Promise<Object>} Test result object\n */ async function $8ca4b0f2a2d350fa$var$testIntervalsConnection(apiKey, athleteId) {\n    try {\n        const response = await fetch(`${$8ca4b0f2a2d350fa$var$INTERVALS_CONFIG.BASE_URL}/athlete/${athleteId}`, {\n            method: 'GET',\n            headers: {\n                'Authorization': `Basic ${btoa(`API_KEY:${apiKey}`)}`\n            }\n        });\n        if (!response.ok) {\n            const errorText = await response.text();\n            return {\n                success: false,\n                error: `API error: ${response.status} - ${errorText}`\n            };\n        }\n        const athleteData = await response.json();\n        return {\n            success: true,\n            athleteName: athleteData.name || athleteData.username,\n            athleteData: athleteData\n        };\n    } catch (error) {\n        return {\n            success: false,\n            error: error.message\n        };\n    }\n}\n\n\nfunction $1fea2fc27e5705f2$export$a32390f93c1373db(dataStore) {\n    const modal = $1fea2fc27e5705f2$var$createExportModal(\"\\uD83D\\uDCC4 Basic Exports\", 'Export your session data in various formats');\n    const buttons = [\n        {\n            text: \"\\uD83D\\uDCCB Export Summary JSON\",\n            description: 'Session summary with averages',\n            onClick: ()=>{\n                (0, $8ca4b0f2a2d350fa$export$20b155984c11fcae)(dataStore.powerData);\n                $1fea2fc27e5705f2$var$closeModal(modal);\n            }\n        },\n        {\n            text: \"\\uD83D\\uDCCA Export Summary CSV\",\n            description: 'Session summary for spreadsheets',\n            onClick: ()=>{\n                (0, $8ca4b0f2a2d350fa$export$dfe05421fb7443f9)(dataStore.powerData);\n                $1fea2fc27e5705f2$var$closeModal(modal);\n            }\n        },\n        {\n            text: \"\\uD83C\\uDFC3 Export TCX\",\n            description: 'Training Center XML format',\n            onClick: ()=>{\n                try {\n                    (0, $8ca4b0f2a2d350fa$export$55f444e58fd8eb49)(dataStore.powerData);\n                    $1fea2fc27e5705f2$var$closeModal(modal);\n                } catch (error) {\n                    alert(`Error generating TCX file: ${error.message}`);\n                }\n            }\n        },\n        {\n            text: \"\\uD83D\\uDD0D Export Raw JSON\",\n            description: 'Complete measurement data',\n            onClick: ()=>{\n                (0, $8ca4b0f2a2d350fa$export$bb00655dce19035c)(dataStore.rawPowerMeasurements);\n                $1fea2fc27e5705f2$var$closeModal(modal);\n            }\n        },\n        {\n            text: \"\\uD83D\\uDCC8 Export Raw CSV\",\n            description: 'Raw measurements for analysis',\n            onClick: ()=>{\n                (0, $8ca4b0f2a2d350fa$export$5e37402f32542f6f)(dataStore.rawPowerMeasurements);\n                $1fea2fc27e5705f2$var$closeModal(modal);\n            }\n        },\n        {\n            text: \"\\uD83D\\uDDBC\\uFE0F Export Summary Image\",\n            description: 'Visual summary of your session',\n            className: 'primary',\n            onClick: async ()=>{\n                try {\n                    await (0, $8ca4b0f2a2d350fa$export$ee1eca645500f8af)({\n                        dataPoints: dataStore.powerData,\n                        powerAverages: dataStore.getPowerAverages()\n                    });\n                    $1fea2fc27e5705f2$var$closeModal(modal);\n                } catch (error) {\n                    alert(`Error generating summary image: ${error.message}`);\n                }\n            }\n        }\n    ];\n    $1fea2fc27e5705f2$var$addButtonsToModal(modal, buttons);\n    $1fea2fc27e5705f2$var$showModal(modal);\n}\nfunction $1fea2fc27e5705f2$export$bcd78b1167a6af4b(dataStore) {\n    const modal = $1fea2fc27e5705f2$var$createExportModal(\"\\u2601\\uFE0F Cloud Exports\", 'Export to cloud services and platforms');\n    const isSignedIn = (0, $8ca4b0f2a2d350fa$export$d6129adf4612fdfb)();\n    const buttons = [\n        {\n            text: isSignedIn ? \"\\uD83D\\uDD13 Sign Out from Google\" : \"\\uD83D\\uDD17 Sign In to Google\",\n            description: isSignedIn ? 'Sign out from Google account' : 'Sign in to enable Google exports',\n            className: isSignedIn ? 'danger' : 'success',\n            onClick: async ()=>{\n                try {\n                    if (isSignedIn) {\n                        await (0, $8ca4b0f2a2d350fa$export$6ec42103ddca7218)();\n                        alert('Signed out successfully!');\n                    } else {\n                        const success = await (0, $8ca4b0f2a2d350fa$export$e4bd7e369fe3a1ee)();\n                        if (success) alert('Signed in successfully!');\n                    }\n                    $1fea2fc27e5705f2$var$closeModal(modal);\n                    // Re-open modal to reflect new state\n                    setTimeout(()=>$1fea2fc27e5705f2$export$bcd78b1167a6af4b(dataStore), 100);\n                } catch (error) {\n                    alert(`Google authentication error: ${error.message}`);\n                }\n            }\n        },\n        {\n            text: \"\\uD83D\\uDCC4 Export to Google Docs\",\n            description: 'Create a formatted session report',\n            disabled: !isSignedIn,\n            onClick: async ()=>{\n                if (!isSignedIn) return;\n                try {\n                    await (0, $8ca4b0f2a2d350fa$export$33ba7bf2bc167957)({\n                        powerData: dataStore.powerData,\n                        powerAverages: dataStore.getPowerAverages(),\n                        sessionStartTime: dataStore.sessionStartTime\n                    });\n                    alert('Successfully exported to Google Docs!');\n                    $1fea2fc27e5705f2$var$closeModal(modal);\n                } catch (error) {\n                    alert(`Error exporting to Google Docs: ${error.message}`);\n                }\n            }\n        },\n        {\n            text: \"\\uD83D\\uDCCA Export to Google Sheets\",\n            description: 'Create a detailed data spreadsheet',\n            disabled: !isSignedIn,\n            onClick: async ()=>{\n                if (!isSignedIn) return;\n                try {\n                    await (0, $8ca4b0f2a2d350fa$export$c2a66907bba54045)({\n                        powerData: dataStore.powerData,\n                        powerAverages: dataStore.getPowerAverages(),\n                        rawMeasurements: dataStore.rawPowerMeasurements,\n                        sessionStartTime: dataStore.sessionStartTime\n                    });\n                    alert('Successfully exported to Google Sheets!');\n                    $1fea2fc27e5705f2$var$closeModal(modal);\n                } catch (error) {\n                    alert(`Error exporting to Google Sheets: ${error.message}`);\n                }\n            }\n        },\n        {\n            text: \"\\u2699\\uFE0F Configure Google API\",\n            description: 'Set up Google API credentials',\n            onClick: ()=>{\n                $1fea2fc27e5705f2$var$closeModal(modal);\n                (0, $8ca4b0f2a2d350fa$export$6e5af75f57c7818f)();\n            }\n        }\n    ];\n    $1fea2fc27e5705f2$var$addButtonsToModal(modal, buttons);\n    $1fea2fc27e5705f2$var$showModal(modal);\n}\nfunction $1fea2fc27e5705f2$export$2237a2cd8c48dfed(dataStore) {\n    const modal = $1fea2fc27e5705f2$var$createExportModal(\"\\uD83C\\uDFC3 Training Platforms\", 'Export to training analysis platforms');\n    const isConfigured = (0, $8ca4b0f2a2d350fa$export$abbccf31f198d0dc)();\n    const buttons = [\n        {\n            text: \"\\uD83D\\uDEB4 Export to intervals.icu\",\n            description: 'Upload activity to intervals.icu',\n            disabled: !isConfigured,\n            onClick: async ()=>{\n                if (!isConfigured) return;\n                try {\n                    await (0, $8ca4b0f2a2d350fa$export$7eff8e3a92135016)({\n                        powerData: dataStore.powerData,\n                        powerAverages: dataStore.getPowerAverages(),\n                        sessionStartTime: dataStore.sessionStartTime\n                    });\n                    alert('Successfully exported to intervals.icu!');\n                    $1fea2fc27e5705f2$var$closeModal(modal);\n                } catch (error) {\n                    alert(`Error exporting to intervals.icu: ${error.message}`);\n                }\n            }\n        },\n        {\n            text: \"\\u2699\\uFE0F Configure intervals.icu\",\n            description: 'Set up intervals.icu credentials',\n            onClick: ()=>{\n                $1fea2fc27e5705f2$var$closeModal(modal);\n                (0, $8ca4b0f2a2d350fa$export$7175fb5d7bb0d68b)();\n            }\n        }\n    ];\n    $1fea2fc27e5705f2$var$addButtonsToModal(modal, buttons);\n    $1fea2fc27e5705f2$var$showModal(modal);\n}\nfunction $1fea2fc27e5705f2$export$a2134b5aa2aa2315(dataStore) {\n    const modal = $1fea2fc27e5705f2$var$createExportModal(\"\\uD83D\\uDEE0\\uFE0F Utilities\", 'Session management and utilities');\n    const buttons = [\n        {\n            text: \"\\uD83D\\uDDD1\\uFE0F Clear Session Data\",\n            description: 'Clear all session data (cannot be undone)',\n            className: 'danger',\n            onClick: ()=>{\n                const confirmed = confirm('Are you sure you want to clear all session data? This action cannot be undone.');\n                if (confirmed) {\n                    dataStore.resetAllSessionData();\n                    alert('Session data cleared successfully!');\n                    $1fea2fc27e5705f2$var$closeModal(modal);\n                }\n            }\n        }\n    ];\n    $1fea2fc27e5705f2$var$addButtonsToModal(modal, buttons);\n    $1fea2fc27e5705f2$var$showModal(modal);\n}\n/**\n * Create export modal with header\n * @param {string} title - Modal title\n * @param {string} description - Modal description\n * @returns {HTMLElement} Modal element\n */ function $1fea2fc27e5705f2$var$createExportModal(title, description) {\n    const modal = document.createElement('div');\n    modal.className = 'export-modal';\n    modal.innerHTML = `\n        <div class=\"export-modal-content\">\n            <div class=\"export-modal-header\">\n                <h3 class=\"export-modal-title\">${title}</h3>\n                <button class=\"export-modal-close\" aria-label=\"Close modal\">&times;</button>\n            </div>\n            <div class=\"export-modal-description\">${description}</div>\n            <div class=\"export-modal-buttons\"></div>\n        </div>\n    `;\n    // Add close functionality\n    const closeBtn = modal.querySelector('.export-modal-close');\n    closeBtn.addEventListener('click', ()=>$1fea2fc27e5705f2$var$closeModal(modal));\n    modal.addEventListener('click', (e)=>{\n        if (e.target === modal) $1fea2fc27e5705f2$var$closeModal(modal);\n    });\n    return modal;\n}\n/**\n * Add buttons to modal\n * @param {HTMLElement} modal - Modal element\n * @param {Array} buttons - Array of button configurations\n */ function $1fea2fc27e5705f2$var$addButtonsToModal(modal, buttons) {\n    const buttonsContainer = modal.querySelector('.export-modal-buttons');\n    buttons.forEach((buttonConfig)=>{\n        const button = document.createElement('button');\n        button.className = `export-modal-button ${buttonConfig.className || ''}`;\n        button.disabled = buttonConfig.disabled || false;\n        button.innerHTML = `\n            <span>${buttonConfig.text}</span>\n            ${buttonConfig.description ? `<small style=\"opacity: 0.7; font-size: 0.8em;\">${buttonConfig.description}</small>` : ''}\n        `;\n        button.addEventListener('click', buttonConfig.onClick);\n        buttonsContainer.appendChild(button);\n    });\n}\n/**\n * Show modal with animation\n * @param {HTMLElement} modal - Modal element\n */ function $1fea2fc27e5705f2$var$showModal(modal) {\n    document.body.appendChild(modal);\n    // Trigger animation\n    requestAnimationFrame(()=>{\n        modal.classList.add('show');\n    });\n}\n/**\n * Close modal with animation\n * @param {HTMLElement} modal - Modal element\n */ function $1fea2fc27e5705f2$var$closeModal(modal) {\n    modal.classList.remove('show');\n    setTimeout(()=>{\n        if (modal.parentNode) document.body.removeChild(modal);\n    }, 300);\n}\nfunction $1fea2fc27e5705f2$export$313373f1d10aa459(dataStore) {\n    // Initialize export section as collapsed by default\n    $1fea2fc27e5705f2$var$initializeExportSection();\n    // Setup export section toggle\n    $1fea2fc27e5705f2$var$setupExportSectionToggle();\n    // Basic exports\n    const basicMenuItem = document.getElementById('exportBasicMenuItem');\n    if (basicMenuItem) basicMenuItem.addEventListener('click', ()=>{\n        $1fea2fc27e5705f2$export$a32390f93c1373db(dataStore);\n    });\n    // Cloud exports\n    const cloudMenuItem = document.getElementById('exportCloudMenuItem');\n    if (cloudMenuItem) cloudMenuItem.addEventListener('click', ()=>{\n        $1fea2fc27e5705f2$export$bcd78b1167a6af4b(dataStore);\n    });\n    // Training platforms\n    const servicesMenuItem = document.getElementById('exportServicesMenuItem');\n    if (servicesMenuItem) servicesMenuItem.addEventListener('click', ()=>{\n        $1fea2fc27e5705f2$export$2237a2cd8c48dfed(dataStore);\n    });\n    // Utilities\n    const utilsMenuItem = document.getElementById('exportUtilsMenuItem');\n    if (utilsMenuItem) utilsMenuItem.addEventListener('click', ()=>{\n        $1fea2fc27e5705f2$export$a2134b5aa2aa2315(dataStore);\n    });\n}\n/**\n * Initialize export section to be collapsed by default\n */ function $1fea2fc27e5705f2$var$initializeExportSection() {\n    const exportSection = document.getElementById('exportMenuSection');\n    if (exportSection) exportSection.classList.add('collapsed');\n}\n/**\n * Setup export section toggle functionality\n */ function $1fea2fc27e5705f2$var$setupExportSectionToggle() {\n    const toggleHeader = document.getElementById('exportSectionToggleHeader');\n    const exportSection = document.getElementById('exportMenuSection');\n    if (toggleHeader && exportSection) toggleHeader.addEventListener('click', ()=>{\n        exportSection.classList.toggle('collapsed');\n    });\n}\n\n\n/**\n * Notification System Module\n * Handles displaying temporary notifications to the user\n */ /**\n * Show a notification that the session was restored\n * @param {number} dataPointCount - Number of data points recovered\n */ function $e75b18aae82f997e$export$2e6e6fe5543dc30c(dataPointCount) {\n    const notification = document.createElement('div');\n    notification.style.cssText = `\n    position: fixed;\n    top: 20px;\n    right: 20px;\n    background: #4CAF50;\n    color: white;\n    padding: 1rem 1.5rem;\n    border-radius: 8px;\n    z-index: 1000;\n    font-size: 0.9rem;\n    box-shadow: 0 4px 12px rgba(0,0,0,0.3);\n    animation: slideIn 0.3s ease-out;\n  `;\n    notification.textContent = `Session restored! ${dataPointCount} data points recovered.`;\n    // Add animation\n    const style = document.createElement('style');\n    style.textContent = `\n    @keyframes slideIn {\n      from { transform: translateX(100%); opacity: 0; }\n      to { transform: translateX(0); opacity: 1; }\n    }\n  `;\n    document.head.appendChild(style);\n    document.body.appendChild(notification);\n    // Remove notification after 5 seconds\n    setTimeout(()=>{\n        notification.style.animation = 'slideIn 0.3s ease-out reverse';\n        setTimeout(()=>{\n            if (notification.parentNode) notification.parentNode.removeChild(notification);\n            if (style.parentNode) style.parentNode.removeChild(style);\n        }, 300);\n    }, 5000);\n}\nfunction $e75b18aae82f997e$export$f7dc72e91f29c7d7(message, type = 'info', duration = 5000) {\n    const colorMap = {\n        success: '#4CAF50',\n        error: '#f44336',\n        warning: '#ff9800',\n        info: '#2196F3'\n    };\n    const notification = document.createElement('div');\n    notification.style.cssText = `\n    position: fixed;\n    top: 20px;\n    right: 20px;\n    background: ${colorMap[type] || colorMap.info};\n    color: white;\n    padding: 1rem 1.5rem;\n    border-radius: 8px;\n    z-index: 1000;\n    font-size: 0.9rem;\n    box-shadow: 0 4px 12px rgba(0,0,0,0.3);\n    animation: slideIn 0.3s ease-out;\n    max-width: 300px;\n    word-wrap: break-word;\n  `;\n    notification.textContent = message;\n    // Add animation if not already added\n    if (!document.getElementById('notification-styles')) {\n        const style = document.createElement('style');\n        style.id = 'notification-styles';\n        style.textContent = `\n      @keyframes slideIn {\n        from { transform: translateX(100%); opacity: 0; }\n        to { transform: translateX(0); opacity: 1; }\n      }\n    `;\n        document.head.appendChild(style);\n    }\n    document.body.appendChild(notification);\n    // Remove notification after specified duration\n    setTimeout(()=>{\n        notification.style.animation = 'slideIn 0.3s ease-out reverse';\n        setTimeout(()=>{\n            if (notification.parentNode) notification.parentNode.removeChild(notification);\n        }, 300);\n    }, duration);\n}\n\n\n/**\n * UI Event Handlers Module\n * Handles all UI event listeners for toggles, menus, and interactions\n */ /**\n * Show application information and usage instructions\n */ function $c8a6253a3b39b109$export$f844e123cf67dae8() {\n    const modal = document.createElement('div');\n    modal.className = 'modal-backdrop';\n    modal.style.cssText = `\n        position: fixed;\n        top: 0;\n        left: 0;\n        width: 100%;\n        height: 100%;\n        background: rgba(0, 0, 0, 0.8);\n        display: flex;\n        justify-content: center;\n        align-items: center;\n        z-index: 1000;\n    `;\n    const modalContent = document.createElement('div');\n    modalContent.className = 'modal';\n    modalContent.style.cssText = `\n        background: #1a1a2e;\n        border-radius: 12px;\n        padding: 2rem;\n        max-width: 600px;\n        max-height: 80vh;\n        overflow-y: auto;\n        margin: 20px;\n        border: 1px solid rgba(255, 255, 255, 0.2);\n    `;\n    modalContent.innerHTML = `\n        <div style=\"text-align: center; margin-bottom: 1.5rem;\">\n            <h2 style=\"color: #3498db; margin: 0 0 0.5rem 0; font-size: 1.8rem;\">\\u{1F6B4} Web Bluetooth Power Meter</h2>\n            <p style=\"color: #cccccc; margin: 0; font-size: 1rem;\">Real-time cycling data analysis</p>\n        </div>\n\n        <div style=\"color: #ffffff; line-height: 1.6;\">\n            <h3 style=\"color: #f39c12; margin: 1.5rem 0 1rem 0;\">\\u{1F4F1} What is this app?</h3>\n            <p style=\"margin-bottom: 1rem;\">\n                This is a web-based power meter application that connects to Bluetooth cycling devices \n                to provide real-time power, heart rate, and cadence data analysis. Perfect for indoor \n                training, data logging, and performance tracking.\n            </p>\n\n            <h3 style=\"color: #f39c12; margin: 1.5rem 0 1rem 0;\">\\u{1F517} How to connect devices:</h3>\n            <ol style=\"margin-bottom: 1rem; padding-left: 1.5rem;\">\n                <li><strong>Power Meter:</strong> Click \"Connect Power Meter\" and select your cycling power device</li>\n                <li><strong>Heart Rate:</strong> Click \"Connect Heart Rate\" to pair your HR monitor</li>\n                <li><strong>Cadence:</strong> Click \"Connect Cadence\" for speed/cadence sensors</li>\n            </ol>\n\n            <h3 style=\"color: #f39c12; margin: 1.5rem 0 1rem 0;\">\\u{1F4CA} Features:</h3>\n            <ul style=\"margin-bottom: 1rem; padding-left: 1.5rem;\">\n                <li><strong>Real-time Metrics:</strong> Live power, heart rate, and cadence display</li>\n                <li><strong>Power Averages:</strong> 10s, 20s, 30s, 40s, 50s, 1m, 2m, 3m, 4m, and 5m rolling averages</li>\n                <li><strong>Data Export:</strong> JSON, CSV, TCX, and visual summary image formats</li>\n                <li><strong>Session Persistence:</strong> Data automatically saved and restored</li>\n                <li><strong>Custom Dashboard:</strong> Toggle metrics and sections via hamburger menu</li>\n            </ul>\n\n            <h3 style=\"color: #f39c12; margin: 1.5rem 0 1rem 0;\">\\u{2699}\\u{FE0F} Using the hamburger menu:</h3>\n            <ul style=\"margin-bottom: 1rem; padding-left: 1.5rem;\">\n                <li><strong>Toggle Sections:</strong> Show/hide different parts of the interface</li>\n                <li><strong>Load Debug Data:</strong> Generate 1000 test data points for testing</li>\n                <li><strong>Customize View:</strong> Control which metrics are visible</li>\n            </ul>\n\n            <h3 style=\"color: #f39c12; margin: 1.5rem 0 1rem 0;\">\\u{1F310} Browser Support:</h3>\n            <p style=\"margin-bottom: 1rem;\">\n                Requires a browser with Web Bluetooth support:\n                <br>\\u{2022} Chrome 56+ \\u{2022} Edge 79+ \\u{2022} Opera 43+\n            </p>\n\n            <h3 style=\"color: #f39c12; margin: 1.5rem 0 1rem 0;\">\\u{1F4A1} Tips:</h3>\n            <ul style=\"margin-bottom: 1.5rem; padding-left: 1.5rem;\">\n                <li>Make sure your devices are in pairing mode before connecting</li>\n                <li>Data is automatically saved to your browser's local storage</li>\n                <li>Use the export functions to save your workout data</li>\n                <li>The app works offline once loaded</li>\n            </ul>\n        </div>\n\n        <div style=\"text-align: center; margin-top: 2rem;\">\n            <button id=\"closeInfoModal\" style=\"\n                background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);\n                color: white;\n                border: none;\n                padding: 12px 24px;\n                border-radius: 8px;\n                font-size: 16px;\n                font-weight: 600;\n                cursor: pointer;\n                transition: all 0.3s ease;\n            \">Got it!</button>\n        </div>\n    `;\n    modal.appendChild(modalContent);\n    document.body.appendChild(modal);\n    // Close modal event listeners\n    const closeButton = modalContent.querySelector('#closeInfoModal');\n    const closeModal = ()=>{\n        document.body.removeChild(modal);\n    };\n    closeButton.addEventListener('click', closeModal);\n    modal.addEventListener('click', (e)=>{\n        if (e.target === modal) closeModal();\n    });\n    // Close on Escape key\n    const handleEscape = (e)=>{\n        if (e.key === 'Escape') {\n            closeModal();\n            document.removeEventListener('keydown', handleEscape);\n        }\n    };\n    document.addEventListener('keydown', handleEscape);\n    // Add hover effect to button\n    closeButton.addEventListener('mouseenter', ()=>{\n        closeButton.style.transform = 'translateY(-2px)';\n        closeButton.style.boxShadow = '0 8px 24px rgba(52, 152, 219, 0.4)';\n    });\n    closeButton.addEventListener('mouseleave', ()=>{\n        closeButton.style.transform = 'translateY(0)';\n        closeButton.style.boxShadow = 'none';\n    });\n}\n\n\n/**\n * Show QR code modal with link to the app\n */ function $0efb00cee77cf568$export$b71fa270bddad547() {\n    const appUrl = 'https://colscoding.github.io/power-saver/';\n    const modal = document.createElement('div');\n    modal.className = 'modal-backdrop';\n    modal.style.cssText = `\n        position: fixed;\n        top: 0;\n        left: 0;\n        width: 100%;\n        height: 100%;\n        background: rgba(0, 0, 0, 0.8);\n        display: flex;\n        justify-content: center;\n        align-items: center;\n        z-index: 1000;\n    `;\n    const modalContent = document.createElement('div');\n    modalContent.className = 'modal';\n    modalContent.style.cssText = `\n        background: #1a1a2e;\n        border-radius: 12px;\n        padding: 2rem;\n        max-width: 400px;\n        max-height: 80vh;\n        overflow-y: auto;\n        margin: 20px;\n        border: 1px solid rgba(255, 255, 255, 0.2);\n        text-align: center;\n    `;\n    // Create QR code canvas\n    const qrCanvas = document.createElement('canvas');\n    qrCanvas.width = 256;\n    qrCanvas.height = 256;\n    qrCanvas.style.cssText = `\n        background: white;\n        border-radius: 8px;\n        margin: 1rem 0;\n        max-width: 100%;\n        height: auto;\n    `;\n    // Generate QR code\n    $0efb00cee77cf568$var$generateQRCode(qrCanvas, appUrl);\n    modalContent.innerHTML = `\n        <div style=\"margin-bottom: 1.5rem;\">\n            <h2 style=\"color: #9b59b6; margin: 0 0 0.5rem 0; font-size: 1.8rem;\">\\u{1F4F1} Share Power Meter App</h2>\n            <p style=\"color: #cccccc; margin: 0; font-size: 1rem;\">Scan to access the app on any device</p>\n        </div>\n        \n        <div id=\"qr-container\" style=\"margin: 1.5rem 0;\"></div>\n        \n        <div style=\"margin: 1.5rem 0;\">\n            <p style=\"color: #ffffff; margin: 0 0 0.5rem 0; font-weight: 600;\">Or visit directly:</p>\n            <a href=\"${appUrl}\" target=\"_blank\" style=\"\n                color: #9b59b6; \n                text-decoration: none; \n                font-size: 0.9rem;\n                word-break: break-all;\n                line-height: 1.4;\n            \">${appUrl}</a>\n        </div>\n\n        <div style=\"text-align: center; margin-top: 2rem;\">\n            <button id=\"closeQrModal\" style=\"\n                background: linear-gradient(135deg, #9b59b6 0%, #8e44ad 100%);\n                color: white;\n                border: none;\n                padding: 12px 24px;\n                border-radius: 8px;\n                font-size: 16px;\n                font-weight: 600;\n                cursor: pointer;\n                transition: all 0.3s ease;\n            \">Close</button>\n        </div>\n    `;\n    // Insert QR code canvas\n    const qrContainer = modalContent.querySelector('#qr-container');\n    qrContainer.appendChild(qrCanvas);\n    modal.appendChild(modalContent);\n    document.body.appendChild(modal);\n    // Close modal event listeners\n    const closeButton = modalContent.querySelector('#closeQrModal');\n    const closeModal = ()=>{\n        document.body.removeChild(modal);\n    };\n    closeButton.addEventListener('click', closeModal);\n    modal.addEventListener('click', (e)=>{\n        if (e.target === modal) closeModal();\n    });\n    // Close on Escape key\n    const handleEscape = (e)=>{\n        if (e.key === 'Escape') {\n            closeModal();\n            document.removeEventListener('keydown', handleEscape);\n        }\n    };\n    document.addEventListener('keydown', handleEscape);\n    // Add hover effect to button\n    closeButton.addEventListener('mouseenter', ()=>{\n        closeButton.style.transform = 'translateY(-2px)';\n        closeButton.style.boxShadow = '0 8px 24px rgba(155, 89, 182, 0.4)';\n    });\n    closeButton.addEventListener('mouseleave', ()=>{\n        closeButton.style.transform = 'translateY(0)';\n        closeButton.style.boxShadow = 'none';\n    });\n}\n/**\n * Generate QR code on canvas using a simple QR code generation algorithm\n */ function $0efb00cee77cf568$var$generateQRCode(canvas, text) {\n    const ctx = canvas.getContext('2d');\n    const size = canvas.width;\n    // Clear canvas with white background\n    ctx.fillStyle = '#ffffff';\n    ctx.fillRect(0, 0, size, size);\n    // Simple QR code generation using an online QR code API as fallback\n    // For a production app, you'd want to include a proper QR code library\n    const qrApiUrl = `https://api.qrserver.com/v1/create-qr-code/?size=${size}x${size}&data=${encodeURIComponent(text)}`;\n    const img = new Image();\n    img.crossOrigin = 'anonymous';\n    img.onload = function() {\n        ctx.drawImage(img, 0, 0, size, size);\n    };\n    img.onerror = function() {\n        // Fallback: draw a simple pattern if QR API fails\n        $0efb00cee77cf568$var$drawFallbackQR(ctx, size);\n    };\n    img.src = qrApiUrl;\n}\n/**\n * Fallback QR code representation when API is unavailable\n */ function $0efb00cee77cf568$var$drawFallbackQR(ctx, size) {\n    ctx.fillStyle = '#000000';\n    ctx.font = '12px Arial';\n    ctx.textAlign = 'center';\n    // Draw a simple grid pattern\n    const cellSize = size / 25;\n    for(let i = 0; i < 25; i++){\n        for(let j = 0; j < 25; j++)if ((i + j) % 3 === 0 || i === 0 || i === 24 || j === 0 || j === 24) ctx.fillRect(i * cellSize, j * cellSize, cellSize, cellSize);\n    }\n    // Add text in center\n    ctx.fillStyle = '#ffffff';\n    ctx.fillRect(size * 0.2, size * 0.4, size * 0.6, size * 0.2);\n    ctx.fillStyle = '#000000';\n    ctx.fillText('QR Code', size / 2, size / 2 - 10);\n    ctx.fillText('Unavailable', size / 2, size / 2 + 10);\n}\n\n\nfunction $d455cb11b3bc64fd$export$81e17204574dbb93(elements) {\n    if (!elements.hamburgerBtn || !elements.menuDropdown) {\n        console.error('Hamburger menu elements not found:', {\n            hamburgerBtn: !!elements.hamburgerBtn,\n            menuDropdown: !!elements.menuDropdown\n        });\n        return;\n    }\n    // Hamburger menu functionality\n    elements.hamburgerBtn.addEventListener('click', function() {\n        const isActive = elements.menuDropdown.classList.contains('active');\n        if (isActive) elements.menuDropdown.classList.remove('active');\n        else elements.menuDropdown.classList.add('active');\n    });\n    // Close menu when clicking outside\n    document.addEventListener('click', function(event) {\n        if (!event.target.closest('.hamburger-menu')) elements.menuDropdown.classList.remove('active');\n    });\n}\nfunction $d455cb11b3bc64fd$export$a2f2b6b746488fd5(elements) {\n    if (!elements.powerAveragesToggle || !elements.powerAveragesSection) {\n        console.error('Power averages toggle elements not found:', {\n            powerAveragesToggle: !!elements.powerAveragesToggle,\n            powerAveragesSection: !!elements.powerAveragesSection\n        });\n        return;\n    }\n    let powerAveragesVisible = true; // Start visible by default\n    elements.powerAveragesToggle.classList.add('active'); // Set initial active state\n    elements.powerAveragesToggle.addEventListener('click', function() {\n        powerAveragesVisible = !powerAveragesVisible;\n        if (powerAveragesVisible) {\n            elements.powerAveragesSection.style.display = 'block';\n            elements.powerAveragesToggle.classList.add('active');\n        } else {\n            elements.powerAveragesSection.style.display = 'none';\n            elements.powerAveragesToggle.classList.remove('active');\n        }\n        $d455cb11b3bc64fd$var$manageCollapsedSectionsLayout();\n    });\n}\nfunction $d455cb11b3bc64fd$export$7af716748e1b2a68(elements) {\n    // Power metric toggle\n    if (elements.powerMetricToggle && elements.powerCard) {\n        let powerMetricVisible = true; // Start visible by default\n        elements.powerMetricToggle.classList.add('active'); // Set initial active state\n        elements.powerMetricToggle.addEventListener('click', function() {\n            powerMetricVisible = !powerMetricVisible;\n            if (powerMetricVisible) {\n                elements.powerCard.style.display = 'block';\n                elements.powerMetricToggle.classList.add('active');\n            } else {\n                elements.powerCard.style.display = 'none';\n                elements.powerMetricToggle.classList.remove('active');\n            }\n        });\n    } else console.error('Power metric toggle elements not found');\n    // Heart rate metric toggle\n    if (elements.heartRateMetricToggle && elements.heartRateCard) {\n        let heartRateMetricVisible = true; // Start visible by default\n        elements.heartRateMetricToggle.classList.add('active'); // Set initial active state\n        elements.heartRateMetricToggle.addEventListener('click', function() {\n            heartRateMetricVisible = !heartRateMetricVisible;\n            if (heartRateMetricVisible) {\n                elements.heartRateCard.style.display = 'block';\n                elements.heartRateMetricToggle.classList.add('active');\n            } else {\n                elements.heartRateCard.style.display = 'none';\n                elements.heartRateMetricToggle.classList.remove('active');\n            }\n        });\n    } else console.error('Heart rate metric toggle elements not found');\n    // Cadence metric toggle\n    if (elements.cadenceMetricToggle && elements.cadenceCard) {\n        let cadenceMetricVisible = true; // Start visible by default\n        elements.cadenceMetricToggle.classList.add('active'); // Set initial active state\n        elements.cadenceMetricToggle.addEventListener('click', function() {\n            cadenceMetricVisible = !cadenceMetricVisible;\n            if (cadenceMetricVisible) {\n                elements.cadenceCard.style.display = 'block';\n                elements.cadenceMetricToggle.classList.add('active');\n            } else {\n                elements.cadenceCard.style.display = 'none';\n                elements.cadenceMetricToggle.classList.remove('active');\n            }\n        });\n    } else console.error('Cadence metric toggle elements not found');\n}\nfunction $d455cb11b3bc64fd$export$847dba17d53ca76f(elements, disconnectSpyCallback) {\n    if (!elements.spyModeToggle || !elements.spyModeSection) {\n        console.error('Spy mode toggle elements not found');\n        return;\n    }\n    let spyModeVisible = false; // Start hidden by default\n    elements.spyModeToggle.addEventListener('click', function() {\n        spyModeVisible = !spyModeVisible;\n        if (spyModeVisible) {\n            elements.spyModeSection.style.display = 'block';\n            elements.spyModeToggle.classList.add('active');\n            // Make sure instructions are visible when first enabling spy mode\n            if (elements.spyInstructionsElement) elements.spyInstructionsElement.style.display = 'block';\n        } else {\n            elements.spyModeSection.style.display = 'none';\n            elements.spyModeToggle.classList.remove('active');\n            // Disconnect spy device if connected\n            disconnectSpyCallback();\n            // Reset spy display elements\n            if (elements.spyValueElement) elements.spyValueElement.textContent = '--';\n            if (elements.spyStatusElement) elements.spyStatusElement.style.display = 'none';\n            if (elements.spyInstructionsElement) elements.spyInstructionsElement.style.display = 'block';\n        }\n    });\n}\nfunction $d455cb11b3bc64fd$export$66f401d4d3f34334(elements) {\n    // Info functionality\n    if (elements.showInfoMenuItem) elements.showInfoMenuItem.addEventListener('click', function() {\n        (0, $c8a6253a3b39b109$export$f844e123cf67dae8)();\n        // Close the menu after showing info\n        if (elements.menuDropdown) elements.menuDropdown.classList.remove('active');\n    });\n    else console.error('Show info menu item not found');\n    // QR Code functionality\n    if (elements.showQrCodeMenuItem) elements.showQrCodeMenuItem.addEventListener('click', function() {\n        (0, $0efb00cee77cf568$export$b71fa270bddad547)();\n        // Close the menu after showing QR code\n        if (elements.menuDropdown) elements.menuDropdown.classList.remove('active');\n    });\n    else console.error('Show QR code menu item not found');\n}\nfunction $d455cb11b3bc64fd$export$806b3980794e0f12() {\n    const dashboard = document.querySelector('.dashboard');\n    const powerAveragesSection = document.getElementById('powerAveragesSection');\n    const powerAveragesHidden = powerAveragesSection && powerAveragesSection.style.display === 'none';\n    if (dashboard) {\n        if (powerAveragesHidden) dashboard.classList.add('maximized');\n        else dashboard.classList.remove('maximized');\n    }\n    // Manage horizontal layout for collapsed sections (excluding bottom controls)\n    $d455cb11b3bc64fd$var$manageCollapsedSectionsLayout();\n}\n/**\n * Function to manage horizontal layout of collapsed sections\n */ function $d455cb11b3bc64fd$var$manageCollapsedSectionsLayout() {\n    const dashboard = document.querySelector('.dashboard');\n    if (!dashboard) return;\n    // Only manage power averages section for collapsed layout -\n    // connect and export sections are now bottom controls and stay at bottom\n    // Note: collapsedSections logic simplified since only power averages section is managed now\n    // Remove any existing collapsed sections row\n    const existingRow = document.querySelector('.collapsed-sections-row');\n    if (existingRow) {\n        // Move sections back to their original positions\n        const sectionsInRow = existingRow.querySelectorAll('.power-averages-section');\n        sectionsInRow.forEach((section)=>{\n            // Insert sections back after the dashboard\n            dashboard.parentNode.insertBefore(section, dashboard.nextSibling);\n        });\n        existingRow.remove();\n    }\n    // Power averages section doesn't need horizontal grouping since it's the only\n    // section that can be managed this way now\n    dashboard.classList.remove('has-collapsed-sections');\n}\nfunction $d455cb11b3bc64fd$export$8edd2f9a38e90f85(elements) {\n    // Initialize power averages section as visible by default\n    if (elements.powerAveragesSection) elements.powerAveragesSection.style.display = 'block';\n    $d455cb11b3bc64fd$export$806b3980794e0f12();\n}\n\n\n// Application state variables\nlet $b63be9b0371e788c$var$powerData = [];\nlet $b63be9b0371e788c$var$rawPowerMeasurements = [];\nlet $b63be9b0371e788c$var$heartData = [];\nlet $b63be9b0371e788c$var$cadenceData = [];\nlet $b63be9b0371e788c$var$lastPowerValue = 0;\nlet $b63be9b0371e788c$var$lastHeartRateValue = 0;\nlet $b63be9b0371e788c$var$lastCadenceValue = 0;\nlet $b63be9b0371e788c$var$sessionStartTime = null;\nlet $b63be9b0371e788c$var$dataLoggerInterval = null;\n/**\n * Update displays after restoring session data\n */ function $b63be9b0371e788c$var$updateDisplaysFromRestoredData() {\n    // Update current metric values\n    (0, $26bf0f38c1315f82$export$3c5e864d031b110c)({\n        power: $b63be9b0371e788c$var$lastPowerValue,\n        heartRate: $b63be9b0371e788c$var$lastHeartRateValue,\n        cadence: $b63be9b0371e788c$var$lastCadenceValue\n    });\n    // Update power averages display\n    (0, $d8d8e1ee9f4f63bb$export$d710e02c06779035)();\n    // Show session restoration notification\n    if ($b63be9b0371e788c$var$powerData.length > 0) (0, $e75b18aae82f997e$export$2e6e6fe5543dc30c)($b63be9b0371e788c$var$powerData.length);\n}\n/**\n * Reset all session data\n */ function $b63be9b0371e788c$var$resetAllSessionData() {\n    // Clear all data arrays\n    $b63be9b0371e788c$var$powerData.length = 0;\n    $b63be9b0371e788c$var$heartData.length = 0;\n    $b63be9b0371e788c$var$cadenceData.length = 0;\n    $b63be9b0371e788c$var$rawPowerMeasurements.length = 0;\n    // Reset power averages\n    (0, $d8d8e1ee9f4f63bb$export$153010588d52d05c)();\n    // Reset last values\n    $b63be9b0371e788c$var$lastPowerValue = 0;\n    $b63be9b0371e788c$var$lastHeartRateValue = 0;\n    $b63be9b0371e788c$var$lastCadenceValue = 0;\n    $b63be9b0371e788c$var$sessionStartTime = null;\n    // Update displays\n    (0, $26bf0f38c1315f82$export$d9870def68db0ffb)();\n    // Clear localStorage\n    (0, $cc35ee5c64337d79$export$37b6cafab9b29f47)();\n}\n/**\n * Data store object to pass to modules that need access to application data\n */ const $b63be9b0371e788c$var$dataStore = {\n    get powerData () {\n        return $b63be9b0371e788c$var$powerData;\n    },\n    get rawPowerMeasurements () {\n        return $b63be9b0371e788c$var$rawPowerMeasurements;\n    },\n    get heartData () {\n        return $b63be9b0371e788c$var$heartData;\n    },\n    get cadenceData () {\n        return $b63be9b0371e788c$var$cadenceData;\n    },\n    get lastPowerValue () {\n        return $b63be9b0371e788c$var$lastPowerValue;\n    },\n    get lastHeartRateValue () {\n        return $b63be9b0371e788c$var$lastHeartRateValue;\n    },\n    get lastCadenceValue () {\n        return $b63be9b0371e788c$var$lastCadenceValue;\n    },\n    get sessionStartTime () {\n        return $b63be9b0371e788c$var$sessionStartTime;\n    },\n    getPowerAverages: $d8d8e1ee9f4f63bb$export$2a4541f58dbec1bb,\n    getPowerReadings: $d8d8e1ee9f4f63bb$export$329e6150de04eb88,\n    resetAllSessionData: $b63be9b0371e788c$var$resetAllSessionData,\n    elements: $26bf0f38c1315f82$export$7a5d735b2ab6389d\n};\n// Bluetooth connection callbacks\nconst $b63be9b0371e788c$var$powerMeterCallbacks = {\n    onPowerMeasurement: (power, rawMeasurement)=>{\n        (0, $26bf0f38c1315f82$export$38408f60e368349d)(power);\n        $b63be9b0371e788c$var$lastPowerValue = power;\n        // Store raw measurement data\n        $b63be9b0371e788c$var$rawPowerMeasurements.push(rawMeasurement);\n        // Add power reading to averaging calculations\n        (0, $d8d8e1ee9f4f63bb$export$3f67e616c0b42d09)(power);\n    },\n    onDisconnected: ()=>{\n        (0, $26bf0f38c1315f82$export$d9870def68db0ffb)();\n        (0, $d8d8e1ee9f4f63bb$export$153010588d52d05c)();\n        if ($b63be9b0371e788c$var$dataLoggerInterval) {\n            clearInterval($b63be9b0371e788c$var$dataLoggerInterval);\n            $b63be9b0371e788c$var$dataLoggerInterval = null;\n        }\n        $b63be9b0371e788c$var$lastPowerValue = 0;\n    },\n    onStatusUpdate: (message)=>{\n        if ((0, $26bf0f38c1315f82$export$7a5d735b2ab6389d).statusText) (0, $26bf0f38c1315f82$export$7a5d735b2ab6389d).statusText.textContent = message;\n    }\n};\nconst $b63be9b0371e788c$var$heartRateCallbacks = {\n    onHeartRateChange: (heartRate)=>{\n        if ((0, $26bf0f38c1315f82$export$7a5d735b2ab6389d).hrValueElement) (0, $26bf0f38c1315f82$export$7a5d735b2ab6389d).hrValueElement.textContent = heartRate;\n        $b63be9b0371e788c$var$lastHeartRateValue = heartRate;\n    },\n    onStatusUpdate: (message)=>{\n        if ((0, $26bf0f38c1315f82$export$7a5d735b2ab6389d).hrStatusText) (0, $26bf0f38c1315f82$export$7a5d735b2ab6389d).hrStatusText.textContent = message;\n    }\n};\nconst $b63be9b0371e788c$var$cadenceCallbacks = {\n    onCadenceChange: (cadence)=>{\n        if ((0, $26bf0f38c1315f82$export$7a5d735b2ab6389d).cadenceValueElement) (0, $26bf0f38c1315f82$export$7a5d735b2ab6389d).cadenceValueElement.textContent = cadence;\n        $b63be9b0371e788c$var$lastCadenceValue = cadence;\n    },\n    onStatusUpdate: (message)=>{\n        if ((0, $26bf0f38c1315f82$export$7a5d735b2ab6389d).cadenceStatusText) (0, $26bf0f38c1315f82$export$7a5d735b2ab6389d).cadenceStatusText.textContent = message;\n    }\n};\n/**\n * Setup connection button event listeners\n */ function $b63be9b0371e788c$var$setupConnectionEventListeners() {\n    // Power meter connection\n    if ((0, $26bf0f38c1315f82$export$7a5d735b2ab6389d).powerMeterConnectButton) (0, $26bf0f38c1315f82$export$7a5d735b2ab6389d).powerMeterConnectButton.addEventListener('click', async ()=>{\n        // Reset data from previous session\n        $b63be9b0371e788c$var$powerData.length = 0;\n        $b63be9b0371e788c$var$rawPowerMeasurements.length = 0;\n        $b63be9b0371e788c$var$lastPowerValue = 0;\n        (0, $d8d8e1ee9f4f63bb$export$153010588d52d05c)();\n        if ($b63be9b0371e788c$var$dataLoggerInterval) clearInterval($b63be9b0371e788c$var$dataLoggerInterval);\n        const connected = await (0, $305aaf8b9a43c26d$export$7cd63989f2e13954)($b63be9b0371e788c$var$powerMeterCallbacks, (0, $26bf0f38c1315f82$export$7a5d735b2ab6389d));\n        if (connected) {\n            // Start session if this is the first connection\n            if (!$b63be9b0371e788c$var$sessionStartTime) $b63be9b0371e788c$var$sessionStartTime = Date.now();\n            // Start data logging\n            $b63be9b0371e788c$var$dataLoggerInterval = setInterval(()=>{\n                $b63be9b0371e788c$var$powerData.push({\n                    timestamp: Date.now(),\n                    power: $b63be9b0371e788c$var$lastPowerValue,\n                    heartRate: $b63be9b0371e788c$var$lastHeartRateValue,\n                    cadence: $b63be9b0371e788c$var$lastCadenceValue\n                });\n                // Save session data every 10 seconds\n                if ($b63be9b0371e788c$var$powerData.length % 100 === 0) // Every 100 readings = 10 seconds\n                (0, $cc35ee5c64337d79$export$3b97cfd23e0d13d8)($b63be9b0371e788c$var$dataStore);\n            }, 100);\n        }\n    });\n    // Heart rate monitor connection\n    if ((0, $26bf0f38c1315f82$export$7a5d735b2ab6389d).hrConnectButton) (0, $26bf0f38c1315f82$export$7a5d735b2ab6389d).hrConnectButton.addEventListener('click', async ()=>{\n        await (0, $305aaf8b9a43c26d$export$830e9b592dbab083)($b63be9b0371e788c$var$heartRateCallbacks, (0, $26bf0f38c1315f82$export$7a5d735b2ab6389d));\n    });\n    // Speed/cadence sensor connection\n    if ((0, $26bf0f38c1315f82$export$7a5d735b2ab6389d).speedCadenceConnectButton) (0, $26bf0f38c1315f82$export$7a5d735b2ab6389d).speedCadenceConnectButton.addEventListener('click', async ()=>{\n        await (0, $305aaf8b9a43c26d$export$15696ad475844a91)($b63be9b0371e788c$var$cadenceCallbacks, (0, $26bf0f38c1315f82$export$7a5d735b2ab6389d));\n    });\n    // Spy mode connection\n    if ((0, $26bf0f38c1315f82$export$7a5d735b2ab6389d).spyCard) (0, $26bf0f38c1315f82$export$7a5d735b2ab6389d).spyCard.addEventListener('click', async ()=>{\n        if (!(0, $305aaf8b9a43c26d$export$298d6450d7b1b0fe)()) await (0, $305aaf8b9a43c26d$export$bee1a28fa3cc4e9a)({}, (0, $26bf0f38c1315f82$export$7a5d735b2ab6389d));\n        else (0, $305aaf8b9a43c26d$export$f8a9e6c57769fd82)((0, $26bf0f38c1315f82$export$7a5d735b2ab6389d));\n    });\n}\n/**\n * Session restoration functionality\n */ /**\n * Show restoration dialog to let user choose\n */ function $b63be9b0371e788c$var$showRestorationDialog(sessionData) {\n    return new Promise((resolve)=>{\n        // Create modal backdrop\n        const backdrop = document.createElement('div');\n        backdrop.className = 'modal-backdrop';\n        // Create modal dialog\n        const modal = document.createElement('div');\n        modal.className = 'modal';\n        // Get session info\n        const sessionAge = Math.round((Date.now() - sessionData.timestamp) / 60000); // minutes\n        const dataCount = (sessionData.powerData?.length || 0) + (sessionData.heartData?.length || 0) + (sessionData.cadenceData?.length || 0);\n        modal.innerHTML = `\n      <h3>Previous Session Found</h3>\n      <p>\n        A previous session was found from ${sessionAge} minutes ago with ${dataCount} data points.\n      </p>\n      <p>\n        Would you like to restore this session or start fresh?\n      </p>\n      <div class=\"modal-buttons\">\n        <button id=\"startFresh\" class=\"modal-button secondary\">Start Fresh</button>\n        <button id=\"restoreSession\" class=\"modal-button primary\">Restore Session</button>\n      </div>\n    `;\n        backdrop.appendChild(modal);\n        document.body.appendChild(backdrop);\n        // Handle button clicks\n        modal.querySelector('#startFresh').addEventListener('click', ()=>{\n            document.body.removeChild(backdrop);\n            (0, $cc35ee5c64337d79$export$37b6cafab9b29f47)();\n            resolve(false);\n        });\n        modal.querySelector('#restoreSession').addEventListener('click', ()=>{\n            document.body.removeChild(backdrop);\n            resolve(true);\n        });\n        // Handle backdrop click\n        backdrop.addEventListener('click', (e)=>{\n            if (e.target === backdrop) {\n                document.body.removeChild(backdrop);\n                resolve(false);\n            }\n        });\n    });\n}\n/**\n * Apply session data to restore the session\n */ function $b63be9b0371e788c$var$restoreSessionData(sessionData) {\n    try {\n        // Restore data arrays\n        if (sessionData.powerData) {\n            $b63be9b0371e788c$var$powerData.length = 0;\n            $b63be9b0371e788c$var$powerData.push(...sessionData.powerData);\n        }\n        if (sessionData.heartData) {\n            $b63be9b0371e788c$var$heartData.length = 0;\n            $b63be9b0371e788c$var$heartData.push(...sessionData.heartData);\n        }\n        if (sessionData.cadenceData) {\n            $b63be9b0371e788c$var$cadenceData.length = 0;\n            $b63be9b0371e788c$var$cadenceData.push(...sessionData.cadenceData);\n        }\n        if (sessionData.rawPowerMeasurements) {\n            $b63be9b0371e788c$var$rawPowerMeasurements.length = 0;\n            $b63be9b0371e788c$var$rawPowerMeasurements.push(...sessionData.rawPowerMeasurements);\n        }\n        if (sessionData.powerReadings) (0, $d8d8e1ee9f4f63bb$export$60ad2ad39402c700)(sessionData.powerReadings);\n        // Restore power averages completely\n        if (sessionData.powerAverages) (0, $d8d8e1ee9f4f63bb$export$2abb6eba483cf221)(sessionData.powerAverages);\n        // Restore last values\n        if (sessionData.lastPowerValue !== undefined) $b63be9b0371e788c$var$lastPowerValue = sessionData.lastPowerValue;\n        if (sessionData.lastHeartRateValue !== undefined) $b63be9b0371e788c$var$lastHeartRateValue = sessionData.lastHeartRateValue;\n        if (sessionData.lastCadenceValue !== undefined) $b63be9b0371e788c$var$lastCadenceValue = sessionData.lastCadenceValue;\n        if (sessionData.sessionStartTime !== undefined) $b63be9b0371e788c$var$sessionStartTime = sessionData.sessionStartTime;\n        // Update displays with restored data\n        $b63be9b0371e788c$var$updateDisplaysFromRestoredData();\n        return true;\n    } catch (error) {\n        console.warn('Failed to restore session data:', error);\n        return false;\n    }\n}\n/**\n * Initialize the application\n */ async function $b63be9b0371e788c$var$initializeApp() {\n    // Initialize all modules and DOM elements\n    (0, $26bf0f38c1315f82$export$a57455d21a15702b)();\n    (0, $d8d8e1ee9f4f63bb$export$38b6955d4a0211f4)();\n    (0, $d455cb11b3bc64fd$export$8edd2f9a38e90f85)((0, $26bf0f38c1315f82$export$7a5d735b2ab6389d));\n    // Setup all event listeners\n    (0, $d455cb11b3bc64fd$export$81e17204574dbb93)((0, $26bf0f38c1315f82$export$7a5d735b2ab6389d));\n    (0, $d455cb11b3bc64fd$export$a2f2b6b746488fd5)((0, $26bf0f38c1315f82$export$7a5d735b2ab6389d));\n    (0, $d455cb11b3bc64fd$export$7af716748e1b2a68)((0, $26bf0f38c1315f82$export$7a5d735b2ab6389d));\n    (0, $d455cb11b3bc64fd$export$847dba17d53ca76f)((0, $26bf0f38c1315f82$export$7a5d735b2ab6389d), ()=>(0, $305aaf8b9a43c26d$export$f8a9e6c57769fd82)((0, $26bf0f38c1315f82$export$7a5d735b2ab6389d)));\n    (0, $d455cb11b3bc64fd$export$66f401d4d3f34334)((0, $26bf0f38c1315f82$export$7a5d735b2ab6389d));\n    $b63be9b0371e788c$var$setupConnectionEventListeners();\n    (0, $1fea2fc27e5705f2$export$313373f1d10aa459)($b63be9b0371e788c$var$dataStore);\n    // Try to load previous session data\n    const sessionData = (0, $cc35ee5c64337d79$export$5ae208508f6870b)();\n    if (sessionData) {\n        // Show restoration dialog\n        const shouldRestore = await $b63be9b0371e788c$var$showRestorationDialog(sessionData);\n        if (shouldRestore) $b63be9b0371e788c$var$restoreSessionData(sessionData);\n        else $b63be9b0371e788c$var$sessionStartTime = Date.now();\n    } else $b63be9b0371e788c$var$sessionStartTime = Date.now();\n    // Save session data when page is about to be closed/refreshed\n    window.addEventListener('beforeunload', function() {\n        if ($b63be9b0371e788c$var$powerData.length > 0) (0, $cc35ee5c64337d79$export$3b97cfd23e0d13d8)($b63be9b0371e788c$var$dataStore);\n    });\n    // Save session data periodically (every 30 seconds as backup)\n    setInterval(()=>{\n        if ($b63be9b0371e788c$var$powerData.length > 0) (0, $cc35ee5c64337d79$export$3b97cfd23e0d13d8)($b63be9b0371e788c$var$dataStore);\n    }, 30000);\n}\n// Initialize the application when DOM is ready\ndocument.addEventListener('DOMContentLoaded', $b63be9b0371e788c$var$initializeApp);\n\n\n//# sourceMappingURL=power-saver.2f5402b7.js.map\n","/**\n * Power Saver Main Application\n * Coordinates all modules and manages the application state\n */\n\n// Import all required modules\nimport { loadSessionData, saveSessionData, clearSessionData } from \"./session-data.js\";\nimport {\n  initializePowerAveraging,\n  addPowerReading,\n  resetPowerAverages,\n  getPowerAverages,\n  setPowerAverages,\n  getPowerReadings,\n  setPowerReadings,\n  updateDisplay as updatePowerAveragesDisplay\n} from \"./power-averaging.js\";\nimport {\n  elements,\n  initializeElements,\n  updatePowerValue,\n  updateMetricDisplays,\n  resetMetricDisplays\n} from \"./ui-management.js\";\nimport {\n  connectPowerMeter,\n  connectHeartRateMonitor,\n  connectSpeedCadenceSensor,\n  connectSpyMeter,\n  disconnectSpyMeter,\n  isSpyMeterConnected\n} from \"./bluetooth-connections.js\";\nimport { setupExportMenuListeners } from \"./export-modals.js\";\nimport { showSessionRestoredNotification } from \"./notifications.js\";\nimport {\n  setupHamburgerMenu,\n  setupPowerAveragesToggle,\n  setupMetricToggles,\n  setupSpyModeToggle,\n  setupMenuItems,\n  initializeSections\n} from \"./ui-event-handlers.js\";\n\n// Application state variables\nlet powerData = [];\nlet rawPowerMeasurements = [];\nlet heartData = [];\nlet cadenceData = [];\nlet lastPowerValue = 0;\nlet lastHeartRateValue = 0;\nlet lastCadenceValue = 0;\nlet sessionStartTime = null;\nlet dataLoggerInterval = null;\n\n/**\n * Update displays after restoring session data\n */\nfunction updateDisplaysFromRestoredData() {\n  // Update current metric values\n  updateMetricDisplays({\n    power: lastPowerValue,\n    heartRate: lastHeartRateValue,\n    cadence: lastCadenceValue\n  });\n\n  // Update power averages display\n  updatePowerAveragesDisplay();\n\n  // Show session restoration notification\n  if (powerData.length > 0) {\n    showSessionRestoredNotification(powerData.length);\n  }\n}\n\n/**\n * Reset all session data\n */\nfunction resetAllSessionData() {\n  // Clear all data arrays\n  powerData.length = 0;\n  heartData.length = 0;\n  cadenceData.length = 0;\n  rawPowerMeasurements.length = 0;\n\n  // Reset power averages\n  resetPowerAverages();\n\n  // Reset last values\n  lastPowerValue = 0;\n  lastHeartRateValue = 0;\n  lastCadenceValue = 0;\n  sessionStartTime = null;\n\n  // Update displays\n  resetMetricDisplays();\n\n  // Clear localStorage\n  clearSessionData();\n}\n\n/**\n * Data store object to pass to modules that need access to application data\n */\nconst dataStore = {\n  get powerData() { return powerData; },\n  get rawPowerMeasurements() { return rawPowerMeasurements; },\n  get heartData() { return heartData; },\n  get cadenceData() { return cadenceData; },\n  get lastPowerValue() { return lastPowerValue; },\n  get lastHeartRateValue() { return lastHeartRateValue; },\n  get lastCadenceValue() { return lastCadenceValue; },\n  get sessionStartTime() { return sessionStartTime; },\n  getPowerAverages,\n  getPowerReadings,\n  resetAllSessionData,\n  elements\n};\n\n// Bluetooth connection callbacks\nconst powerMeterCallbacks = {\n  onPowerMeasurement: (power, rawMeasurement) => {\n    updatePowerValue(power);\n    lastPowerValue = power;\n\n    // Store raw measurement data\n    rawPowerMeasurements.push(rawMeasurement);\n\n    // Add power reading to averaging calculations\n    addPowerReading(power);\n  },\n  onDisconnected: () => {\n    resetMetricDisplays();\n    resetPowerAverages();\n    if (dataLoggerInterval) {\n      clearInterval(dataLoggerInterval);\n      dataLoggerInterval = null;\n    }\n    lastPowerValue = 0;\n  },\n  onStatusUpdate: (message) => {\n    if (elements.statusText) {\n      elements.statusText.textContent = message;\n    }\n  }\n};\n\nconst heartRateCallbacks = {\n  onHeartRateChange: (heartRate) => {\n    if (elements.hrValueElement) {\n      elements.hrValueElement.textContent = heartRate;\n    }\n    lastHeartRateValue = heartRate;\n  },\n  onStatusUpdate: (message) => {\n    if (elements.hrStatusText) {\n      elements.hrStatusText.textContent = message;\n    }\n  }\n};\n\nconst cadenceCallbacks = {\n  onCadenceChange: (cadence) => {\n    if (elements.cadenceValueElement) {\n      elements.cadenceValueElement.textContent = cadence;\n    }\n    lastCadenceValue = cadence;\n  },\n  onStatusUpdate: (message) => {\n    if (elements.cadenceStatusText) {\n      elements.cadenceStatusText.textContent = message;\n    }\n  }\n};\n\n/**\n * Setup connection button event listeners\n */\nfunction setupConnectionEventListeners() {\n  // Power meter connection\n  if (elements.powerMeterConnectButton) {\n    elements.powerMeterConnectButton.addEventListener('click', async () => {\n      // Reset data from previous session\n      powerData.length = 0;\n      rawPowerMeasurements.length = 0;\n      lastPowerValue = 0;\n      resetPowerAverages();\n\n      if (dataLoggerInterval) {\n        clearInterval(dataLoggerInterval);\n      }\n\n      const connected = await connectPowerMeter(powerMeterCallbacks, elements);\n\n      if (connected) {\n        // Start session if this is the first connection\n        if (!sessionStartTime) {\n          sessionStartTime = Date.now();\n        }\n\n        // Start data logging\n        dataLoggerInterval = setInterval(() => {\n          powerData.push({\n            timestamp: Date.now(),\n            power: lastPowerValue,\n            heartRate: lastHeartRateValue,\n            cadence: lastCadenceValue,\n          });\n\n          // Save session data every 10 seconds\n          if (powerData.length % 100 === 0) {\n            // Every 100 readings = 10 seconds\n            saveSessionData(dataStore);\n          }\n        }, 100);\n      }\n    });\n  }\n\n  // Heart rate monitor connection\n  if (elements.hrConnectButton) {\n    elements.hrConnectButton.addEventListener('click', async () => {\n      await connectHeartRateMonitor(heartRateCallbacks, elements);\n    });\n  }\n\n  // Speed/cadence sensor connection\n  if (elements.speedCadenceConnectButton) {\n    elements.speedCadenceConnectButton.addEventListener('click', async () => {\n      await connectSpeedCadenceSensor(cadenceCallbacks, elements);\n    });\n  }\n\n  // Spy mode connection\n  if (elements.spyCard) {\n    elements.spyCard.addEventListener('click', async () => {\n      if (!isSpyMeterConnected()) {\n        await connectSpyMeter({}, elements);\n      } else {\n        disconnectSpyMeter(elements);\n      }\n    });\n  }\n}\n\n/**\n * Session restoration functionality\n */\n\n/**\n * Show restoration dialog to let user choose\n */\nfunction showRestorationDialog(sessionData) {\n  return new Promise((resolve) => {\n    // Create modal backdrop\n    const backdrop = document.createElement('div');\n    backdrop.className = 'modal-backdrop';\n\n    // Create modal dialog\n    const modal = document.createElement('div');\n    modal.className = 'modal';\n\n    // Get session info\n    const sessionAge = Math.round((Date.now() - sessionData.timestamp) / (1000 * 60)); // minutes\n    const dataCount =\n      (sessionData.powerData?.length || 0) +\n      (sessionData.heartData?.length || 0) +\n      (sessionData.cadenceData?.length || 0);\n\n    modal.innerHTML = `\n      <h3>Previous Session Found</h3>\n      <p>\n        A previous session was found from ${sessionAge} minutes ago with ${dataCount} data points.\n      </p>\n      <p>\n        Would you like to restore this session or start fresh?\n      </p>\n      <div class=\"modal-buttons\">\n        <button id=\"startFresh\" class=\"modal-button secondary\">Start Fresh</button>\n        <button id=\"restoreSession\" class=\"modal-button primary\">Restore Session</button>\n      </div>\n    `;\n\n    backdrop.appendChild(modal);\n    document.body.appendChild(backdrop);\n\n    // Handle button clicks\n    modal.querySelector('#startFresh').addEventListener('click', () => {\n      document.body.removeChild(backdrop);\n      clearSessionData();\n      resolve(false);\n    });\n\n    modal.querySelector('#restoreSession').addEventListener('click', () => {\n      document.body.removeChild(backdrop);\n      resolve(true);\n    });\n\n    // Handle backdrop click\n    backdrop.addEventListener('click', (e) => {\n      if (e.target === backdrop) {\n        document.body.removeChild(backdrop);\n        resolve(false);\n      }\n    });\n  });\n}\n\n/**\n * Apply session data to restore the session\n */\nfunction restoreSessionData(sessionData) {\n  try {\n    // Restore data arrays\n    if (sessionData.powerData) {\n      powerData.length = 0;\n      powerData.push(...sessionData.powerData);\n    }\n    if (sessionData.heartData) {\n      heartData.length = 0;\n      heartData.push(...sessionData.heartData);\n    }\n    if (sessionData.cadenceData) {\n      cadenceData.length = 0;\n      cadenceData.push(...sessionData.cadenceData);\n    }\n    if (sessionData.rawPowerMeasurements) {\n      rawPowerMeasurements.length = 0;\n      rawPowerMeasurements.push(...sessionData.rawPowerMeasurements);\n    }\n    if (sessionData.powerReadings) {\n      setPowerReadings(sessionData.powerReadings);\n    }\n\n    // Restore power averages completely\n    if (sessionData.powerAverages) {\n      setPowerAverages(sessionData.powerAverages);\n    }\n\n    // Restore last values\n    if (sessionData.lastPowerValue !== undefined) lastPowerValue = sessionData.lastPowerValue;\n    if (sessionData.lastHeartRateValue !== undefined) lastHeartRateValue = sessionData.lastHeartRateValue;\n    if (sessionData.lastCadenceValue !== undefined) lastCadenceValue = sessionData.lastCadenceValue;\n    if (sessionData.sessionStartTime !== undefined) sessionStartTime = sessionData.sessionStartTime;\n\n    // Update displays with restored data\n    updateDisplaysFromRestoredData();\n\n    return true;\n  } catch (error) {\n    console.warn('Failed to restore session data:', error);\n    return false;\n  }\n}\n\n/**\n * Initialize the application\n */\nasync function initializeApp() {\n  // Initialize all modules and DOM elements\n  initializeElements();\n  initializePowerAveraging();\n  initializeSections(elements);\n\n  // Setup all event listeners\n  setupHamburgerMenu(elements);\n  setupPowerAveragesToggle(elements);\n  setupMetricToggles(elements);\n  setupSpyModeToggle(elements, () => disconnectSpyMeter(elements));\n  setupMenuItems(elements);\n  setupConnectionEventListeners();\n  setupExportMenuListeners(dataStore);\n\n  // Try to load previous session data\n  const sessionData = loadSessionData();\n  if (sessionData) {\n    // Show restoration dialog\n    const shouldRestore = await showRestorationDialog(sessionData);\n    if (shouldRestore) {\n      restoreSessionData(sessionData);\n    } else {\n      sessionStartTime = Date.now();\n    }\n  } else {\n    sessionStartTime = Date.now();\n  }\n\n  // Save session data when page is about to be closed/refreshed\n  window.addEventListener('beforeunload', function () {\n    if (powerData.length > 0) {\n      saveSessionData(dataStore);\n    }\n  });\n\n  // Save session data periodically (every 30 seconds as backup)\n  setInterval(() => {\n    if (powerData.length > 0) {\n      saveSessionData(dataStore);\n    }\n  }, 30000);\n}\n\n// Initialize the application when DOM is ready\ndocument.addEventListener('DOMContentLoaded', initializeApp);","// Data Persistence Functions\nconst SESSION_STORAGE_KEY = 'powerMeterSession';\nconst SESSION_TIMEOUT = 24 * 60 * 60 * 1000; // 24 hours in milliseconds\n\n/**\n * Save current session data to localStorage\n * @param {Object} dataStore - Object containing all session data\n */\nfunction saveSessionData(dataStore) {\n    try {\n        const sessionData = {\n            timestamp: Date.now(),\n            powerData: dataStore.powerData,\n            heartData: dataStore.heartData,\n            cadenceData: dataStore.cadenceData,\n            rawPowerMeasurements: dataStore.rawPowerMeasurements,\n            powerReadings: dataStore.getPowerReadings(),\n            powerAverages: dataStore.getPowerAverages(),\n            lastPowerValue: dataStore.lastPowerValue,\n            lastHeartRateValue: dataStore.lastHeartRateValue,\n            lastCadenceValue: dataStore.lastCadenceValue,\n            sessionStartTime: dataStore.sessionStartTime,\n        };\n\n        localStorage.setItem(SESSION_STORAGE_KEY, JSON.stringify(sessionData));\n    } catch (error) {\n        console.warn('Failed to save session data:', error);\n    }\n}\n\n/**\n * Load session data from localStorage if available and recent\n * Returns the session data object if available, null if not\n */\nfunction loadSessionData() {\n    try {\n        const savedData = localStorage.getItem(SESSION_STORAGE_KEY);\n        if (!savedData) return null;\n\n        const sessionData = JSON.parse(savedData);\n        const now = Date.now();\n\n        // Check if session is too old (older than 24 hours)\n        if (now - sessionData.timestamp > SESSION_TIMEOUT) {\n            localStorage.removeItem(SESSION_STORAGE_KEY);\n            return null;\n        }\n\n        return sessionData;\n    } catch (error) {\n        console.warn('Failed to load session data:', error);\n        localStorage.removeItem(SESSION_STORAGE_KEY);\n        return null;\n    }\n}\n\n\n/**\n * Clear session data from localStorage\n */\nfunction clearSessionData() {\n    localStorage.removeItem(SESSION_STORAGE_KEY);\n}\n\nexport { loadSessionData, saveSessionData, clearSessionData };","/**\n * Power Averaging Module\n * Handles power data collection, averaging calculations, and display updates\n */\n\n// Power averaging data structures\nlet powerReadings = []; // Array to store timestamped power readings\nlet powerAverages = {\n    '10s': { current: 0, best: 0 },\n    '20s': { current: 0, best: 0 },\n    '30s': { current: 0, best: 0 },\n    '40s': { current: 0, best: 0 },\n    '50s': { current: 0, best: 0 },\n    '1m': { current: 0, best: 0 },\n    '2m': { current: 0, best: 0 },\n    '3m': { current: 0, best: 0 },\n    '4m': { current: 0, best: 0 },\n    '5m': { current: 0, best: 0 },\n};\n\n// DOM elements for power averages display\nlet avg10sCurrentElement, avg10sBestElement;\nlet avg20sCurrentElement, avg20sBestElement;\nlet avg30sCurrentElement, avg30sBestElement;\nlet avg40sCurrentElement, avg40sBestElement;\nlet avg50sCurrentElement, avg50sBestElement;\nlet avg1mCurrentElement, avg1mBestElement;\nlet avg2mCurrentElement, avg2mBestElement;\nlet avg3mCurrentElement, avg3mBestElement;\nlet avg4mCurrentElement, avg4mBestElement;\nlet avg5mCurrentElement, avg5mBestElement;\n\n/**\n * Initialize power averaging system with DOM elements\n */\nexport function initializePowerAveraging() {\n    // Get DOM elements\n    avg10sCurrentElement = document.getElementById('avg10s-current');\n    avg10sBestElement = document.getElementById('avg10s-best');\n    avg20sCurrentElement = document.getElementById('avg20s-current');\n    avg20sBestElement = document.getElementById('avg20s-best');\n    avg30sCurrentElement = document.getElementById('avg30s-current');\n    avg30sBestElement = document.getElementById('avg30s-best');\n    avg40sCurrentElement = document.getElementById('avg40s-current');\n    avg40sBestElement = document.getElementById('avg40s-best');\n    avg50sCurrentElement = document.getElementById('avg50s-current');\n    avg50sBestElement = document.getElementById('avg50s-best');\n    avg1mCurrentElement = document.getElementById('avg1m-current');\n    avg1mBestElement = document.getElementById('avg1m-best');\n    avg2mCurrentElement = document.getElementById('avg2m-current');\n    avg2mBestElement = document.getElementById('avg2m-best');\n    avg3mCurrentElement = document.getElementById('avg3m-current');\n    avg3mBestElement = document.getElementById('avg3m-best');\n    avg4mCurrentElement = document.getElementById('avg4m-current');\n    avg4mBestElement = document.getElementById('avg4m-best');\n    avg5mCurrentElement = document.getElementById('avg5m-current');\n    avg5mBestElement = document.getElementById('avg5m-best');\n}\n\n/**\n * Add a new power reading to the averaging calculations\n * @param {number} power - The instantaneous power value\n */\nexport function addPowerReading(power) {\n    const now = Date.now();\n    powerReadings.push({ timestamp: now, power: power });\n\n    // Keep only the last 5 minutes of readings (plus some buffer)\n    const fiveMinutesAgo = now - 6 * 60 * 1000; // 6 minutes to be safe\n    powerReadings = powerReadings.filter((reading) => reading.timestamp > fiveMinutesAgo);\n\n    // Calculate current averages\n    calculatePowerAverages();\n    updatePowerAveragesDisplay();\n}\n\n/**\n * Calculate power averages for all time periods\n */\nfunction calculatePowerAverages() {\n    const now = Date.now();\n    const periods = {\n        '10s': 10 * 1000,\n        '20s': 20 * 1000,\n        '30s': 30 * 1000,\n        '40s': 40 * 1000,\n        '50s': 50 * 1000,\n        '1m': 60 * 1000,\n        '2m': 120 * 1000,\n        '3m': 180 * 1000,\n        '4m': 240 * 1000,\n        '5m': 300 * 1000,\n    };\n\n    for (const [periodKey, periodMs] of Object.entries(periods)) {\n        const cutoffTime = now - periodMs;\n        const relevantReadings = powerReadings.filter((reading) => reading.timestamp >= cutoffTime);\n\n        if (relevantReadings.length > 0) {\n            const sum = relevantReadings.reduce((total, reading) => total + reading.power, 0);\n            const average = Math.round(sum / relevantReadings.length);\n            powerAverages[periodKey].current = average;\n\n            // Update best if current is better\n            if (average > powerAverages[periodKey].best) {\n                powerAverages[periodKey].best = average;\n            }\n        } else {\n            powerAverages[periodKey].current = 0;\n        }\n    }\n}\n\n/**\n * Update the power averages display in the UI\n */\nfunction updatePowerAveragesDisplay() {\n    if (!avg10sCurrentElement) return; // Elements not initialized\n\n    avg10sCurrentElement.textContent = powerAverages['10s'].current || '--';\n    avg10sBestElement.textContent = powerAverages['10s'].best || '--';\n    avg20sCurrentElement.textContent = powerAverages['20s'].current || '--';\n    avg20sBestElement.textContent = powerAverages['20s'].best || '--';\n    avg30sCurrentElement.textContent = powerAverages['30s'].current || '--';\n    avg30sBestElement.textContent = powerAverages['30s'].best || '--';\n    avg40sCurrentElement.textContent = powerAverages['40s'].current || '--';\n    avg40sBestElement.textContent = powerAverages['40s'].best || '--';\n    avg50sCurrentElement.textContent = powerAverages['50s'].current || '--';\n    avg50sBestElement.textContent = powerAverages['50s'].best || '--';\n    avg1mCurrentElement.textContent = powerAverages['1m'].current || '--';\n    avg1mBestElement.textContent = powerAverages['1m'].best || '--';\n    avg2mCurrentElement.textContent = powerAverages['2m'].current || '--';\n    avg2mBestElement.textContent = powerAverages['2m'].best || '--';\n    avg3mCurrentElement.textContent = powerAverages['3m'].current || '--';\n    avg3mBestElement.textContent = powerAverages['3m'].best || '--';\n    avg4mCurrentElement.textContent = powerAverages['4m'].current || '--';\n    avg4mBestElement.textContent = powerAverages['4m'].best || '--';\n    avg5mCurrentElement.textContent = powerAverages['5m'].current || '--';\n    avg5mBestElement.textContent = powerAverages['5m'].best || '--';\n}\n\n/**\n * Reset all power averages to zero\n */\nexport function resetPowerAverages() {\n    powerReadings = [];\n    for (const period of Object.keys(powerAverages)) {\n        powerAverages[period].current = 0;\n        powerAverages[period].best = 0;\n    }\n    updatePowerAveragesDisplay();\n}\n\n/**\n * Get current power averages data\n * @returns {Object} Current power averages object\n */\nexport function getPowerAverages() {\n    return { ...powerAverages };\n}\n\n/**\n * Set power averages data (used for session restoration)\n * @param {Object} averages - Power averages object to restore\n */\nexport function setPowerAverages(averages) {\n    Object.assign(powerAverages, averages);\n    updatePowerAveragesDisplay();\n}\n\n/**\n * Get power readings data\n * @returns {Array} Current power readings array\n */\nexport function getPowerReadings() {\n    return [...powerReadings];\n}\n\n/**\n * Set power readings data (used for session restoration)\n * @param {Array} readings - Power readings array to restore\n */\nexport function setPowerReadings(readings) {\n    powerReadings = [...readings];\n}\n\n/**\n * Force update of power averages display\n */\nexport function updateDisplay() {\n    updatePowerAveragesDisplay();\n}","/**\n * UI Management Module\n * Handles DOM element references, event listeners, and UI state management\n */\n\n// DOM element references\nexport const elements = {\n    // Main metric displays\n    powerValueElement: null,\n    hrValueElement: null,\n    cadenceValueElement: null,\n\n    // Device info displays\n    deviceNameElement: null,\n    hrDeviceName: null,\n    cadenceDeviceName: null,\n\n    // Status displays\n    statusText: null,\n    hrStatusText: null,\n    cadenceStatusText: null,\n    hrConnectionStatus: null,\n    cadenceConnectionStatus: null,\n\n    // Buttons\n    powerMeterConnectButton: null,\n    hrConnectButton: null,\n    speedCadenceConnectButton: null,\n    exportButtons: {\n        json: null,\n        csv: null,\n        tcx: null,\n        rawJson: null,\n        rawCsv: null,\n        image: null,\n        clearSession: null,\n        googleDocs: null,\n        googleSheets: null,\n        googleAuth: null,\n        configureGoogleApi: null,\n        intervals: null,\n        configureIntervals: null\n    },\n\n    // Toggle elements\n    powerAveragesSection: null,\n\n    // Hamburger menu elements\n    hamburgerBtn: null,\n    menuDropdown: null,\n    powerAveragesToggle: null,\n    powerMetricToggle: null,\n    heartRateMetricToggle: null,\n    cadenceMetricToggle: null,\n    showInfoMenuItem: null,\n    showQrCodeMenuItem: null,\n    spyModeToggle: null,\n\n    // Metric card elements\n    powerCard: null,\n    heartRateCard: null,\n    cadenceCard: null,\n    spyCard: null,\n    spyModeSection: null,\n\n    // Spy mode elements\n    spyValueElement: null,\n    spyStatusElement: null,\n    spyInstructionsElement: null\n};\n\n/**\n * Initialize all DOM element references\n */\nexport function initializeElements() {\n    // Main metric displays\n    elements.powerValueElement = document.getElementById('power-value');\n    elements.hrValueElement = document.getElementById('hr-value');\n    elements.cadenceValueElement = document.getElementById('cadence-value');\n\n    // Device info displays\n    elements.deviceNameElement = document.getElementById('device-name');\n    elements.hrDeviceName = document.getElementById('hrDeviceName');\n    elements.cadenceDeviceName = document.getElementById('cadenceDeviceName');\n\n    // Status displays\n    elements.statusText = document.getElementById('status');\n    elements.hrStatusText = document.getElementById('hrStatus');\n    elements.cadenceStatusText = document.getElementById('cadenceStatus');\n    elements.hrConnectionStatus = document.getElementById('hrConnectionStatus');\n    elements.cadenceConnectionStatus = document.getElementById('cadenceConnectionStatus');\n\n    // Buttons\n    elements.powerMeterConnectButton = document.getElementById('connectButton');\n    elements.hrConnectButton = document.getElementById('hrConnectButton');\n    elements.speedCadenceConnectButton = document.getElementById('speedCadenceConnectButton');\n\n    // Toggle elements\n    elements.powerAveragesSection = document.getElementById('powerAveragesSection');\n\n    // Hamburger menu elements\n    elements.hamburgerBtn = document.getElementById('hamburgerButton');\n    elements.menuDropdown = document.getElementById('menuDropdown');\n    elements.powerAveragesToggle = document.getElementById('powerAveragesToggle');\n    elements.powerMetricToggle = document.getElementById('powerMetricToggle');\n    elements.heartRateMetricToggle = document.getElementById('heartRateMetricToggle');\n    elements.cadenceMetricToggle = document.getElementById('cadenceMetricToggle');\n    elements.showInfoMenuItem = document.getElementById('showInfoMenuItem');\n    elements.showQrCodeMenuItem = document.getElementById('showQrCodeMenuItem');\n    elements.spyModeToggle = document.getElementById('spyModeToggle');\n\n    // Metric card elements\n    elements.powerCard = document.querySelector('.power-card');\n    elements.heartRateCard = document.querySelector('.hr-card');\n    elements.cadenceCard = document.querySelector('.cadence-card');\n    elements.spyCard = document.querySelector('.spy-card');\n    elements.spyModeSection = document.getElementById('spyModeSection');\n\n    // Spy mode elements\n    elements.spyValueElement = document.getElementById('spy-value');\n    elements.spyStatusElement = document.getElementById('spyStatus');\n    elements.spyInstructionsElement = document.getElementById('spyInstructions');\n\n    // Initialize connection status to disconnected state\n    if (elements.hrConnectionStatus) elements.hrConnectionStatus.textContent = 'Disconnected';\n    if (elements.cadenceConnectionStatus) elements.cadenceConnectionStatus.textContent = 'Disconnected';\n}\n\n/**\n * Helper function to update power value with enhanced styling\n * @param {number|string} value - The power value to display\n */\nexport function updatePowerValue(value) {\n    if (!elements.powerValueElement) return;\n\n    const displayValue = value || '--';\n    elements.powerValueElement.textContent = displayValue;\n    elements.powerValueElement.setAttribute('data-value', displayValue);\n}\n\n/**\n * Update metric displays with current values\n * @param {Object} values - Object containing power, heartRate, and cadence values\n */\nexport function updateMetricDisplays(values) {\n    if (values.power !== undefined) {\n        updatePowerValue(values.power);\n    }\n\n    if (values.heartRate !== undefined && elements.hrValueElement) {\n        elements.hrValueElement.textContent = values.heartRate || '--';\n    }\n\n    if (values.cadence !== undefined && elements.cadenceValueElement) {\n        elements.cadenceValueElement.textContent = values.cadence || '--';\n    }\n}\n\n/**\n * Reset all metric displays to default values\n */\nexport function resetMetricDisplays() {\n    updatePowerValue('--');\n    if (elements.hrValueElement) elements.hrValueElement.textContent = '--';\n    if (elements.cadenceValueElement) elements.cadenceValueElement.textContent = '--';\n}\n\n/**\n * Get current date string for file naming\n * @returns {string} Date string in YYYY-MM-DD format\n */\nexport function getCurrentDateString() {\n    const now = new Date();\n    const year = now.getFullYear();\n    const month = String(now.getMonth() + 1).padStart(2, '0');\n    const day = String(now.getDate()).padStart(2, '0');\n    return `${year}-${month}-${day}`;\n}","/**\n * Bluetooth Power Meter Connection Module\n * Handles Bluetooth connections for power meters, heart rate monitors, and cadence sensors\n */\n\nimport { parseHeartRate } from './heart-rate.js';\nimport { requestWakeLock } from './wake-lock.js';\n\n// Bluetooth service UUIDs\nconst CYCLING_POWER_SERVICE_UUID = 'cycling_power';\nconst CYCLING_POWER_MEASUREMENT_CHARACTERISTIC_UUID = 'cycling_power_measurement';\nconst CYCLING_POWER_FEATURE_CHARACTERISTIC_UUID = 'cycling_power_feature';\nconst CYCLING_CADENCE_SERVICE_UUID = 'cycling_speed_and_cadence';\nconst CSC_MEASUREMENT_CHARACTERISTIC_UUID = 'csc_measurement';\n\n// Device connection state\nlet powerMeterDevice = null;\nlet hrBluetoothDevice = null;\nlet speedCadenceBluetoothDevice = null;\nlet spyMeterDevice = null;\n\n// Store event listener references for proper cleanup\nlet powerMeterDisconnectHandler = null;\nlet hrDisconnectHandler = null;\nlet speedCadenceDisconnectHandler = null;\nlet spyMeterDisconnectHandler = null;\n\n// Cadence calculation variables\nlet lastCrankRevs = 0;\nlet lastCrankTime = 0;\nlet cadenceResetTimer = null;\n\n/**\n * Connect to a power meter device\n * @param {Object} callbacks - Object containing callback functions\n * @param {Function} callbacks.onPowerMeasurement - Callback for power measurements\n * @param {Function} callbacks.onDisconnected - Callback for disconnection\n * @param {Function} callbacks.onStatusUpdate - Callback for status updates\n * @param {Object} elements - UI elements object\n */\nexport async function connectPowerMeter(callbacks, elements) {\n    await requestWakeLock();\n\n    if (!navigator.bluetooth) {\n        callbacks.onStatusUpdate('Web Bluetooth API is not available.');\n        return;\n    }\n\n    try {\n        callbacks.onStatusUpdate('Scanning for power meters...');\n\n        // Scan specifically for devices advertising the Cycling Power service\n        powerMeterDevice = await navigator.bluetooth.requestDevice({\n            filters: [\n                {\n                    services: [CYCLING_POWER_SERVICE_UUID],\n                },\n            ],\n        });\n\n        callbacks.onStatusUpdate('Connecting to device...');\n        if (elements.deviceNameElement) {\n            elements.deviceNameElement.textContent = `Device: ${powerMeterDevice.name || 'Unknown Device'}`;\n        }\n\n        powerMeterDevice.addEventListener('gattserverdisconnected', () => {\n            onPowerMeterDisconnected(callbacks, elements);\n        });\n\n        const server = await powerMeterDevice.gatt.connect();\n        const service = await server.getPrimaryService(CYCLING_POWER_SERVICE_UUID);\n        const characteristic = await service.getCharacteristic(\n            CYCLING_POWER_MEASUREMENT_CHARACTERISTIC_UUID\n        );\n\n        // Check for and subscribe to advanced power features if available\n        try {\n            const featureCharacteristic = await service.getCharacteristic(\n                CYCLING_POWER_FEATURE_CHARACTERISTIC_UUID\n            );\n            // eslint-disable-next-line no-unused-vars\n            const features = await featureCharacteristic.readValue();\n            // This value can be used to determine what the power meter supports,\n            // but for now we just parse what's in the measurement characteristic.\n        } catch {\n            // Cycling Power Feature characteristic not found\n        }\n\n        // Subscribe to power measurement notifications\n        await characteristic.startNotifications();\n        characteristic.addEventListener('characteristicvaluechanged', (event) => {\n            handlePowerMeasurement(event, callbacks);\n        });\n\n        callbacks.onStatusUpdate('Connected and receiving data!');\n        if (elements.powerMeterConnectButton) {\n            elements.powerMeterConnectButton.disabled = true;\n        }\n\n        return true;\n    } catch (error) {\n        callbacks.onStatusUpdate(`Error: ${error.message}`);\n        console.error('Connection failed:', error);\n        if (powerMeterDevice) {\n            powerMeterDevice.removeEventListener('gattserverdisconnected', () => {\n                onPowerMeterDisconnected(callbacks, elements);\n            });\n        }\n        return false;\n    }\n}\n\n/**\n * Connect to a heart rate monitor\n * @param {Object} callbacks - Object containing callback functions\n * @param {Object} elements - UI elements object\n */\nexport async function connectHeartRateMonitor(callbacks, elements) {\n    await requestWakeLock();\n\n    if (!navigator.bluetooth) {\n        callbacks.onStatusUpdate('Web Bluetooth API is not available.');\n        return;\n    }\n\n    try {\n        callbacks.onStatusUpdate('Scanning for devices...');\n        if (elements.hrConnectionStatus) {\n            elements.hrConnectionStatus.textContent = 'Connecting...';\n        }\n\n        // Filter for devices that advertise the 'heart_rate' service\n        hrBluetoothDevice = await navigator.bluetooth.requestDevice({\n            filters: [\n                {\n                    services: ['heart_rate'],\n                },\n            ],\n        });\n\n        callbacks.onStatusUpdate('Connecting to device...');\n        if (elements.hrDeviceName) {\n            elements.hrDeviceName.textContent = `Device: ${hrBluetoothDevice.name}`;\n        }\n\n        // Add a listener for when the device gets disconnected\n        hrBluetoothDevice.addEventListener('gattserverdisconnected', () => {\n            onHeartRateDisconnected(callbacks, elements);\n        });\n\n        const hrServer = await hrBluetoothDevice.gatt.connect();\n        const hrService = await hrServer.getPrimaryService('heart_rate');\n        const hrCharacteristic = await hrService.getCharacteristic('heart_rate_measurement');\n\n        // Start notifications to receive heart rate data\n        await hrCharacteristic.startNotifications();\n        hrCharacteristic.addEventListener('characteristicvaluechanged', (event) => {\n            handleHeartRateChanged(event, callbacks);\n        });\n\n        callbacks.onStatusUpdate('Connected!');\n        if (elements.hrConnectionStatus) {\n            elements.hrConnectionStatus.textContent = 'Connected';\n        }\n        if (elements.hrConnectButton) {\n            elements.hrConnectButton.disabled = true;\n        }\n\n        return true;\n    } catch (error) {\n        callbacks.onStatusUpdate(`Error: ${error.message}`);\n        if (elements.hrConnectionStatus) {\n            elements.hrConnectionStatus.textContent = 'Connection Failed';\n        }\n        console.error('Connection failed:', error);\n        return false;\n    }\n}\n\n/**\n * Connect to a speed/cadence sensor\n * @param {Object} callbacks - Object containing callback functions\n * @param {Object} elements - UI elements object\n */\nexport async function connectSpeedCadenceSensor(callbacks, elements) {\n    await requestWakeLock();\n\n    if (!navigator.bluetooth) {\n        callbacks.onStatusUpdate('Web Bluetooth API is not available.');\n        return;\n    }\n\n    try {\n        callbacks.onStatusUpdate('Scanning for sensors...');\n        if (elements.cadenceConnectionStatus) {\n            elements.cadenceConnectionStatus.textContent = 'Connecting...';\n        }\n\n        // Reset cadence variables for clean start\n        if (cadenceResetTimer) {\n            clearTimeout(cadenceResetTimer);\n            cadenceResetTimer = null;\n        }\n        lastCrankRevs = 0;\n        lastCrankTime = 0;\n\n        speedCadenceBluetoothDevice = await navigator.bluetooth.requestDevice({\n            filters: [\n                {\n                    services: [CYCLING_CADENCE_SERVICE_UUID],\n                },\n            ],\n        });\n\n        callbacks.onStatusUpdate('Connecting to device...');\n        if (elements.cadenceDeviceName) {\n            elements.cadenceDeviceName.textContent = `Device: ${speedCadenceBluetoothDevice.name}`;\n        }\n\n        speedCadenceBluetoothDevice.addEventListener('gattserverdisconnected', () => {\n            onCadenceDisconnected(callbacks, elements);\n        });\n\n        const server = await speedCadenceBluetoothDevice.gatt.connect();\n        const service = await server.getPrimaryService(CYCLING_CADENCE_SERVICE_UUID);\n        const characteristic = await service.getCharacteristic(CSC_MEASUREMENT_CHARACTERISTIC_UUID);\n\n        await characteristic.startNotifications();\n        characteristic.addEventListener('characteristicvaluechanged', (event) => {\n            handleSpeedCadenceMeasurement(event, callbacks);\n        });\n\n        callbacks.onStatusUpdate('Connected!');\n        if (elements.cadenceConnectionStatus) {\n            elements.cadenceConnectionStatus.textContent = 'Connected';\n        }\n        if (elements.speedCadenceConnectButton) {\n            elements.speedCadenceConnectButton.disabled = true;\n        }\n\n        return true;\n    } catch (error) {\n        callbacks.onStatusUpdate(`Error: ${error.message}`);\n        if (elements.cadenceConnectionStatus) {\n            elements.cadenceConnectionStatus.textContent = 'Connection Failed';\n        }\n        console.error('Speed/Cadence connection failed:', error);\n        return false;\n    }\n}\n\n/**\n * Connect to a spy power meter\n * @param {Object} callbacks - Object containing callback functions\n * @param {Object} elements - UI elements object\n */\nexport async function connectSpyMeter(callbacks, elements) {\n    if (!navigator.bluetooth) {\n        console.error('Web Bluetooth API is not available.');\n        return;\n    }\n\n    try {\n        if (elements.spyInstructionsElement) {\n            elements.spyInstructionsElement.style.display = 'none';\n        }\n        if (elements.spyStatusElement) {\n            elements.spyStatusElement.textContent = 'Scanning for spy power meter...';\n            elements.spyStatusElement.style.display = 'block';\n        }\n\n        // Scan for devices advertising the Cycling Power service\n        spyMeterDevice = await navigator.bluetooth.requestDevice({\n            filters: [\n                {\n                    services: [CYCLING_POWER_SERVICE_UUID],\n                },\n            ],\n        });\n\n        if (elements.spyStatusElement) {\n            elements.spyStatusElement.textContent = 'Connecting to spy device...';\n        }\n\n        spyMeterDevice.addEventListener('gattserverdisconnected', () => {\n            onSpyDisconnected(elements);\n        });\n\n        const server = await spyMeterDevice.gatt.connect();\n        const service = await server.getPrimaryService(CYCLING_POWER_SERVICE_UUID);\n        const characteristic = await service.getCharacteristic(\n            CYCLING_POWER_MEASUREMENT_CHARACTERISTIC_UUID\n        );\n\n        // Subscribe to power measurement notifications\n        await characteristic.startNotifications();\n        characteristic.addEventListener('characteristicvaluechanged', (event) => {\n            handleSpyPowerMeasurement(event, elements);\n        });\n\n        if (elements.spyStatusElement) {\n            elements.spyStatusElement.textContent = 'Spy connected!';\n            elements.spyStatusElement.style.display = 'none';\n        }\n\n        return true;\n    } catch (error) {\n        if (elements.spyStatusElement) {\n            elements.spyStatusElement.textContent = `Spy Error: ${error.message}`;\n        }\n        console.error('Spy connection failed:', error);\n        if (spyMeterDevice) {\n            spyMeterDevice.removeEventListener('gattserverdisconnected', () => {\n                onSpyDisconnected(elements);\n            });\n            spyMeterDevice = null;\n        }\n        // Show instructions again if connection failed\n        setTimeout(() => {\n            if (elements.spyStatusElement) {\n                elements.spyStatusElement.style.display = 'none';\n            }\n            if (elements.spyInstructionsElement) {\n                elements.spyInstructionsElement.style.display = 'block';\n            }\n        }, 3000);\n        return false;\n    }\n}\n\n/**\n * Disconnect spy meter\n * @param {Object} elements - UI elements object\n */\nexport function disconnectSpyMeter(elements) {\n    if (spyMeterDevice && spyMeterDevice.gatt.connected) {\n        spyMeterDevice.gatt.disconnect();\n    }\n    spyMeterDevice = null;\n    if (elements.spyValueElement) {\n        elements.spyValueElement.textContent = '--';\n    }\n    if (elements.spyStatusElement) {\n        elements.spyStatusElement.style.display = 'none';\n    }\n    if (elements.spyInstructionsElement) {\n        elements.spyInstructionsElement.style.display = 'block';\n    }\n}\n\n/**\n * Check if power meter is connected\n * @returns {boolean}\n */\nexport function isPowerMeterConnected() {\n    return powerMeterDevice && powerMeterDevice.gatt.connected;\n}\n\n/**\n * Check if spy meter is connected\n * @returns {boolean}\n */\nexport function isSpyMeterConnected() {\n    return spyMeterDevice && spyMeterDevice.gatt.connected;\n}\n\n// Event handlers\nfunction handlePowerMeasurement(event, callbacks) {\n    const value = event.target.value;\n    const timestamp = Date.now();\n\n    // Store simplified raw measurement data\n    const rawMeasurement = {\n        timestamp: timestamp,\n        flags: value.getUint16(0, true),\n        rawBytes: Array.from(new Uint8Array(value.buffer))\n            .map((b) => b.toString(16).padStart(2, '0'))\n            .join(' '),\n        dataLength: value.byteLength,\n    };\n\n    // The data is a DataView object with a flags field and the power value.\n    // Ref: https://www.bluetooth.com/specifications/gatt/viewer?attributeXmlFile=org.bluetooth.characteristic.cycling_power_measurement.xml\n    // eslint-disable-next-line no-unused-vars\n    const flags = value.getUint16(0, true);\n    let offset = 2;\n\n    // Power is always present\n    const power = value.getInt16(offset, true);\n    rawMeasurement.instantaneousPower = power;\n\n    callbacks.onPowerMeasurement(power, rawMeasurement);\n}\n\nfunction handleHeartRateChanged(event, callbacks) {\n    const value = event.target.value;\n    const heartRate = parseHeartRate(value);\n    callbacks.onHeartRateChange(heartRate);\n}\n\nfunction handleSpeedCadenceMeasurement(event, callbacks) {\n    const value = event.target.value;\n    const flags = value.getUint8(0);\n    let offset = 1;\n\n    const wheelRevsPresent = flags & 0x01;\n    const crankRevsPresent = flags & 0x02;\n\n    // Skip wheel revolution data since we don't need speed/distance\n    if (wheelRevsPresent) {\n        offset += 6; // Skip wheel data\n    }\n\n    if (crankRevsPresent) {\n        const cumulativeCrankRevolutions = value.getUint16(offset, true);\n        const lastCrankEventTime = value.getUint16(offset + 2, true); // 1/1024 seconds\n\n        if (lastCrankRevs > 0) {\n            const revs = cumulativeCrankRevolutions - lastCrankRevs;\n            const time = (lastCrankEventTime - lastCrankTime) / 1024; // in seconds\n            if (time > 0) {\n                const cadence = (revs / time) * 60; // RPM\n                const roundedCadence = Math.round(cadence);\n\n                callbacks.onCadenceChange(roundedCadence);\n\n                // Clear any existing reset timer\n                if (cadenceResetTimer) {\n                    clearTimeout(cadenceResetTimer);\n                }\n\n                // Set timer to reset cadence to 0 if no new data comes in for 3 seconds\n                cadenceResetTimer = setTimeout(() => {\n                    callbacks.onCadenceChange(0);\n                    cadenceResetTimer = null;\n                }, 3000);\n            }\n        }\n        lastCrankRevs = cumulativeCrankRevolutions;\n        lastCrankTime = lastCrankEventTime;\n    }\n}\n\nfunction handleSpyPowerMeasurement(event, elements) {\n    const value = event.target.value;\n    const data = new Uint8Array(value.buffer);\n\n    // Parse cycling power measurement data (same format as main power meter)\n    let instantaneousPower = 0;\n\n    if (data.length >= 4) {\n        // Read instantaneous power (16-bit unsigned integer, little endian)\n        instantaneousPower = data[2] + (data[3] << 8);\n    }\n\n    if (elements.spyValueElement) {\n        elements.spyValueElement.textContent = instantaneousPower;\n    }\n}\n\n// Disconnection handlers\nfunction onPowerMeterDisconnected(callbacks, elements) {\n    callbacks.onStatusUpdate('Device disconnected.');\n    if (elements.deviceNameElement) {\n        elements.deviceNameElement.textContent = '';\n    }\n    if (elements.powerMeterConnectButton) {\n        elements.powerMeterConnectButton.disabled = false;\n    }\n    if (powerMeterDevice) {\n        powerMeterDevice.removeEventListener('gattserverdisconnected', () => {\n            onPowerMeterDisconnected(callbacks, elements);\n        });\n        powerMeterDevice = null;\n    }\n    callbacks.onDisconnected();\n}\n\nfunction onHeartRateDisconnected(callbacks, elements) {\n    callbacks.onStatusUpdate('Device disconnected.');\n    if (elements.hrConnectionStatus) {\n        elements.hrConnectionStatus.textContent = 'Disconnected';\n    }\n    if (elements.hrDeviceName) {\n        elements.hrDeviceName.textContent = '';\n    }\n    if (elements.hrConnectButton) {\n        elements.hrConnectButton.disabled = false;\n    }\n    hrBluetoothDevice = null;\n    callbacks.onHeartRateChange(0);\n}\n\nfunction onCadenceDisconnected(callbacks, elements) {\n    callbacks.onStatusUpdate('Device disconnected.');\n    if (elements.cadenceConnectionStatus) {\n        elements.cadenceConnectionStatus.textContent = 'Disconnected';\n    }\n    if (elements.cadenceDeviceName) {\n        elements.cadenceDeviceName.textContent = '';\n    }\n    if (elements.speedCadenceConnectButton) {\n        elements.speedCadenceConnectButton.disabled = false;\n    }\n    speedCadenceBluetoothDevice = null;\n    callbacks.onCadenceChange(0);\n\n    // Clear cadence reset timer and reset variables\n    if (cadenceResetTimer) {\n        clearTimeout(cadenceResetTimer);\n        cadenceResetTimer = null;\n    }\n    lastCrankRevs = 0;\n    lastCrankTime = 0;\n}\n\nfunction onSpyDisconnected(elements) {\n    spyMeterDevice = null;\n    if (elements.spyValueElement) {\n        elements.spyValueElement.textContent = '--';\n    }\n    if (elements.spyStatusElement) {\n        elements.spyStatusElement.textContent = 'Spy disconnected';\n        elements.spyStatusElement.style.display = 'block';\n    }\n    setTimeout(() => {\n        if (elements.spyStatusElement) {\n            elements.spyStatusElement.style.display = 'none';\n        }\n        if (elements.spyInstructionsElement) {\n            elements.spyInstructionsElement.style.display = 'block';\n        }\n    }, 3000);\n}\n\n/**\n * Clean up all Bluetooth event listeners\n * Call this function when the app is closing or resetting connections\n */\nexport function cleanupBluetoothEventListeners() {\n    if (powerMeterDevice && powerMeterDisconnectHandler) {\n        powerMeterDevice.removeEventListener('gattserverdisconnected', powerMeterDisconnectHandler);\n        powerMeterDisconnectHandler = null;\n    }\n\n    if (hrBluetoothDevice && hrDisconnectHandler) {\n        hrBluetoothDevice.removeEventListener('gattserverdisconnected', hrDisconnectHandler);\n        hrDisconnectHandler = null;\n    }\n\n    if (speedCadenceBluetoothDevice && speedCadenceDisconnectHandler) {\n        speedCadenceBluetoothDevice.removeEventListener('gattserverdisconnected', speedCadenceDisconnectHandler);\n        speedCadenceDisconnectHandler = null;\n    }\n\n    if (spyMeterDevice && spyMeterDisconnectHandler) {\n        spyMeterDevice.removeEventListener('gattserverdisconnected', spyMeterDisconnectHandler);\n        spyMeterDisconnectHandler = null;\n    }\n}","\n\n/**\n * The heart rate measurement is a DataView object.\n * The first byte is a flag, and the subsequent byte(s) are the heart rate value.\n * We need to check the first bit of the flag to see if the value is 8-bit or 16-bit.\n */\nfunction parseHeartRate(value) {\n    const flags = value.getUint8(0);\n    // Check if the heart rate value format is UINT16 (bit 0 is 1) or UINT8 (bit 0 is 0)\n    const is16bit = flags & 0x1;\n    if (is16bit) {\n        // If 16-bit, read 2 bytes starting from the second byte\n        return value.getUint16(1, /*littleEndian=*/ true);\n    } else {\n        // If 8-bit, read 1 byte starting from the second byte\n        return value.getUint8(1);\n    }\n}\n\nexport { parseHeartRate };","/**\n * Screen Wake Lock Management Module\n * Handles requesting and releasing screen wake locks to prevent device sleep during sessions\n */\n\nlet wakeLock = null;\n\n/**\n * Request a screen wake lock to prevent the device from sleeping\n * @returns {Promise<void>}\n */\nexport async function requestWakeLock() {\n    if ('wakeLock' in navigator) {\n        try {\n            wakeLock = await navigator.wakeLock.request('screen');\n            wakeLock.addEventListener('release', () => {\n                // Wake lock was released\n                console.log('Wake lock was released');\n            });\n        } catch (err) {\n            console.error(`${err.name}, ${err.message}`);\n        }\n    }\n}\n\n/**\n * Release the current wake lock\n * @returns {Promise<void>}\n */\nexport async function releaseWakeLock() {\n    if (wakeLock !== null) {\n        await wakeLock.release();\n        wakeLock = null;\n    }\n}\n\n/**\n * Check if wake lock is currently active\n * @returns {boolean}\n */\nexport function isWakeLockActive() {\n    return wakeLock !== null;\n}","/**\n * Export Modals Module\n * Handles modal-based export functionality\n */\n\n// Import required functions from data-export module\nimport {\n    exportAsJson,\n    exportAsCsv,\n    exportAsTcx,\n    exportRawAsJson,\n    exportRawAsCsv,\n    exportSummaryImage,\n    exportToGoogleDocs,\n    exportToGoogleSheets,\n    exportToIntervals,\n    isSignedInToGoogle,\n    authenticateWithGoogle,\n    signOutFromGoogle,\n    showGoogleApiConfigModal,\n    showIntervalsConfigModal,\n    isIntervalsConfigured\n} from './data-export.js';\n\n/**\n * Create and show basic export modal\n * @param {Object} dataStore - Data store object containing export data\n */\nexport function showBasicExportModal(dataStore) {\n    const modal = createExportModal('📄 Basic Exports', 'Export your session data in various formats');\n\n    const buttons = [\n        {\n            text: '📋 Export Summary JSON',\n            description: 'Session summary with averages',\n            onClick: () => {\n                exportAsJson(dataStore.powerData);\n                closeModal(modal);\n            }\n        },\n        {\n            text: '📊 Export Summary CSV',\n            description: 'Session summary for spreadsheets',\n            onClick: () => {\n                exportAsCsv(dataStore.powerData);\n                closeModal(modal);\n            }\n        },\n        {\n            text: '🏃 Export TCX',\n            description: 'Training Center XML format',\n            onClick: () => {\n                try {\n                    exportAsTcx(dataStore.powerData);\n                    closeModal(modal);\n                } catch (error) {\n                    alert(`Error generating TCX file: ${error.message}`);\n                }\n            }\n        },\n        {\n            text: '🔍 Export Raw JSON',\n            description: 'Complete measurement data',\n            onClick: () => {\n                exportRawAsJson(dataStore.rawPowerMeasurements);\n                closeModal(modal);\n            }\n        },\n        {\n            text: '📈 Export Raw CSV',\n            description: 'Raw measurements for analysis',\n            onClick: () => {\n                exportRawAsCsv(dataStore.rawPowerMeasurements);\n                closeModal(modal);\n            }\n        },\n        {\n            text: '🖼️ Export Summary Image',\n            description: 'Visual summary of your session',\n            className: 'primary',\n            onClick: async () => {\n                try {\n                    await exportSummaryImage({\n                        dataPoints: dataStore.powerData,\n                        powerAverages: dataStore.getPowerAverages()\n                    });\n                    closeModal(modal);\n                } catch (error) {\n                    alert(`Error generating summary image: ${error.message}`);\n                }\n            }\n        }\n    ];\n\n    addButtonsToModal(modal, buttons);\n    showModal(modal);\n}\n\n/**\n * Create and show cloud export modal\n * @param {Object} dataStore - Data store object containing export data\n */\nexport function showCloudExportModal(dataStore) {\n    const modal = createExportModal('☁️ Cloud Exports', 'Export to cloud services and platforms');\n\n    const isSignedIn = isSignedInToGoogle();\n\n    const buttons = [\n        {\n            text: isSignedIn ? '🔓 Sign Out from Google' : '🔗 Sign In to Google',\n            description: isSignedIn ? 'Sign out from Google account' : 'Sign in to enable Google exports',\n            className: isSignedIn ? 'danger' : 'success',\n            onClick: async () => {\n                try {\n                    if (isSignedIn) {\n                        await signOutFromGoogle();\n                        alert('Signed out successfully!');\n                    } else {\n                        const success = await authenticateWithGoogle();\n                        if (success) {\n                            alert('Signed in successfully!');\n                        }\n                    }\n                    closeModal(modal);\n                    // Re-open modal to reflect new state\n                    setTimeout(() => showCloudExportModal(dataStore), 100);\n                } catch (error) {\n                    alert(`Google authentication error: ${error.message}`);\n                }\n            }\n        },\n        {\n            text: '📄 Export to Google Docs',\n            description: 'Create a formatted session report',\n            disabled: !isSignedIn,\n            onClick: async () => {\n                if (!isSignedIn) return;\n                try {\n                    await exportToGoogleDocs({\n                        powerData: dataStore.powerData,\n                        powerAverages: dataStore.getPowerAverages(),\n                        sessionStartTime: dataStore.sessionStartTime\n                    });\n                    alert('Successfully exported to Google Docs!');\n                    closeModal(modal);\n                } catch (error) {\n                    alert(`Error exporting to Google Docs: ${error.message}`);\n                }\n            }\n        },\n        {\n            text: '📊 Export to Google Sheets',\n            description: 'Create a detailed data spreadsheet',\n            disabled: !isSignedIn,\n            onClick: async () => {\n                if (!isSignedIn) return;\n                try {\n                    await exportToGoogleSheets({\n                        powerData: dataStore.powerData,\n                        powerAverages: dataStore.getPowerAverages(),\n                        rawMeasurements: dataStore.rawPowerMeasurements,\n                        sessionStartTime: dataStore.sessionStartTime\n                    });\n                    alert('Successfully exported to Google Sheets!');\n                    closeModal(modal);\n                } catch (error) {\n                    alert(`Error exporting to Google Sheets: ${error.message}`);\n                }\n            }\n        },\n        {\n            text: '⚙️ Configure Google API',\n            description: 'Set up Google API credentials',\n            onClick: () => {\n                closeModal(modal);\n                showGoogleApiConfigModal();\n            }\n        }\n    ];\n\n    addButtonsToModal(modal, buttons);\n    showModal(modal);\n}\n\n/**\n * Create and show training platforms export modal\n * @param {Object} dataStore - Data store object containing export data\n */\nexport function showTrainingPlatformsModal(dataStore) {\n    const modal = createExportModal('🏃 Training Platforms', 'Export to training analysis platforms');\n\n    const isConfigured = isIntervalsConfigured();\n\n    const buttons = [\n        {\n            text: '🚴 Export to intervals.icu',\n            description: 'Upload activity to intervals.icu',\n            disabled: !isConfigured,\n            onClick: async () => {\n                if (!isConfigured) return;\n                try {\n                    await exportToIntervals({\n                        powerData: dataStore.powerData,\n                        powerAverages: dataStore.getPowerAverages(),\n                        sessionStartTime: dataStore.sessionStartTime\n                    });\n                    alert('Successfully exported to intervals.icu!');\n                    closeModal(modal);\n                } catch (error) {\n                    alert(`Error exporting to intervals.icu: ${error.message}`);\n                }\n            }\n        },\n        {\n            text: '⚙️ Configure intervals.icu',\n            description: 'Set up intervals.icu credentials',\n            onClick: () => {\n                closeModal(modal);\n                showIntervalsConfigModal();\n            }\n        }\n    ];\n\n    addButtonsToModal(modal, buttons);\n    showModal(modal);\n}\n\n/**\n * Create and show utilities modal\n * @param {Object} dataStore - Data store object containing export data\n */\nexport function showUtilitiesModal(dataStore) {\n    const modal = createExportModal('🛠️ Utilities', 'Session management and utilities');\n\n    const buttons = [\n        {\n            text: '🗑️ Clear Session Data',\n            description: 'Clear all session data (cannot be undone)',\n            className: 'danger',\n            onClick: () => {\n                const confirmed = confirm(\n                    'Are you sure you want to clear all session data? This action cannot be undone.'\n                );\n                if (confirmed) {\n                    dataStore.resetAllSessionData();\n                    alert('Session data cleared successfully!');\n                    closeModal(modal);\n                }\n            }\n        }\n    ];\n\n    addButtonsToModal(modal, buttons);\n    showModal(modal);\n}\n\n/**\n * Create export modal with header\n * @param {string} title - Modal title\n * @param {string} description - Modal description\n * @returns {HTMLElement} Modal element\n */\nfunction createExportModal(title, description) {\n    const modal = document.createElement('div');\n    modal.className = 'export-modal';\n\n    modal.innerHTML = `\n        <div class=\"export-modal-content\">\n            <div class=\"export-modal-header\">\n                <h3 class=\"export-modal-title\">${title}</h3>\n                <button class=\"export-modal-close\" aria-label=\"Close modal\">&times;</button>\n            </div>\n            <div class=\"export-modal-description\">${description}</div>\n            <div class=\"export-modal-buttons\"></div>\n        </div>\n    `;\n\n    // Add close functionality\n    const closeBtn = modal.querySelector('.export-modal-close');\n    closeBtn.addEventListener('click', () => closeModal(modal));\n\n    modal.addEventListener('click', (e) => {\n        if (e.target === modal) {\n            closeModal(modal);\n        }\n    });\n\n    return modal;\n}\n\n/**\n * Add buttons to modal\n * @param {HTMLElement} modal - Modal element\n * @param {Array} buttons - Array of button configurations\n */\nfunction addButtonsToModal(modal, buttons) {\n    const buttonsContainer = modal.querySelector('.export-modal-buttons');\n\n    buttons.forEach(buttonConfig => {\n        const button = document.createElement('button');\n        button.className = `export-modal-button ${buttonConfig.className || ''}`;\n        button.disabled = buttonConfig.disabled || false;\n\n        button.innerHTML = `\n            <span>${buttonConfig.text}</span>\n            ${buttonConfig.description ? `<small style=\"opacity: 0.7; font-size: 0.8em;\">${buttonConfig.description}</small>` : ''}\n        `;\n\n        button.addEventListener('click', buttonConfig.onClick);\n        buttonsContainer.appendChild(button);\n    });\n}\n\n/**\n * Show modal with animation\n * @param {HTMLElement} modal - Modal element\n */\nfunction showModal(modal) {\n    document.body.appendChild(modal);\n    // Trigger animation\n    requestAnimationFrame(() => {\n        modal.classList.add('show');\n    });\n}\n\n/**\n * Close modal with animation\n * @param {HTMLElement} modal - Modal element\n */\nfunction closeModal(modal) {\n    modal.classList.remove('show');\n    setTimeout(() => {\n        if (modal.parentNode) {\n            document.body.removeChild(modal);\n        }\n    }, 300);\n}\n\n/**\n * Setup export menu event listeners\n * @param {Object} dataStore - Data store object\n */\nexport function setupExportMenuListeners(dataStore) {\n    // Initialize export section as collapsed by default\n    initializeExportSection();\n\n    // Setup export section toggle\n    setupExportSectionToggle();\n\n    // Basic exports\n    const basicMenuItem = document.getElementById('exportBasicMenuItem');\n    if (basicMenuItem) {\n        basicMenuItem.addEventListener('click', () => {\n            showBasicExportModal(dataStore);\n        });\n    }\n\n    // Cloud exports\n    const cloudMenuItem = document.getElementById('exportCloudMenuItem');\n    if (cloudMenuItem) {\n        cloudMenuItem.addEventListener('click', () => {\n            showCloudExportModal(dataStore);\n        });\n    }\n\n    // Training platforms\n    const servicesMenuItem = document.getElementById('exportServicesMenuItem');\n    if (servicesMenuItem) {\n        servicesMenuItem.addEventListener('click', () => {\n            showTrainingPlatformsModal(dataStore);\n        });\n    }\n\n    // Utilities\n    const utilsMenuItem = document.getElementById('exportUtilsMenuItem');\n    if (utilsMenuItem) {\n        utilsMenuItem.addEventListener('click', () => {\n            showUtilitiesModal(dataStore);\n        });\n    }\n}\n\n/**\n * Initialize export section to be collapsed by default\n */\nfunction initializeExportSection() {\n    const exportSection = document.getElementById('exportMenuSection');\n    if (exportSection) {\n        exportSection.classList.add('collapsed');\n    }\n}\n\n/**\n * Setup export section toggle functionality\n */\nfunction setupExportSectionToggle() {\n    const toggleHeader = document.getElementById('exportSectionToggleHeader');\n    const exportSection = document.getElementById('exportMenuSection');\n\n    if (toggleHeader && exportSection) {\n        toggleHeader.addEventListener('click', () => {\n            exportSection.classList.toggle('collapsed');\n        });\n    }\n}","/**\n * Data Export Module\n * Handles all data export functionality including JSON, CSV, TCX, image, and cloud exports\n * \n * Cloud Export Features:\n * - Google Docs: Creates formatted documents with session summaries\n * - Google Sheets: Creates spreadsheets with detailed data analysis\n * - More cloud services can be added following the established patterns\n * \n * @global gapi - Google API client (loaded dynamically)\n */\n\nimport { generateTcxString } from './create-tcx.js';\nimport { generateSummaryImage } from './create-image.js';\nimport { getCurrentDateString } from './ui-management.js';\n\n/* ==========================================================================\n   Cloud Export Configuration\n   ========================================================================== */\n\n/**\n * Google API configuration for cloud exports\n * @constant {Object}\n */\nconst GOOGLE_API_CONFIG = {\n    CLIENT_ID: '', // Will be set by user or environment\n    API_KEY: '', // Will be set by user or environment\n    DISCOVERY_DOCS: [\n        'https://docs.googleapis.com/$discovery/rest?version=v1',\n        'https://sheets.googleapis.com/$discovery/rest?version=v4'\n    ],\n    SCOPES: [\n        'https://www.googleapis.com/auth/documents',\n        'https://www.googleapis.com/auth/spreadsheets',\n        'https://www.googleapis.com/auth/drive.file'\n    ]\n};\n\n/**\n * intervals.icu API configuration for cycling analytics export\n * @constant {Object}\n */\nconst INTERVALS_CONFIG = {\n    BASE_URL: 'https://intervals.icu/api/v1',\n    API_KEY: '', // Will be set by user\n    ATHLETE_ID: '', // Will be set by user\n    SUPPORTED_FORMATS: ['fit', 'tcx', 'gpx'],\n    MAX_FILE_SIZE: 50 * 1024 * 1024, // 50MB limit\n    UPLOAD_ENDPOINTS: {\n        activities: '/activities',\n        wellness: '/wellness'\n    }\n};\n\n/**\n * Cloud export state management\n * @type {Object}\n */\nconst cloudExportState = {\n    isGoogleApiLoaded: false,\n    isUserSignedIn: false,\n    authInstance: null,\n    lastError: null,\n    intervals: {\n        isConfigured: false,\n        apiKey: null,\n        athleteId: null,\n        lastUpload: null\n    }\n};\n\n/**\n * Export power data as JSON\n * @param {Array} powerData - Array of power data points\n */\nexport function exportAsJson(powerData) {\n    if (!powerData || !Array.isArray(powerData) || powerData.length === 0) {\n        throw new Error('No valid power data available to export as JSON');\n    }\n\n    const jsonString = JSON.stringify(powerData, null, 2);\n    const blob = new Blob([jsonString], {\n        type: 'application/json',\n    });\n    downloadFile(blob, `power_data_${getCurrentDateString()}.json`);\n}\n\n/**\n * Export power data as CSV\n * @param {Array} powerData - Array of power data points\n */\nexport function exportAsCsv(powerData) {\n    if (!powerData || !Array.isArray(powerData) || powerData.length === 0) {\n        throw new Error('No valid power data available to export as CSV');\n    }\n\n    let csvContent = 'timestamp,power,heartRate,cadence\\n';\n    powerData.forEach((row) => {\n        // Safely handle missing properties\n        const timestamp = row.timestamp || '';\n        const power = row.power || 0;\n        const heartRate = row.heartRate || 0;\n        const cadence = row.cadence || 0;\n        csvContent += `${timestamp},${power},${heartRate},${cadence}\\n`;\n    });\n\n    const blob = new Blob([csvContent], {\n        type: 'text/csv;charset=utf-8;',\n    });\n    downloadFile(blob, `power_data_${getCurrentDateString()}.csv`);\n}\n\n/**\n * Export raw power measurements as JSON\n * @param {Array} rawPowerMeasurements - Array of raw power measurement data\n */\nexport function exportRawAsJson(rawPowerMeasurements) {\n    const jsonString = JSON.stringify(rawPowerMeasurements, null, 2);\n    const blob = new Blob([jsonString], {\n        type: 'application/json',\n    });\n    downloadFile(blob, `raw_power_measurements_${getCurrentDateString()}.json`);\n}\n\n/**\n * Export raw power measurements as CSV\n * @param {Array} rawPowerMeasurements - Array of raw power measurement data\n */\nexport function exportRawAsCsv(rawPowerMeasurements) {\n    let csvContent = 'timestamp,flags,dataLength,instantaneousPower,rawBytes\\n';\n\n    rawPowerMeasurements.forEach((measurement) => {\n        csvContent += `${measurement.timestamp},${measurement.flags},${measurement.dataLength},${measurement.instantaneousPower},\"${measurement.rawBytes}\"\\n`;\n    });\n\n    const blob = new Blob([csvContent], {\n        type: 'text/csv;charset=utf-8;',\n    });\n    downloadFile(blob, `raw_power_measurements_${getCurrentDateString()}.csv`);\n}\n\n/**\n * Export power data as TCX file\n * @param {Array} powerData - Array of power data points\n */\nexport function exportAsTcx(powerData) {\n    try {\n        if (powerData.length === 0) {\n            throw new Error('No power data available to export.');\n        }\n\n        const tcxContent = generateTcxString(powerData);\n\n        const blob = new Blob([tcxContent], {\n            type: 'application/xml;charset=utf-8;',\n        });\n        downloadFile(blob, `power_data_${getCurrentDateString()}.tcx`);\n    } catch (error) {\n        console.error('Error generating TCX:', error);\n        throw error;\n    }\n}\n\n/**\n * Export summary image\n * @param {Object} data - Object containing dataPoints and powerAverages\n */\nexport async function exportSummaryImage(data) {\n    try {\n        if (data.dataPoints.length === 0) {\n            throw new Error('No data available to export. Please record some activity first.');\n        }\n\n        const canvas = await generateSummaryImage({\n            dataPoints: data.dataPoints,\n            powerAverages: data.powerAverages\n        });\n\n        return new Promise((resolve, reject) => {\n            canvas.toBlob((blob) => {\n                if (blob) {\n                    downloadFile(blob, `power_meter_summary_${getCurrentDateString()}.png`);\n                    resolve();\n                } else {\n                    reject(new Error('Failed to generate image blob'));\n                }\n            }, 'image/png');\n        });\n    } catch (error) {\n        console.error('Error generating summary image:', error);\n        throw error;\n    }\n}\n\n/**\n * Helper function to trigger file download\n * @param {Blob} blob - The blob to download\n * @param {string} filename - The filename for the download\n */\nfunction downloadFile(blob, filename) {\n    try {\n        if (!blob || !(blob instanceof Blob)) {\n            throw new Error('Invalid blob provided for download');\n        }\n\n        if (!filename || typeof filename !== 'string') {\n            throw new Error('Invalid filename provided for download');\n        }\n\n        const url = URL.createObjectURL(blob);\n        const a = document.createElement('a');\n        a.href = url;\n        a.download = filename;\n        document.body.appendChild(a);\n        a.click();\n        document.body.removeChild(a);\n        URL.revokeObjectURL(url);\n    } catch (error) {\n        console.error('Error during file download:', error);\n        throw error;\n    }\n}\n\n/* ==========================================================================\n   Cloud Export Functions - Google API Integration\n   ========================================================================== */\n\n/**\n * Initialize Google API for cloud exports\n * @async\n * @param {string} clientId - Google OAuth2 client ID\n * @param {string} apiKey - Google API key\n * @returns {Promise<boolean>} True if initialization successful\n */\nexport async function initializeGoogleAPI(clientId, apiKey) {\n    try {\n        // Set configuration\n        GOOGLE_API_CONFIG.CLIENT_ID = clientId;\n        GOOGLE_API_CONFIG.API_KEY = apiKey;\n\n        // Load Google API if not already loaded\n        if (!window.gapi) {\n            await loadGoogleAPIScript();\n        }\n\n        // Initialize the API\n        await new Promise((resolve, reject) => {\n            window.gapi.load('auth2:client', {\n                callback: resolve,\n                onerror: reject\n            });\n        });\n\n        // Initialize auth and client\n        await window.gapi.client.init({\n            apiKey: GOOGLE_API_CONFIG.API_KEY,\n            clientId: GOOGLE_API_CONFIG.CLIENT_ID,\n            discoveryDocs: GOOGLE_API_CONFIG.DISCOVERY_DOCS,\n            scope: GOOGLE_API_CONFIG.SCOPES.join(' ')\n        });\n\n        cloudExportState.authInstance = window.gapi.auth2.getAuthInstance();\n        cloudExportState.isGoogleApiLoaded = true;\n        cloudExportState.isUserSignedIn = cloudExportState.authInstance.isSignedIn.get();\n\n        console.log('Google API initialized successfully');\n        return true;\n    } catch (error) {\n        console.error('Failed to initialize Google API:', error);\n        cloudExportState.lastError = error.message;\n        return false;\n    }\n}\n\n/**\n * Load Google API script dynamically\n * @async\n * @returns {Promise<void>}\n */\nfunction loadGoogleAPIScript() {\n    return new Promise((resolve, reject) => {\n        if (document.querySelector('script[src*=\"apis.google.com\"]')) {\n            resolve();\n            return;\n        }\n\n        const script = document.createElement('script');\n        script.src = 'https://apis.google.com/js/api.js';\n        script.onload = resolve;\n        script.onerror = () => reject(new Error('Failed to load Google API script'));\n        document.head.appendChild(script);\n    });\n}\n\n/**\n * Authenticate user with Google\n * @async\n * @returns {Promise<boolean>} True if authentication successful\n */\nexport async function authenticateWithGoogle() {\n    try {\n        if (!cloudExportState.isGoogleApiLoaded) {\n            throw new Error('Google API not initialized. Please configure API credentials first.');\n        }\n\n        if (!cloudExportState.isUserSignedIn) {\n            await cloudExportState.authInstance.signIn();\n            cloudExportState.isUserSignedIn = cloudExportState.authInstance.isSignedIn.get();\n        }\n\n        return cloudExportState.isUserSignedIn;\n    } catch (error) {\n        console.error('Google authentication failed:', error);\n        cloudExportState.lastError = error.message;\n        return false;\n    }\n}\n\n/**\n * Sign out from Google\n * @async\n * @returns {Promise<void>}\n */\nexport async function signOutFromGoogle() {\n    try {\n        if (cloudExportState.authInstance && cloudExportState.isUserSignedIn) {\n            await cloudExportState.authInstance.signOut();\n            cloudExportState.isUserSignedIn = false;\n        }\n    } catch (error) {\n        console.error('Google sign out failed:', error);\n    }\n}\n\n/**\n * Check if user is currently signed in to Google\n * @returns {boolean} True if user is signed in\n */\nexport function isSignedInToGoogle() {\n    return cloudExportState.isUserSignedIn;\n}\n\n/**\n * Get the last error that occurred during cloud operations\n * @returns {string|null} Error message or null if no error\n */\nexport function getLastCloudError() {\n    return cloudExportState.lastError;\n}\n\n/* ==========================================================================\n   intervals.icu Export Functions\n   ========================================================================== */\n\n/**\n * Initialize intervals.icu configuration\n * @param {string} apiKey - intervals.icu API key\n * @param {string} athleteId - intervals.icu athlete ID\n * @returns {boolean} True if initialization successful\n */\nexport function initializeIntervalsConfig(apiKey, athleteId) {\n    try {\n        if (!apiKey || typeof apiKey !== 'string' || apiKey.trim().length === 0) {\n            throw new Error('Valid API key is required');\n        }\n\n        if (!athleteId || typeof athleteId !== 'string' || athleteId.trim().length === 0) {\n            throw new Error('Valid athlete ID is required');\n        }\n\n        // Sanitize inputs\n        const cleanApiKey = apiKey.trim();\n        const cleanAthleteId = athleteId.trim();\n\n        INTERVALS_CONFIG.API_KEY = cleanApiKey;\n        INTERVALS_CONFIG.ATHLETE_ID = cleanAthleteId;\n\n        cloudExportState.intervals.isConfigured = true;\n        cloudExportState.intervals.apiKey = cleanApiKey;\n        cloudExportState.intervals.athleteId = cleanAthleteId;\n\n        console.log('intervals.icu configuration initialized successfully');\n        return true;\n    } catch (error) {\n        console.error('Failed to initialize intervals.icu configuration:', error);\n        cloudExportState.lastError = error.message;\n        return false;\n    }\n}\n\n/**\n * Check if intervals.icu is properly configured\n * @returns {boolean} True if configured\n */\nexport function isIntervalsConfigured() {\n    return cloudExportState.intervals.isConfigured &&\n        cloudExportState.intervals.apiKey &&\n        cloudExportState.intervals.athleteId;\n}\n\n/**\n * Export power data to intervals.icu as an activity\n * @async\n * @param {Object} data - Export data object\n * @param {Array} data.powerData - Array of power data points\n * @param {Date} data.sessionStartTime - Session start time\n * @param {Object} data.powerAverages - Power averages object\n * @param {string} [data.activityName] - Custom activity name\n * @param {string} [data.description] - Activity description\n * @returns {Promise<string>} Activity ID of created activity\n */\nexport async function exportToIntervals(data) {\n    try {\n        // Ensure configuration\n        if (!isIntervalsConfigured()) {\n            throw new Error('intervals.icu not configured. Please set up API credentials first.');\n        }\n\n        const { powerData, sessionStartTime, powerAverages, activityName, description } = data;\n\n        if (!powerData || powerData.length === 0) {\n            throw new Error('No power data available to export');\n        }\n\n        // Generate TCX content for intervals.icu\n        const tcxContent = generateIntervalsCompatibleTCX({\n            powerData,\n            sessionStartTime,\n            powerAverages,\n            activityName: activityName || `Power Meter Session - ${new Date(sessionStartTime).toLocaleDateString()}`,\n            description: description || 'Exported from Power Saver Web App'\n        });\n\n        // Upload to intervals.icu\n        const activityId = await uploadToIntervals(tcxContent, {\n            name: activityName || `Power Meter Session - ${new Date(sessionStartTime).toLocaleDateString()}`,\n            description: description || 'Exported from Power Saver Web App',\n            type: 'Ride'\n        });\n\n        console.log('Successfully exported to intervals.icu:', activityId);\n        cloudExportState.intervals.lastUpload = new Date().toISOString();\n\n        return activityId;\n    } catch (error) {\n        console.error('Error exporting to intervals.icu:', error);\n        cloudExportState.lastError = error.message;\n        throw new Error(`Failed to export to intervals.icu: ${error.message}`);\n    }\n}\n\n/**\n * Upload TCX content to intervals.icu\n * @async\n * @param {string} tcxContent - TCX file content\n * @param {Object} metadata - Activity metadata\n * @returns {Promise<string>} Activity ID\n */\nasync function uploadToIntervals(tcxContent, metadata) {\n    try {\n        // Create form data for file upload\n        const formData = new FormData();\n        const tcxBlob = new Blob([tcxContent], { type: 'application/xml' });\n\n        formData.append('file', tcxBlob, `power-session-${Date.now()}.tcx`);\n        formData.append('name', metadata.name);\n        formData.append('description', metadata.description);\n        formData.append('type', metadata.type);\n\n        // Upload to intervals.icu\n        const response = await fetch(`${INTERVALS_CONFIG.BASE_URL}/athlete/${INTERVALS_CONFIG.ATHLETE_ID}/activities`, {\n            method: 'POST',\n            headers: {\n                'Authorization': `Basic ${btoa(`${INTERVALS_CONFIG.API_KEY}:`)}`\n            },\n            body: formData\n        });\n\n        if (!response.ok) {\n            const errorText = await response.text();\n            throw new Error(`intervals.icu API error: ${response.status} - ${errorText}`);\n        }\n\n        const result = await response.json();\n        return result.id || result.activity_id || 'uploaded';\n    } catch (error) {\n        console.error('Upload to intervals.icu failed:', error);\n        throw error;\n    }\n}\n\n/**\n * Generate intervals.icu compatible TCX content\n * @param {Object} data - Activity data\n * @returns {string} TCX content\n */\nfunction generateIntervalsCompatibleTCX(data) {\n    const { powerData, sessionStartTime, description } = data;\n\n    const startTime = new Date(sessionStartTime).toISOString();\n\n    let tcxContent = `<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n`;\n    tcxContent += `<TrainingCenterDatabase xsi:schemaLocation=\"http://www.garmin.com/xmlschemas/TrainingCenterDatabase/v2 http://www.garmin.com/xmlschemas/TrainingCenterDatabasev2.xsd\" xmlns:ns5=\"http://www.garmin.com/xmlschemas/ActivityGoals/v1\" xmlns:ns3=\"http://www.garmin.com/xmlschemas/ActivityExtension/v2\" xmlns:ns2=\"http://www.garmin.com/xmlschemas/UserProfile/v2\" xmlns=\"http://www.garmin.com/xmlschemas/TrainingCenterDatabase/v2\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:ns4=\"http://www.garmin.com/xmlschemas/ProfileExtension/v1\">\\n`;\n    tcxContent += `  <Activities>\\n`;\n    tcxContent += `    <Activity Sport=\"Biking\">\\n`;\n    tcxContent += `      <Id>${startTime}</Id>\\n`;\n    tcxContent += `      <Notes>${description}</Notes>\\n`;\n    tcxContent += `      <Lap StartTime=\"${startTime}\">\\n`;\n\n    // Calculate lap statistics\n    const lapStats = calculateLapStatistics(powerData);\n    tcxContent += `        <TotalTimeSeconds>${lapStats.totalTime}</TotalTimeSeconds>\\n`;\n    tcxContent += `        <DistanceMeters>${lapStats.distance}</DistanceMeters>\\n`;\n    tcxContent += `        <MaximumSpeed>${lapStats.maxSpeed}</MaximumSpeed>\\n`;\n    tcxContent += `        <Calories>${lapStats.calories}</Calories>\\n`;\n\n    if (lapStats.avgHeartRate > 0) {\n        tcxContent += `        <AverageHeartRateBpm><Value>${Math.round(lapStats.avgHeartRate)}</Value></AverageHeartRateBpm>\\n`;\n        tcxContent += `        <MaximumHeartRateBpm><Value>${lapStats.maxHeartRate}</Value></MaximumHeartRateBpm>\\n`;\n    }\n\n    tcxContent += `        <Intensity>Active</Intensity>\\n`;\n    tcxContent += `        <TriggerMethod>Manual</TriggerMethod>\\n`;\n    tcxContent += `        <Track>\\n`;\n\n    // Add trackpoints\n    powerData.forEach((point) => {\n        const timestamp = new Date(point.timestamp).toISOString();\n        tcxContent += `          <Trackpoint>\\n`;\n        tcxContent += `            <Time>${timestamp}</Time>\\n`;\n\n        if (point.heartRate && point.heartRate > 0) {\n            tcxContent += `            <HeartRateBpm><Value>${point.heartRate}</Value></HeartRateBpm>\\n`;\n        }\n\n        if (point.cadence && point.cadence > 0) {\n            tcxContent += `            <Cadence>${point.cadence}</Cadence>\\n`;\n        }\n\n        // Add power data in extensions\n        tcxContent += `            <Extensions>\\n`;\n        tcxContent += `              <ns3:TPX>\\n`;\n        if (point.power && point.power > 0) {\n            tcxContent += `                <ns3:Watts>${point.power}</ns3:Watts>\\n`;\n        }\n        tcxContent += `              </ns3:TPX>\\n`;\n        tcxContent += `            </Extensions>\\n`;\n        tcxContent += `          </Trackpoint>\\n`;\n    });\n\n    tcxContent += `        </Track>\\n`;\n\n    // Add power extensions for the lap\n    tcxContent += `        <Extensions>\\n`;\n    tcxContent += `          <ns3:LX>\\n`;\n    if (lapStats.avgPower > 0) {\n        tcxContent += `            <ns3:AvgWatts>${Math.round(lapStats.avgPower)}</ns3:AvgWatts>\\n`;\n        tcxContent += `            <ns3:MaxWatts>${lapStats.maxPower}</ns3:MaxWatts>\\n`;\n    }\n    tcxContent += `          </ns3:LX>\\n`;\n    tcxContent += `        </Extensions>\\n`;\n    tcxContent += `      </Lap>\\n`;\n\n    // Add activity-level power data\n    tcxContent += `      <Extensions>\\n`;\n    tcxContent += `        <ns3:ActivityExtensions>\\n`;\n    if (lapStats.avgPower > 0) {\n        tcxContent += `          <ns3:AvgWatts>${Math.round(lapStats.avgPower)}</ns3:AvgWatts>\\n`;\n        tcxContent += `          <ns3:MaxWatts>${lapStats.maxPower}</ns3:MaxWatts>\\n`;\n    }\n    tcxContent += `        </ns3:ActivityExtensions>\\n`;\n    tcxContent += `      </Extensions>\\n`;\n    tcxContent += `    </Activity>\\n`;\n    tcxContent += `  </Activities>\\n`;\n    tcxContent += `</TrainingCenterDatabase>`;\n\n    return tcxContent;\n}\n\n/**\n * Calculate lap statistics for TCX export\n * @param {Array} powerData - Array of power data points\n * @returns {Object} Lap statistics\n */\nfunction calculateLapStatistics(powerData) {\n    if (powerData.length === 0) {\n        return {\n            totalTime: 0,\n            distance: 0,\n            maxSpeed: 0,\n            calories: 0,\n            avgHeartRate: 0,\n            maxHeartRate: 0,\n            avgPower: 0,\n            maxPower: 0\n        };\n    }\n\n    const startTime = new Date(powerData[0].timestamp).getTime();\n    const endTime = new Date(powerData[powerData.length - 1].timestamp).getTime();\n    const totalTime = (endTime - startTime) / 1000; // seconds\n\n    const powers = powerData.map(p => p.power || 0).filter(p => p > 0);\n    const heartRates = powerData.map(p => p.heartRate || 0).filter(hr => hr > 0);\n\n    // Estimate distance based on power (rough approximation)\n    const avgPower = powers.length > 0 ? powers.reduce((a, b) => a + b, 0) / powers.length : 0;\n    const estimatedSpeed = avgPower > 0 ? Math.sqrt(avgPower / 3.6) : 15; // km/h estimate\n    const distance = (estimatedSpeed / 3.6) * totalTime; // meters\n\n    // Estimate calories based on power and time\n    const calories = avgPower > 0 ? Math.round((avgPower * totalTime * 4.18) / 1000) : Math.round(totalTime * 10);\n\n    return {\n        totalTime: Math.round(totalTime),\n        distance: Math.round(distance),\n        maxSpeed: Math.round(estimatedSpeed * 1.2 / 3.6 * 100) / 100, // m/s\n        calories,\n        avgHeartRate: heartRates.length > 0 ? heartRates.reduce((a, b) => a + b, 0) / heartRates.length : 0,\n        maxHeartRate: heartRates.length > 0 ? Math.max(...heartRates) : 0,\n        avgPower: avgPower,\n        maxPower: powers.length > 0 ? Math.max(...powers) : 0\n    };\n}\n\n\n/**\n * Export power data to Google Docs as a formatted document\n * @async\n * @param {Object} data - Export data object\n * @param {Array} data.powerData - Array of power data points\n * @param {Object} data.powerAverages - Power averages object\n * @param {Date} data.sessionStartTime - Session start time\n * @returns {Promise<string>} Document ID of created Google Doc\n */\nexport async function exportToGoogleDocs(data) {\n    try {\n        // Ensure authentication\n        if (!await authenticateWithGoogle()) {\n            throw new Error('Google authentication required');\n        }\n\n        const { powerData, powerAverages, sessionStartTime } = data;\n        const sessionDate = sessionStartTime ? new Date(sessionStartTime) : new Date();\n        const documentTitle = `Power Meter Session - ${sessionDate.toLocaleDateString()}`;\n\n        // Create document structure\n        const documentContent = generateGoogleDocsContent(powerData, powerAverages, sessionDate);\n\n        // Create the document\n        const response = await window.gapi.client.docs.documents.create({\n            resource: {\n                title: documentTitle\n            }\n        });\n\n        const documentId = response.result.documentId;\n\n        // Add content to the document\n        await window.gapi.client.docs.documents.batchUpdate({\n            documentId: documentId,\n            resource: {\n                requests: documentContent\n            }\n        });\n\n        // Open the document in a new tab\n        const documentUrl = `https://docs.google.com/document/d/${documentId}/edit`;\n        window.open(documentUrl, '_blank');\n\n        console.log('Successfully exported to Google Docs:', documentId);\n        return documentId;\n    } catch (error) {\n        console.error('Error exporting to Google Docs:', error);\n        throw new Error(`Failed to export to Google Docs: ${error.message}`);\n    }\n}\n\n/**\n * Export power data to Google Sheets as a detailed spreadsheet\n * @async\n * @param {Object} data - Export data object\n * @param {Array} data.powerData - Array of power data points\n * @param {Array} data.rawMeasurements - Array of raw measurements\n * @param {Date} data.sessionStartTime - Session start time\n * @returns {Promise<string>} Spreadsheet ID of created Google Sheet\n */\nexport async function exportToGoogleSheets(data) {\n    try {\n        // Ensure authentication\n        if (!await authenticateWithGoogle()) {\n            throw new Error('Google authentication required');\n        }\n\n        const { powerData, rawMeasurements, sessionStartTime } = data;\n        const sessionDate = sessionStartTime ? new Date(sessionStartTime) : new Date();\n        const spreadsheetTitle = `Power Meter Data - ${sessionDate.toLocaleDateString()}`;\n\n        // Create the spreadsheet\n        const response = await window.gapi.client.sheets.spreadsheets.create({\n            resource: {\n                properties: {\n                    title: spreadsheetTitle\n                },\n                sheets: [\n                    {\n                        properties: {\n                            title: 'Summary Data',\n                            gridProperties: {\n                                rowCount: Math.max(1000, powerData.length + 10),\n                                columnCount: 10\n                            }\n                        }\n                    },\n                    {\n                        properties: {\n                            title: 'Raw Measurements',\n                            gridProperties: {\n                                rowCount: Math.max(1000, rawMeasurements.length + 10),\n                                columnCount: 8\n                            }\n                        }\n                    }\n                ]\n            }\n        });\n\n        const spreadsheetId = response.result.spreadsheetId;\n\n        // Prepare data for sheets\n        const summaryData = generateSheetsData(powerData, 'summary');\n        const rawData = generateSheetsData(rawMeasurements, 'raw');\n\n        // Update the sheets with data\n        await window.gapi.client.sheets.spreadsheets.values.batchUpdate({\n            spreadsheetId: spreadsheetId,\n            resource: {\n                valueInputOption: 'RAW',\n                data: [\n                    {\n                        range: 'Summary Data!A1',\n                        values: summaryData\n                    },\n                    {\n                        range: 'Raw Measurements!A1',\n                        values: rawData\n                    }\n                ]\n            }\n        });\n\n        // Apply formatting\n        await formatGoogleSheet(spreadsheetId);\n\n        // Open the spreadsheet in a new tab\n        const spreadsheetUrl = `https://docs.google.com/spreadsheets/d/${spreadsheetId}/edit`;\n        window.open(spreadsheetUrl, '_blank');\n\n        console.log('Successfully exported to Google Sheets:', spreadsheetId);\n        return spreadsheetId;\n    } catch (error) {\n        console.error('Error exporting to Google Sheets:', error);\n        throw new Error(`Failed to export to Google Sheets: ${error.message}`);\n    }\n}\n\n/* ==========================================================================\n   Google Docs Content Generation\n   ========================================================================== */\n\n/**\n * Generate Google Docs document content with rich formatting\n * @param {Array} powerData - Array of power data points\n * @param {Object} powerAverages - Power averages object\n * @param {Date} sessionDate - Session date\n * @returns {Array} Array of Google Docs API requests\n */\nfunction generateGoogleDocsContent(powerData, powerAverages, sessionDate) {\n    const requests = [];\n    let insertIndex = 1;\n\n    // Document title and header\n    const headerText = `Power Meter Session Report\\n${sessionDate.toLocaleDateString()} ${sessionDate.toLocaleTimeString()}\\n\\n`;\n    requests.push({\n        insertText: {\n            location: { index: insertIndex },\n            text: headerText\n        }\n    });\n    insertIndex += headerText.length;\n\n    // Format header\n    requests.push({\n        updateTextStyle: {\n            range: {\n                startIndex: 1,\n                endIndex: headerText.indexOf('\\n')\n            },\n            textStyle: {\n                bold: true,\n                fontSize: { magnitude: 18, unit: 'PT' }\n            },\n            fields: 'bold,fontSize'\n        }\n    });\n\n    // Session Summary\n    const summaryText = generateSessionSummary(powerData, powerAverages);\n    requests.push({\n        insertText: {\n            location: { index: insertIndex },\n            text: summaryText\n        }\n    });\n    insertIndex += summaryText.length;\n\n    // Data table\n    if (powerData.length > 0) {\n        const tableData = generateDocumentTable(powerData);\n        requests.push({\n            insertTable: {\n                location: { index: insertIndex },\n                rows: tableData.length,\n                columns: tableData[0].length\n            }\n        });\n\n        // Fill table with data (simplified for document formatting)\n        // Note: Actual table insertion would require more complex API calls\n        insertIndex += 50; // Approximate offset for table content\n    }\n\n    return requests;\n}\n\n/**\n * Generate session summary text for Google Docs\n * @param {Array} powerData - Array of power data points\n * @param {Object} powerAverages - Power averages object\n * @returns {string} Formatted summary text\n */\nfunction generateSessionSummary(powerData, powerAverages) {\n    if (powerData.length === 0) {\n        return \"Session Summary\\n\\nNo data recorded during this session.\\n\\n\";\n    }\n\n    const duration = calculateSessionDuration(powerData);\n    const stats = calculateSessionStats(powerData);\n\n    let summary = \"Session Summary\\n\\n\";\n    summary += `Duration: ${formatDuration(duration)}\\n`;\n    summary += `Total Data Points: ${powerData.length}\\n`;\n    summary += `Average Power: ${stats.avgPower.toFixed(1)} W\\n`;\n    summary += `Maximum Power: ${stats.maxPower} W\\n`;\n    summary += `Minimum Power: ${stats.minPower} W\\n`;\n\n    if (stats.avgHeartRate > 0) {\n        summary += `Average Heart Rate: ${stats.avgHeartRate.toFixed(0)} BPM\\n`;\n        summary += `Maximum Heart Rate: ${stats.maxHeartRate} BPM\\n`;\n    }\n\n    if (stats.avgCadence > 0) {\n        summary += `Average Cadence: ${stats.avgCadence.toFixed(0)} RPM\\n`;\n        summary += `Maximum Cadence: ${stats.maxCadence} RPM\\n`;\n    }\n\n    if (powerAverages) {\n        summary += \"\\nPower Averages:\\n\";\n        if (powerAverages.fiveSecond) summary += `5-second: ${powerAverages.fiveSecond.toFixed(1)} W\\n`;\n        if (powerAverages.thirtySecond) summary += `30-second: ${powerAverages.thirtySecond.toFixed(1)} W\\n`;\n        if (powerAverages.oneMinute) summary += `1-minute: ${powerAverages.oneMinute.toFixed(1)} W\\n`;\n        if (powerAverages.fiveMinute) summary += `5-minute: ${powerAverages.fiveMinute.toFixed(1)} W\\n`;\n    }\n\n    return summary + \"\\n\\nDetailed Data\\n\\n\";\n}\n\n/**\n * Generate table data for Google Docs\n * @param {Array} powerData - Array of power data points\n * @returns {Array<Array>} 2D array representing table data\n */\nfunction generateDocumentTable(powerData) {\n    const table = [\n        ['Time', 'Power (W)', 'Heart Rate (BPM)', 'Cadence (RPM)']\n    ];\n\n    powerData.slice(0, 50).forEach(point => { // Limit to first 50 points for document\n        const time = new Date(point.timestamp).toLocaleTimeString();\n        table.push([\n            time,\n            point.power || '--',\n            point.heartRate || '--',\n            point.cadence || '--'\n        ]);\n    });\n\n    if (powerData.length > 50) {\n        table.push(['...', '...', '...', '...']);\n        table.push([`${powerData.length} total data points`, '', '', '']);\n    }\n\n    return table;\n}\n\n/* ==========================================================================\n   Google Sheets Content Generation\n   ========================================================================== */\n\n/**\n * Generate data for Google Sheets\n * @param {Array} data - Array of data points\n * @param {string} type - Type of data ('summary' or 'raw')\n * @returns {Array<Array>} 2D array for Google Sheets\n */\nfunction generateSheetsData(data, type) {\n    if (type === 'summary') {\n        return generateSummarySheetData(data);\n    } else if (type === 'raw') {\n        return generateRawSheetData(data);\n    }\n    return [];\n}\n\n/**\n * Generate summary sheet data\n * @param {Array} powerData - Array of power data points\n * @returns {Array<Array>} 2D array for summary sheet\n */\nfunction generateSummarySheetData(powerData) {\n    const headers = ['Timestamp', 'Power (W)', 'Heart Rate (BPM)', 'Cadence (RPM)', 'Time (s)'];\n    const rows = [headers];\n\n    powerData.forEach((point, index) => {\n        const timestamp = new Date(point.timestamp).toISOString();\n        const timeSeconds = index; // Approximate time in seconds\n\n        rows.push([\n            timestamp,\n            point.power || '',\n            point.heartRate || '',\n            point.cadence || '',\n            timeSeconds\n        ]);\n    });\n\n    return rows;\n}\n\n/**\n * Generate raw measurements sheet data\n * @param {Array} rawMeasurements - Array of raw measurement data\n * @returns {Array<Array>} 2D array for raw measurements sheet\n */\nfunction generateRawSheetData(rawMeasurements) {\n    const headers = ['Timestamp', 'Flags', 'Data Length', 'Instantaneous Power', 'Raw Bytes'];\n    const rows = [headers];\n\n    rawMeasurements.forEach(measurement => {\n        const timestamp = new Date(measurement.timestamp).toISOString();\n\n        rows.push([\n            timestamp,\n            measurement.flags || '',\n            measurement.dataLength || '',\n            measurement.instantaneousPower || '',\n            measurement.rawBytes || ''\n        ]);\n    });\n\n    return rows;\n}\n\n/**\n * Apply formatting to Google Sheets\n * @async\n * @param {string} spreadsheetId - Spreadsheet ID\n * @returns {Promise<void>}\n */\nasync function formatGoogleSheet(spreadsheetId) {\n    try {\n        const requests = [\n            // Format headers\n            {\n                repeatCell: {\n                    range: {\n                        sheetId: 0,\n                        startRowIndex: 0,\n                        endRowIndex: 1\n                    },\n                    cell: {\n                        userEnteredFormat: {\n                            backgroundColor: { red: 0.9, green: 0.9, blue: 0.9 },\n                            textFormat: { bold: true }\n                        }\n                    },\n                    fields: 'userEnteredFormat(backgroundColor,textFormat)'\n                }\n            },\n            // Format headers for second sheet\n            {\n                repeatCell: {\n                    range: {\n                        sheetId: 1,\n                        startRowIndex: 0,\n                        endRowIndex: 1\n                    },\n                    cell: {\n                        userEnteredFormat: {\n                            backgroundColor: { red: 0.9, green: 0.9, blue: 0.9 },\n                            textFormat: { bold: true }\n                        }\n                    },\n                    fields: 'userEnteredFormat(backgroundColor,textFormat)'\n                }\n            },\n            // Auto-resize columns\n            {\n                autoResizeDimensions: {\n                    dimensions: {\n                        sheetId: 0,\n                        dimension: 'COLUMNS',\n                        startIndex: 0,\n                        endIndex: 5\n                    }\n                }\n            },\n            {\n                autoResizeDimensions: {\n                    dimensions: {\n                        sheetId: 1,\n                        dimension: 'COLUMNS',\n                        startIndex: 0,\n                        endIndex: 5\n                    }\n                }\n            }\n        ];\n\n        await window.gapi.client.sheets.spreadsheets.batchUpdate({\n            spreadsheetId: spreadsheetId,\n            resource: { requests }\n        });\n    } catch (error) {\n        console.warn('Failed to apply formatting to Google Sheet:', error);\n    }\n}\n\n/* ==========================================================================\n   Utility Functions for Cloud Exports\n   ========================================================================== */\n\n/**\n * Calculate session duration from power data\n * @param {Array} powerData - Array of power data points\n * @returns {number} Duration in milliseconds\n */\nfunction calculateSessionDuration(powerData) {\n    if (powerData.length < 2) return 0;\n\n    const firstTimestamp = new Date(powerData[0].timestamp).getTime();\n    const lastTimestamp = new Date(powerData[powerData.length - 1].timestamp).getTime();\n\n    return lastTimestamp - firstTimestamp;\n}\n\n/**\n * Calculate session statistics\n * @param {Array} powerData - Array of power data points\n * @returns {Object} Statistics object\n */\nfunction calculateSessionStats(powerData) {\n    if (powerData.length === 0) {\n        return {\n            avgPower: 0, maxPower: 0, minPower: 0,\n            avgHeartRate: 0, maxHeartRate: 0,\n            avgCadence: 0, maxCadence: 0\n        };\n    }\n\n    const powers = powerData.map(p => p.power || 0).filter(p => p > 0);\n    const heartRates = powerData.map(p => p.heartRate || 0).filter(hr => hr > 0);\n    const cadences = powerData.map(p => p.cadence || 0).filter(c => c > 0);\n\n    return {\n        avgPower: powers.length > 0 ? powers.reduce((a, b) => a + b, 0) / powers.length : 0,\n        maxPower: powers.length > 0 ? Math.max(...powers) : 0,\n        minPower: powers.length > 0 ? Math.min(...powers) : 0,\n        avgHeartRate: heartRates.length > 0 ? heartRates.reduce((a, b) => a + b, 0) / heartRates.length : 0,\n        maxHeartRate: heartRates.length > 0 ? Math.max(...heartRates) : 0,\n        avgCadence: cadences.length > 0 ? cadences.reduce((a, b) => a + b, 0) / cadences.length : 0,\n        maxCadence: cadences.length > 0 ? Math.max(...cadences) : 0\n    };\n}\n\n/**\n * Format duration in a human-readable format\n * @param {number} duration - Duration in milliseconds\n * @returns {string} Formatted duration string\n */\nfunction formatDuration(duration) {\n    const seconds = Math.floor(duration / 1000);\n    const minutes = Math.floor(seconds / 60);\n    const hours = Math.floor(minutes / 60);\n\n    if (hours > 0) {\n        return `${hours}h ${minutes % 60}m ${seconds % 60}s`;\n    } else if (minutes > 0) {\n        return `${minutes}m ${seconds % 60}s`;\n    } else {\n        return `${seconds}s`;\n    }\n}\n\n/**\n * Show Google API configuration modal\n */\nexport function showGoogleApiConfigModal() {\n    // Create modal backdrop\n    const backdrop = document.createElement('div');\n    backdrop.className = 'modal-backdrop';\n    backdrop.style.cssText = `\n        position: fixed;\n        top: 0;\n        left: 0;\n        width: 100%;\n        height: 100%;\n        background: rgba(0, 0, 0, 0.8);\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        z-index: 10000;\n    `;\n\n    // Create modal dialog\n    const modal = document.createElement('div');\n    modal.className = 'config-modal';\n    modal.style.cssText = `\n        background: linear-gradient(135deg, #2a2a2a 0%, #1e1e1e 100%);\n        border-radius: 12px;\n        padding: 2rem;\n        max-width: 500px;\n        width: 90%;\n        color: white;\n        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);\n        border: 1px solid rgba(255, 255, 255, 0.1);\n    `;\n\n    // Get current values\n    const currentClientId = localStorage.getItem('google_client_id') || '';\n    const currentApiKey = localStorage.getItem('google_api_key') || '';\n\n    modal.innerHTML = `\n        <h3 style=\"margin: 0 0 1.5rem 0; color: #4CAF50;\">Google API Configuration</h3>\n        <p style=\"margin-bottom: 1.5rem; color: #ccc; line-height: 1.5;\">\n            To enable cloud exports, you need to configure Google API credentials. \n            <a href=\"https://console.developers.google.com/\" target=\"_blank\" style=\"color: #4CAF50;\">\n                Get credentials from Google Cloud Console\n            </a>\n        </p>\n        \n        <div style=\"margin-bottom: 1.5rem;\">\n            <label style=\"display: block; margin-bottom: 0.5rem; color: #ddd; font-weight: 500;\">\n                Google Client ID:\n            </label>\n            <input type=\"text\" id=\"clientIdInput\" value=\"${currentClientId}\" \n                   style=\"width: 100%; padding: 0.75rem; border: 1px solid #555; border-radius: 6px; \n                          background: #333; color: white; font-size: 0.9rem;\" \n                   placeholder=\"your-client-id.googleusercontent.com\">\n        </div>\n        \n        <div style=\"margin-bottom: 2rem;\">\n            <label style=\"display: block; margin-bottom: 0.5rem; color: #ddd; font-weight: 500;\">\n                Google API Key:\n            </label>\n            <input type=\"text\" id=\"apiKeyInput\" value=\"${currentApiKey}\" \n                   style=\"width: 100%; padding: 0.75rem; border: 1px solid #555; border-radius: 6px; \n                          background: #333; color: white; font-size: 0.9rem;\" \n                   placeholder=\"your-api-key\">\n        </div>\n        \n        <div style=\"display: flex; gap: 1rem; justify-content: flex-end;\">\n            <button id=\"cancelConfig\" style=\"padding: 0.75rem 1.5rem; border: 1px solid #666; \n                                           background: transparent; color: white; border-radius: 6px; \n                                           cursor: pointer; transition: all 0.3s ease;\">\n                Cancel\n            </button>\n            <button id=\"saveConfig\" style=\"padding: 0.75rem 1.5rem; border: none; \n                                         background: linear-gradient(135deg, #4CAF50 0%, #388E3C 100%); \n                                         color: white; border-radius: 6px; cursor: pointer; \n                                         transition: all 0.3s ease; font-weight: 500;\">\n                Save & Reload\n            </button>\n        </div>\n    `;\n\n    backdrop.appendChild(modal);\n    document.body.appendChild(backdrop);\n\n    // Handle button clicks\n    modal.querySelector('#cancelConfig').addEventListener('click', () => {\n        document.body.removeChild(backdrop);\n    });\n\n    modal.querySelector('#saveConfig').addEventListener('click', () => {\n        const clientId = modal.querySelector('#clientIdInput').value.trim();\n        const apiKey = modal.querySelector('#apiKeyInput').value.trim();\n\n        if (clientId && apiKey) {\n            localStorage.setItem('google_client_id', clientId);\n            localStorage.setItem('google_api_key', apiKey);\n            document.body.removeChild(backdrop);\n\n            // Show success message and reload\n            alert('Google API credentials saved successfully! The page will reload to apply changes.');\n            window.location.reload();\n        } else {\n            alert('Please enter both Client ID and API Key.');\n        }\n    });\n\n    // Handle backdrop click\n    backdrop.addEventListener('click', (e) => {\n        if (e.target === backdrop) {\n            document.body.removeChild(backdrop);\n        }\n    });\n\n    // Focus on first input\n    setTimeout(() => {\n        modal.querySelector('#clientIdInput').focus();\n    }, 100);\n}\n\n/**\n * Show intervals.icu configuration modal\n */\nexport function showIntervalsConfigModal() {\n    // Create modal backdrop\n    const backdrop = document.createElement('div');\n    backdrop.className = 'modal-backdrop';\n    backdrop.style.cssText = `\n        position: fixed;\n        top: 0;\n        left: 0;\n        width: 100%;\n        height: 100%;\n        background: rgba(0, 0, 0, 0.8);\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        z-index: 10000;\n    `;\n\n    // Create modal dialog\n    const modal = document.createElement('div');\n    modal.className = 'config-modal';\n    modal.style.cssText = `\n        background: linear-gradient(135deg, #2a2a2a 0%, #1e1e1e 100%);\n        border-radius: 12px;\n        padding: 2rem;\n        max-width: 500px;\n        width: 90%;\n        color: white;\n        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);\n        border: 1px solid rgba(255, 255, 255, 0.1);\n    `;\n\n    // Get current values\n    const currentApiKey = localStorage.getItem('intervals_api_key') || '';\n    const currentAthleteId = localStorage.getItem('intervals_athlete_id') || '';\n\n    modal.innerHTML = `\n        <h3 style=\"margin: 0 0 1.5rem 0; color: #FF6B35;\">intervals.icu Configuration</h3>\n        <p style=\"margin-bottom: 1.5rem; color: #ccc; line-height: 1.5;\">\n            Configure your intervals.icu credentials to export activities directly. \n            <a href=\"https://intervals.icu/settings\" target=\"_blank\" style=\"color: #FF6B35;\">\n                Get your API key from intervals.icu settings\n            </a>\n        </p>\n        \n        <div style=\"margin-bottom: 1.5rem;\">\n            <label style=\"display: block; margin-bottom: 0.5rem; color: #ddd; font-weight: 500;\">\n                API Key:\n            </label>\n            <input type=\"text\" id=\"intervalsApiKeyInput\" value=\"${currentApiKey}\" \n                   style=\"width: 100%; padding: 0.75rem; border: 1px solid #555; border-radius: 6px; \n                          background: #333; color: white; font-size: 0.9rem;\" \n                   placeholder=\"your-intervals-api-key\">\n            <small style=\"color: #aaa; font-size: 0.8rem;\">\n                Found in intervals.icu → Settings → Developer\n            </small>\n        </div>\n        \n        <div style=\"margin-bottom: 2rem;\">\n            <label style=\"display: block; margin-bottom: 0.5rem; color: #ddd; font-weight: 500;\">\n                Athlete ID:\n            </label>\n            <input type=\"text\" id=\"intervalsAthleteIdInput\" value=\"${currentAthleteId}\" \n                   style=\"width: 100%; padding: 0.75rem; border: 1px solid #555; border-radius: 6px; \n                          background: #333; color: white; font-size: 0.9rem;\" \n                   placeholder=\"i123456\">\n            <small style=\"color: #aaa; font-size: 0.8rem;\">\n                Your athlete ID (usually starts with 'i' followed by numbers)\n            </small>\n        </div>\n        \n        <div style=\"display: flex; gap: 1rem; justify-content: flex-end;\">\n            <button id=\"cancelIntervalsConfig\" style=\"padding: 0.75rem 1.5rem; border: 1px solid #666; \n                                                    background: transparent; color: white; border-radius: 6px; \n                                                    cursor: pointer; transition: all 0.3s ease;\">\n                Cancel\n            </button>\n            <button id=\"saveIntervalsConfig\" style=\"padding: 0.75rem 1.5rem; border: none; \n                                                   background: linear-gradient(135deg, #FF6B35 0%, #E55A2B 100%); \n                                                   color: white; border-radius: 6px; cursor: pointer; \n                                                   transition: all 0.3s ease; font-weight: 500;\">\n                Save & Test\n            </button>\n        </div>\n    `;\n\n    backdrop.appendChild(modal);\n    document.body.appendChild(backdrop);\n\n    // Handle button clicks\n    modal.querySelector('#cancelIntervalsConfig').addEventListener('click', () => {\n        document.body.removeChild(backdrop);\n    });\n\n    modal.querySelector('#saveIntervalsConfig').addEventListener('click', async () => {\n        const apiKey = modal.querySelector('#intervalsApiKeyInput').value.trim();\n        const athleteId = modal.querySelector('#intervalsAthleteIdInput').value.trim();\n\n        if (apiKey && athleteId) {\n            try {\n                // Test the configuration\n                const testResult = await testIntervalsConnection(apiKey, athleteId);\n\n                if (testResult.success) {\n                    localStorage.setItem('intervals_api_key', apiKey);\n                    localStorage.setItem('intervals_athlete_id', athleteId);\n                    initializeIntervalsConfig(apiKey, athleteId);\n\n                    document.body.removeChild(backdrop);\n                    alert(`intervals.icu configured successfully!\\\\nAthlete: ${testResult.athleteName || athleteId}`);\n                } else {\n                    alert(`Configuration test failed: ${testResult.error}`);\n                }\n            } catch (error) {\n                alert(`Error testing configuration: ${error.message}`);\n            }\n        } else {\n            alert('Please enter both API Key and Athlete ID.');\n        }\n    });\n\n    // Handle backdrop click\n    backdrop.addEventListener('click', (e) => {\n        if (e.target === backdrop) {\n            document.body.removeChild(backdrop);\n        }\n    });\n\n    // Focus on first input\n    setTimeout(() => {\n        modal.querySelector('#intervalsApiKeyInput').focus();\n    }, 100);\n}\n\n/**\n * Test intervals.icu connection with provided credentials\n * @async\n * @param {string} apiKey - intervals.icu API key\n * @param {string} athleteId - intervals.icu athlete ID\n * @returns {Promise<Object>} Test result object\n */\nasync function testIntervalsConnection(apiKey, athleteId) {\n    try {\n        const response = await fetch(`${INTERVALS_CONFIG.BASE_URL}/athlete/${athleteId}`, {\n            method: 'GET',\n            headers: {\n                'Authorization': `Basic ${btoa(`API_KEY:${apiKey}`)}`\n            }\n        });\n\n        if (!response.ok) {\n            const errorText = await response.text();\n            return {\n                success: false,\n                error: `API error: ${response.status} - ${errorText}`\n            };\n        }\n\n        const athleteData = await response.json();\n        return {\n            success: true,\n            athleteName: athleteData.name || athleteData.username,\n            athleteData\n        };\n    } catch (error) {\n        return {\n            success: false,\n            error: error.message\n        };\n    }\n}","\n// TCX Generation Functions\n/**\n * Creates a trackpoint XML element for a single data point\n * @param {Object} dataPoint - Data point with time, power, heartRate, cadence\n * @returns {string} XML trackpoint string\n */\nfunction createTrackpoint(dataPoint) {\n    const translations = {\n        time: (time) => `<Time>${new Date(time).toISOString()}</Time>`,\n        heartRate: (hr) =>\n            `\n<HeartRateBpm>\n  <Value>${hr}</Value>\n</HeartRateBpm>\n            `.trim(),\n        cadence: (cad) => `<Cadence>${cad}</Cadence>`,\n        power: (pw) =>\n            `\n<Extensions>\n  <ns2:TPX>\n    <ns2:Watts>${pw}</ns2:Watts>\n  </ns2:TPX>\n</Extensions>\n            `.trim(),\n    };\n    const contents = Object.keys(translations)\n        .map((key) => {\n            if (dataPoint[key] === undefined) return '';\n            return translations[key](dataPoint[key]);\n        })\n        .filter((x) => x)\n        .join('\\n');\n\n    return `\n<Trackpoint>\n  ${contents}\n</Trackpoint>\n`.trim();\n}\n\n/**\n * Generates TCX XML string from power data for cycling activities\n * @param {Array<Object>} powerData - Array of power measurement objects\n * @returns {string} Complete TCX XML string\n */\nfunction generateTcxString(powerData) {\n    // Validate input data\n    if (!Array.isArray(powerData) || powerData.length === 0) {\n        return '';\n    }\n\n    // Filter and normalize data\n    const validDataPoints = powerData.filter(\n        (dataPoint) =>\n            dataPoint &&\n            typeof dataPoint === 'object' &&\n            dataPoint.timestamp !== undefined &&\n            !isNaN(new Date(dataPoint.timestamp).getTime())\n    );\n\n    if (validDataPoints.length === 0) {\n        return '';\n    }\n\n    // Transform data\n    const normalizeDataPoint = (item) => ({\n        time: item.timestamp,\n        ...(item.power !== undefined && { power: item.power }),\n        ...(item.heartRate !== undefined && { heartRate: item.heartRate }),\n        ...(item.cadence !== undefined && { cadence: item.cadence }),\n    });\n\n    // Process data\n    let processedData = validDataPoints.map(normalizeDataPoint).sort((a, b) => a.time - b.time);\n\n    // Remove leading/trailing entries without power\n    const isEmptyPower = (dataPoint) => !dataPoint.power || dataPoint.power <= 0;\n    while (processedData.length > 0 && isEmptyPower(processedData[0])) {\n        processedData.shift();\n    }\n    while (processedData.length > 0 && isEmptyPower(processedData[processedData.length - 1])) {\n        processedData.pop();\n    }\n\n    if (processedData.length === 0) {\n        return '';\n    }\n\n    // Generate XML\n    const trackpoints = processedData.map(createTrackpoint).join('\\n');\n    const startTime = processedData[0].time;\n    const startTimeISO = new Date(startTime).toISOString();\n\n    const rawXml = `<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<TrainingCenterDatabase\n  xmlns=\"http://www.garmin.com/xmlschemas/TrainingCenterDatabase/v2\"\n  xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n  xsi:schemaLocation=\"http://www.garmin.com/xmlschemas/TrainingCenterDatabase/v2 http://www.garmin.com/xmlschemas/TrainingCenterDatabasev2.xsd\"\n  xmlns:ns2=\"http://www.garmin.com/xmlschemas/ActivityExtension/v2\">\n  <Activities>\n    <Activity Sport=\"Biking\">\n      <Id>${startTimeISO}</Id>\n      <Name>E Bike Indoor Cycling Trainer</Name>\n      <Lap StartTime=\"${startTimeISO}\">\n        <Track>\n        ${trackpoints}\n        </Track>\n      </Lap>\n    </Activity>\n  </Activities>\n</TrainingCenterDatabase>`;\n\n    return rawXml;\n}\n\nexport { generateTcxString };","// Summary Image Generation Functions\n/**\n * Generates a comprehensive summary        const averagesData = [\n            { label: '10s', data: powerAverages['10s'] },\n            { label: '20s', data: powerAverages['20s'] },\n            { label: '30s', data: powerAverages['30s'] },\n            { label: '40s', data: powerAverages['40s'] },\n            { label: '50s', data: powerAverages['50s'] },\n            { label: '1m', data: powerAverages['1m'] },\n            { label: '2m', data: powerAverages['2m'] },\n            { label: '3m', data: powerAverages['3m'] },\n            { label: '4m', data: powerAverages['4m'] },\n            { label: '5m', data: powerAverages['5m'] },\n        ];ith power averages and timeline charts\n * @returns {Promise<HTMLCanvasElement>} Canvas containing the summary image\n */\nasync function generateSummaryImage({ dataPoints, powerAverages }) {\n    const hrDataPoints = dataPoints.filter((d) => d.heartRate !== undefined);\n    const cadenceDataPoints = dataPoints.filter((d) => d.cadence !== undefined);\n    const powerDataPoints = dataPoints.filter((d) => d.power !== undefined);\n\n    const canvas = document.createElement('canvas');\n    const ctx = canvas.getContext('2d');\n\n    // Calculate required height based on available data\n    let requiredHeight = 200; // Base height for title and headers\n\n    // Add height for power averages if available\n    if (Object.values(powerAverages).some((avg) => avg.current > 0 || avg.best > 0)) {\n        requiredHeight += 200;\n    }\n\n    // Add height for heart rate statistics if available\n    if (hrDataPoints.length > 0 && hrDataPoints.some(d => d.heartRate > 0)) {\n        requiredHeight += 140;\n    }\n\n    // Add height for cadence statistics if available\n    if (cadenceDataPoints.length > 0 && cadenceDataPoints.some(d => d.cadence > 0)) {\n        requiredHeight += 140;\n    }\n\n    // Add height for each chart\n    const singleChartHeight = 350;\n    if (powerDataPoints.length > 0) requiredHeight += singleChartHeight;\n    if (hrDataPoints.length > 0) requiredHeight += singleChartHeight;\n    if (cadenceDataPoints.length > 0) requiredHeight += singleChartHeight;\n\n    // Set canvas size for high resolution export\n    const width = 1200;\n    const height = Math.max(600, requiredHeight);\n    canvas.width = width;\n    canvas.height = height;\n\n    // Set background\n    ctx.fillStyle = '#1a1a2e';\n    ctx.fillRect(0, 0, width, height);\n\n    // Title\n    ctx.fillStyle = '#ffffff';\n    ctx.font = 'bold 36px Arial, sans-serif';\n    ctx.textAlign = 'center';\n    ctx.fillText('Power Meter Summary', width / 2, 50);\n\n    // Date and time\n    ctx.font = '18px Arial, sans-serif';\n    ctx.fillStyle = '#cccccc';\n    const now = new Date();\n    ctx.fillText(now.toLocaleDateString() + ' ' + now.toLocaleTimeString(), width / 2, 80);\n\n    // Session duration\n    if (powerDataPoints.length > 0) {\n        const sessionEnd = powerDataPoints[powerDataPoints.length - 1].timestamp;\n        const sessionStart = powerDataPoints[0].timestamp;\n        const sessionSeconds = Math.round((sessionEnd - sessionStart) / 1000);\n        const durationMinutes = Math.round(sessionSeconds / 60); // minutes\n        ctx.fillText(`Session Duration: ${durationMinutes} minutes`, width / 2, 105);\n    }\n\n    let yOffset = 130;\n\n    // Power Averages Section\n    if (Object.values(powerAverages).some((avg) => avg.current > 0 || avg.best > 0)) {\n        ctx.fillStyle = '#ffffff';\n        ctx.font = 'bold 24px Arial, sans-serif';\n        ctx.textAlign = 'left';\n        ctx.fillText('Power Averages', 50, yOffset);\n        yOffset += 40;\n\n        const avgData = [\n            { label: '10s', data: powerAverages['10s'] },\n            { label: '30s', data: powerAverages['30s'] },\n            { label: '1m', data: powerAverages['1m'] },\n            { label: '2m', data: powerAverages['2m'] },\n            { label: '4m', data: powerAverages['4m'] },\n            { label: '8m', data: powerAverages['8m'] },\n        ];\n\n        // Draw power averages table\n        ctx.font = '16px Arial, sans-serif';\n        ctx.fillStyle = '#cccccc';\n        ctx.fillText('Duration', 70, yOffset);\n        ctx.fillText('Best', 220, yOffset);\n        ctx.fillText('Duration', 470, yOffset);\n        ctx.fillText('Best', 620, yOffset);\n        yOffset += 30;\n\n        // Draw averages in two columns\n        for (let i = 0; i < avgData.length; i++) {\n            const avg = avgData[i];\n            const xBase = i < 3 ? 70 : 470;\n            const row = i < 3 ? i : i - 3;\n            const y = yOffset + row * 25;\n\n            ctx.fillStyle = '#ffffff';\n            ctx.fillText(avg.label, xBase, y);\n            ctx.fillStyle = avg.data.best > 0 ? '#e74c3c' : '#666666';\n            ctx.fillText(avg.data.best + 'W', xBase + 150, y);\n        }\n\n        yOffset += 100;\n    }\n\n    // Heart Rate Statistics Section\n    if (hrDataPoints.length > 0) {\n        const heartRates = hrDataPoints.map(d => d.heartRate).filter(hr => hr > 0);\n        if (heartRates.length > 0) {\n            ctx.fillStyle = '#ffffff';\n            ctx.font = 'bold 24px Arial, sans-serif';\n            ctx.textAlign = 'left';\n            ctx.fillText('Heart Rate Statistics', 50, yOffset);\n            yOffset += 40;\n\n            const maxHR = Math.max(...heartRates);\n            const minHR = Math.min(...heartRates);\n            const avgHR = Math.round(heartRates.reduce((a, b) => a + b, 0) / heartRates.length);\n\n            ctx.font = '16px Arial, sans-serif';\n            ctx.fillStyle = '#cccccc';\n            ctx.fillText('Average:', 70, yOffset);\n            ctx.fillStyle = '#e74c3c';\n            ctx.fillText(`${avgHR} BPM`, 200, yOffset);\n            yOffset += 25;\n\n            ctx.fillStyle = '#cccccc';\n            ctx.fillText('Maximum:', 70, yOffset);\n            ctx.fillStyle = '#e74c3c';\n            ctx.fillText(`${maxHR} BPM`, 200, yOffset);\n            yOffset += 25;\n\n            ctx.fillStyle = '#cccccc';\n            ctx.fillText('Minimum:', 70, yOffset);\n            ctx.fillStyle = '#e74c3c';\n            ctx.fillText(`${minHR} BPM`, 200, yOffset);\n            yOffset += 40;\n        }\n    }\n\n    // Cadence Statistics Section\n    if (cadenceDataPoints.length > 0) {\n        const clampCadence = (cad) => Math.max(0, Math.min(200, cad));\n        const cadences = cadenceDataPoints.map(d => d.cadence).filter(cad => cad > 0).map(clampCadence);\n        if (cadences.length > 0) {\n            ctx.fillStyle = '#ffffff';\n            ctx.font = 'bold 24px Arial, sans-serif';\n            ctx.textAlign = 'left';\n            ctx.fillText('Cadence Statistics', 50, yOffset);\n            yOffset += 40;\n\n            const maxCadence = Math.max(...cadences);\n            const minCadence = Math.min(...cadences);\n            const avgCadence = Math.round(cadences.reduce((a, b) => a + b, 0) / cadences.length);\n\n            ctx.font = '16px Arial, sans-serif';\n            ctx.fillStyle = '#cccccc';\n            ctx.fillText('Average:', 70, yOffset);\n            ctx.fillStyle = '#f39c12';\n            ctx.fillText(`${avgCadence} RPM`, 200, yOffset);\n            yOffset += 25;\n\n            ctx.fillStyle = '#cccccc';\n            ctx.fillText('Maximum:', 70, yOffset);\n            ctx.fillStyle = '#f39c12';\n            ctx.fillText(`${maxCadence} RPM`, 200, yOffset);\n            yOffset += 25;\n\n            ctx.fillStyle = '#cccccc';\n            ctx.fillText('Minimum:', 70, yOffset);\n            ctx.fillStyle = '#f39c12';\n            ctx.fillText(`${minCadence} RPM`, 200, yOffset);\n            yOffset += 40;\n        }\n    }\n\n    // If no data is available, show a message\n    const hasData = powerDataPoints.length > 0 || hrDataPoints.length > 0 || cadenceDataPoints.length > 0;\n    if (!hasData) {\n        ctx.fillStyle = '#cccccc';\n        ctx.font = '24px Arial, sans-serif';\n        ctx.textAlign = 'center';\n        ctx.fillText('No data recorded yet', width / 2, height / 2);\n        ctx.font = '16px Arial, sans-serif';\n        ctx.fillText('Start recording to see your activity summary', width / 2, height / 2 + 40);\n        return canvas;\n    }\n\n    // Charts section\n    const chartHeight = 300;\n    const chartWidth = width - 100;\n    const chartStartX = 50;\n\n    // Power Chart\n    if (powerDataPoints.length > 0) {\n        yOffset += 20;\n        ctx.fillStyle = '#ffffff';\n        ctx.font = 'bold 20px Arial, sans-serif';\n        ctx.fillText('Power Timeline', chartStartX, yOffset);\n        yOffset += 30;\n\n        drawTimelineChart(\n            ctx,\n            powerDataPoints,\n            'power',\n            chartStartX,\n            yOffset,\n            chartWidth,\n            chartHeight,\n            '#3498db',\n            'W'\n        );\n        yOffset += chartHeight + 50;\n    }\n\n    // Heart Rate Chart\n    if (hrDataPoints.length > 0) {\n        ctx.fillStyle = '#ffffff';\n        ctx.font = 'bold 20px Arial, sans-serif';\n        ctx.fillText('Heart Rate Timeline', chartStartX, yOffset);\n        yOffset += 30;\n\n        drawTimelineChart(\n            ctx,\n            hrDataPoints,\n            'heartRate',\n            chartStartX,\n            yOffset,\n            chartWidth,\n            chartHeight,\n            '#e74c3c',\n            'BPM'\n        );\n        yOffset += chartHeight + 50;\n    }\n\n    // Cadence Chart\n    if (cadenceDataPoints.length > 0) {\n        ctx.fillStyle = '#ffffff';\n        ctx.font = 'bold 20px Arial, sans-serif';\n        ctx.fillText('Cadence Timeline', chartStartX, yOffset);\n        yOffset += 30;\n\n        drawTimelineChart(\n            ctx,\n            cadenceDataPoints,\n            'cadence',\n            chartStartX,\n            yOffset,\n            chartWidth,\n            chartHeight,\n            '#f39c12',\n            'RPM'\n        );\n        yOffset += chartHeight + 50;\n    }\n\n    return canvas;\n}\n\n/**\n * Draws a timeline chart for the given data\n */\nfunction drawTimelineChart(ctx, data, valueKey, x, y, width, height, color, unit) {\n    if (data.length === 0) return;\n\n    // Draw chart background\n    ctx.fillStyle = 'rgba(255, 255, 255, 0.05)';\n    ctx.fillRect(x, y, width, height);\n\n    // Draw border\n    ctx.strokeStyle = 'rgba(255, 255, 255, 0.2)';\n    ctx.lineWidth = 1;\n    ctx.strokeRect(x, y, width, height);\n\n    // Find min/max values for scaling\n    const values = data.map((d) => d[valueKey]).filter((v) => v > 0);\n    if (values.length === 0) return;\n\n    const minValue = Math.min(...values);\n    const maxValue = Math.max(...values);\n    const range = maxValue - minValue || 1;\n\n    // Draw Y-axis labels\n    ctx.fillStyle = '#cccccc';\n    ctx.font = '12px Arial, sans-serif';\n    ctx.textAlign = 'right';\n\n    for (let i = 0; i <= 4; i++) {\n        const value = Math.round(minValue + (range * i) / 4);\n        const labelY = y + height - (height * i) / 4;\n        ctx.fillText(value + unit, x - 10, labelY + 4);\n    }\n\n    // Draw chart line\n    ctx.strokeStyle = color;\n    ctx.lineWidth = 2;\n    ctx.beginPath();\n\n    let firstPoint = true;\n    for (let i = 0; i < data.length; i++) {\n        const point = data[i];\n        const value = point[valueKey];\n\n        if (value > 0) {\n            const chartX = x + (i / (data.length - 1)) * width;\n            const chartY = y + height - ((value - minValue) / range) * height;\n\n            if (firstPoint) {\n                ctx.moveTo(chartX, chartY);\n                firstPoint = false;\n            } else {\n                ctx.lineTo(chartX, chartY);\n            }\n        }\n    }\n\n    ctx.stroke();\n\n    // Draw data points\n    ctx.fillStyle = color;\n    for (let i = 0; i < data.length; i += Math.max(1, Math.floor(data.length / 50))) {\n        const point = data[i];\n        const value = point[valueKey];\n\n        if (value > 0) {\n            const chartX = x + (i / (data.length - 1)) * width;\n            const chartY = y + height - ((value - minValue) / range) * height;\n\n            ctx.beginPath();\n            ctx.arc(chartX, chartY, 3, 0, 2 * Math.PI);\n            ctx.fill();\n        }\n    }\n\n    // Draw grid lines\n    ctx.strokeStyle = 'rgba(255, 255, 255, 0.1)';\n    ctx.lineWidth = 1;\n\n    // Horizontal grid lines\n    for (let i = 1; i < 4; i++) {\n        const gridY = y + (height * i) / 4;\n        ctx.beginPath();\n        ctx.moveTo(x, gridY);\n        ctx.lineTo(x + width, gridY);\n        ctx.stroke();\n    }\n\n    // Add time axis labels\n    if (data.length > 1) {\n        ctx.fillStyle = '#cccccc';\n        ctx.font = '12px Arial, sans-serif';\n        ctx.textAlign = 'center';\n\n        const startTime = new Date(data[0].timestamp);\n        const endTime = new Date(data[data.length - 1].timestamp);\n\n        // Start time\n        ctx.fillText(startTime.toLocaleTimeString(), x, y + height + 20);\n\n        // End time\n        ctx.fillText(endTime.toLocaleTimeString(), x + width, y + height + 20);\n\n        // Middle time if session is long enough\n        if (data.length > 10) {\n            const middleTime = new Date(data[Math.floor(data.length / 2)].timestamp);\n            ctx.fillText(middleTime.toLocaleTimeString(), x + width / 2, y + height + 20);\n        }\n    }\n\n    // Add min/max annotations\n    ctx.fillStyle = '#ffffff';\n    ctx.font = '12px Arial, sans-serif';\n    ctx.textAlign = 'left';\n    ctx.fillText(`Max: ${maxValue}${unit}`, x + 10, y + 20);\n    ctx.fillText(`Min: ${minValue}${unit}`, x + 10, y + 35);\n    ctx.fillText(\n        `Avg: ${Math.round(values.reduce((a, b) => a + b, 0) / values.length)}${unit}`,\n        x + 10,\n        y + 50\n    );\n}\n\nexport { generateSummaryImage };","/**\n * Notification System Module\n * Handles displaying temporary notifications to the user\n */\n\n/**\n * Show a notification that the session was restored\n * @param {number} dataPointCount - Number of data points recovered\n */\nexport function showSessionRestoredNotification(dataPointCount) {\n    const notification = document.createElement('div');\n    notification.style.cssText = `\n    position: fixed;\n    top: 20px;\n    right: 20px;\n    background: #4CAF50;\n    color: white;\n    padding: 1rem 1.5rem;\n    border-radius: 8px;\n    z-index: 1000;\n    font-size: 0.9rem;\n    box-shadow: 0 4px 12px rgba(0,0,0,0.3);\n    animation: slideIn 0.3s ease-out;\n  `;\n    notification.textContent = `Session restored! ${dataPointCount} data points recovered.`;\n\n    // Add animation\n    const style = document.createElement('style');\n    style.textContent = `\n    @keyframes slideIn {\n      from { transform: translateX(100%); opacity: 0; }\n      to { transform: translateX(0); opacity: 1; }\n    }\n  `;\n    document.head.appendChild(style);\n\n    document.body.appendChild(notification);\n\n    // Remove notification after 5 seconds\n    setTimeout(() => {\n        notification.style.animation = 'slideIn 0.3s ease-out reverse';\n        setTimeout(() => {\n            if (notification.parentNode) {\n                notification.parentNode.removeChild(notification);\n            }\n            if (style.parentNode) {\n                style.parentNode.removeChild(style);\n            }\n        }, 300);\n    }, 5000);\n}\n\n/**\n * Show a generic notification with custom message and type\n * @param {string} message - The message to display\n * @param {string} type - The type of notification ('success', 'error', 'info', 'warning')\n * @param {number} duration - Duration in milliseconds to show the notification\n */\nexport function showNotification(message, type = 'info', duration = 5000) {\n    const colorMap = {\n        success: '#4CAF50',\n        error: '#f44336',\n        warning: '#ff9800',\n        info: '#2196F3'\n    };\n\n    const notification = document.createElement('div');\n    notification.style.cssText = `\n    position: fixed;\n    top: 20px;\n    right: 20px;\n    background: ${colorMap[type] || colorMap.info};\n    color: white;\n    padding: 1rem 1.5rem;\n    border-radius: 8px;\n    z-index: 1000;\n    font-size: 0.9rem;\n    box-shadow: 0 4px 12px rgba(0,0,0,0.3);\n    animation: slideIn 0.3s ease-out;\n    max-width: 300px;\n    word-wrap: break-word;\n  `;\n    notification.textContent = message;\n\n    // Add animation if not already added\n    if (!document.getElementById('notification-styles')) {\n        const style = document.createElement('style');\n        style.id = 'notification-styles';\n        style.textContent = `\n      @keyframes slideIn {\n        from { transform: translateX(100%); opacity: 0; }\n        to { transform: translateX(0); opacity: 1; }\n      }\n    `;\n        document.head.appendChild(style);\n    }\n\n    document.body.appendChild(notification);\n\n    // Remove notification after specified duration\n    setTimeout(() => {\n        notification.style.animation = 'slideIn 0.3s ease-out reverse';\n        setTimeout(() => {\n            if (notification.parentNode) {\n                notification.parentNode.removeChild(notification);\n            }\n        }, 300);\n    }, duration);\n}","/**\n * UI Event Handlers Module\n * Handles all UI event listeners for toggles, menus, and interactions\n */\n\nimport { showAppInfo } from './app-info-modal.js';\nimport { showQrCodeModal } from './qr-code-modal.js';\n\n/**\n * Setup hamburger menu functionality\n * @param {Object} elements - UI elements object\n */\nexport function setupHamburgerMenu(elements) {\n    if (!elements.hamburgerBtn || !elements.menuDropdown) {\n        console.error('Hamburger menu elements not found:', {\n            hamburgerBtn: !!elements.hamburgerBtn,\n            menuDropdown: !!elements.menuDropdown,\n        });\n        return;\n    }\n\n    // Hamburger menu functionality\n    elements.hamburgerBtn.addEventListener('click', function () {\n        const isActive = elements.menuDropdown.classList.contains('active');\n        if (isActive) {\n            elements.menuDropdown.classList.remove('active');\n        } else {\n            elements.menuDropdown.classList.add('active');\n        }\n    });\n\n    // Close menu when clicking outside\n    document.addEventListener('click', function (event) {\n        if (!event.target.closest('.hamburger-menu')) {\n            elements.menuDropdown.classList.remove('active');\n        }\n    });\n}\n\n/**\n * Setup power averages toggle functionality\n * @param {Object} elements - UI elements object\n */\nexport function setupPowerAveragesToggle(elements) {\n    if (!elements.powerAveragesToggle || !elements.powerAveragesSection) {\n        console.error('Power averages toggle elements not found:', {\n            powerAveragesToggle: !!elements.powerAveragesToggle,\n            powerAveragesSection: !!elements.powerAveragesSection,\n        });\n        return;\n    }\n\n    let powerAveragesVisible = true; // Start visible by default\n    elements.powerAveragesToggle.classList.add('active'); // Set initial active state\n    elements.powerAveragesToggle.addEventListener('click', function () {\n        powerAveragesVisible = !powerAveragesVisible;\n\n        if (powerAveragesVisible) {\n            elements.powerAveragesSection.style.display = 'block';\n            elements.powerAveragesToggle.classList.add('active');\n        } else {\n            elements.powerAveragesSection.style.display = 'none';\n            elements.powerAveragesToggle.classList.remove('active');\n        }\n        manageCollapsedSectionsLayout();\n    });\n}\n\n/**\n * Setup metric toggle functionality\n * @param {Object} elements - UI elements object\n */\nexport function setupMetricToggles(elements) {\n    // Power metric toggle\n    if (elements.powerMetricToggle && elements.powerCard) {\n        let powerMetricVisible = true; // Start visible by default\n        elements.powerMetricToggle.classList.add('active'); // Set initial active state\n\n        elements.powerMetricToggle.addEventListener('click', function () {\n            powerMetricVisible = !powerMetricVisible;\n\n            if (powerMetricVisible) {\n                elements.powerCard.style.display = 'block';\n                elements.powerMetricToggle.classList.add('active');\n            } else {\n                elements.powerCard.style.display = 'none';\n                elements.powerMetricToggle.classList.remove('active');\n            }\n        });\n    } else {\n        console.error('Power metric toggle elements not found');\n    }\n\n    // Heart rate metric toggle\n    if (elements.heartRateMetricToggle && elements.heartRateCard) {\n        let heartRateMetricVisible = true; // Start visible by default\n        elements.heartRateMetricToggle.classList.add('active'); // Set initial active state\n\n        elements.heartRateMetricToggle.addEventListener('click', function () {\n            heartRateMetricVisible = !heartRateMetricVisible;\n\n            if (heartRateMetricVisible) {\n                elements.heartRateCard.style.display = 'block';\n                elements.heartRateMetricToggle.classList.add('active');\n            } else {\n                elements.heartRateCard.style.display = 'none';\n                elements.heartRateMetricToggle.classList.remove('active');\n            }\n        });\n    } else {\n        console.error('Heart rate metric toggle elements not found');\n    }\n\n    // Cadence metric toggle\n    if (elements.cadenceMetricToggle && elements.cadenceCard) {\n        let cadenceMetricVisible = true; // Start visible by default\n        elements.cadenceMetricToggle.classList.add('active'); // Set initial active state\n\n        elements.cadenceMetricToggle.addEventListener('click', function () {\n            cadenceMetricVisible = !cadenceMetricVisible;\n\n            if (cadenceMetricVisible) {\n                elements.cadenceCard.style.display = 'block';\n                elements.cadenceMetricToggle.classList.add('active');\n            } else {\n                elements.cadenceCard.style.display = 'none';\n                elements.cadenceMetricToggle.classList.remove('active');\n            }\n        });\n    } else {\n        console.error('Cadence metric toggle elements not found');\n    }\n}\n\n\n\n/**\n * Setup spy mode toggle functionality\n * @param {Object} elements - UI elements object\n * @param {Function} disconnectSpyCallback - Callback to disconnect spy meter\n */\nexport function setupSpyModeToggle(elements, disconnectSpyCallback) {\n    if (!elements.spyModeToggle || !elements.spyModeSection) {\n        console.error('Spy mode toggle elements not found');\n        return;\n    }\n\n    let spyModeVisible = false; // Start hidden by default\n\n    elements.spyModeToggle.addEventListener('click', function () {\n        spyModeVisible = !spyModeVisible;\n\n        if (spyModeVisible) {\n            elements.spyModeSection.style.display = 'block';\n            elements.spyModeToggle.classList.add('active');\n            // Make sure instructions are visible when first enabling spy mode\n            if (elements.spyInstructionsElement) {\n                elements.spyInstructionsElement.style.display = 'block';\n            }\n        } else {\n            elements.spyModeSection.style.display = 'none';\n            elements.spyModeToggle.classList.remove('active');\n            // Disconnect spy device if connected\n            disconnectSpyCallback();\n            // Reset spy display elements\n            if (elements.spyValueElement) elements.spyValueElement.textContent = '--';\n            if (elements.spyStatusElement) elements.spyStatusElement.style.display = 'none';\n            if (elements.spyInstructionsElement) elements.spyInstructionsElement.style.display = 'block';\n        }\n    });\n}\n\n/**\n * Setup menu item functionality\n * @param {Object} elements - UI elements object\n */\nexport function setupMenuItems(elements) {\n    // Info functionality\n    if (elements.showInfoMenuItem) {\n        elements.showInfoMenuItem.addEventListener('click', function () {\n            showAppInfo();\n            // Close the menu after showing info\n            if (elements.menuDropdown) {\n                elements.menuDropdown.classList.remove('active');\n            }\n        });\n    } else {\n        console.error('Show info menu item not found');\n    }\n\n    // QR Code functionality\n    if (elements.showQrCodeMenuItem) {\n        elements.showQrCodeMenuItem.addEventListener('click', function () {\n            showQrCodeModal();\n            // Close the menu after showing QR code\n            if (elements.menuDropdown) {\n                elements.menuDropdown.classList.remove('active');\n            }\n        });\n    } else {\n        console.error('Show QR code menu item not found');\n    }\n}\n\n/**\n * Function to update dashboard layout based on visible sections\n */\nexport function updateDashboardLayout() {\n    const dashboard = document.querySelector('.dashboard');\n    const powerAveragesSection = document.getElementById('powerAveragesSection');\n    const powerAveragesHidden = powerAveragesSection && powerAveragesSection.style.display === 'none';\n\n    if (dashboard) {\n        if (powerAveragesHidden) {\n            dashboard.classList.add('maximized');\n        } else {\n            dashboard.classList.remove('maximized');\n        }\n    }\n\n    // Manage horizontal layout for collapsed sections (excluding bottom controls)\n    manageCollapsedSectionsLayout();\n}\n\n/**\n * Function to manage horizontal layout of collapsed sections\n */\nfunction manageCollapsedSectionsLayout() {\n    const dashboard = document.querySelector('.dashboard');\n\n    if (!dashboard) return;\n\n    // Only manage power averages section for collapsed layout -\n    // connect and export sections are now bottom controls and stay at bottom\n    // Note: collapsedSections logic simplified since only power averages section is managed now\n\n    // Remove any existing collapsed sections row\n    const existingRow = document.querySelector('.collapsed-sections-row');\n    if (existingRow) {\n        // Move sections back to their original positions\n        const sectionsInRow = existingRow.querySelectorAll('.power-averages-section');\n        sectionsInRow.forEach((section) => {\n            // Insert sections back after the dashboard\n            dashboard.parentNode.insertBefore(section, dashboard.nextSibling);\n        });\n        existingRow.remove();\n    }\n\n    // Power averages section doesn't need horizontal grouping since it's the only\n    // section that can be managed this way now\n    dashboard.classList.remove('has-collapsed-sections');\n}\n\n/**\n * Initialize all UI sections\n * @param {Object} elements - UI elements object\n */\nexport function initializeSections(elements) {\n    // Initialize power averages section as visible by default\n    if (elements.powerAveragesSection) {\n        elements.powerAveragesSection.style.display = 'block';\n    }\n\n    updateDashboardLayout();\n}","/**\n * Show application information and usage instructions\n */\nfunction showAppInfo() {\n    const modal = document.createElement('div');\n    modal.className = 'modal-backdrop';\n    modal.style.cssText = `\n        position: fixed;\n        top: 0;\n        left: 0;\n        width: 100%;\n        height: 100%;\n        background: rgba(0, 0, 0, 0.8);\n        display: flex;\n        justify-content: center;\n        align-items: center;\n        z-index: 1000;\n    `;\n\n    const modalContent = document.createElement('div');\n    modalContent.className = 'modal';\n    modalContent.style.cssText = `\n        background: #1a1a2e;\n        border-radius: 12px;\n        padding: 2rem;\n        max-width: 600px;\n        max-height: 80vh;\n        overflow-y: auto;\n        margin: 20px;\n        border: 1px solid rgba(255, 255, 255, 0.2);\n    `;\n\n    modalContent.innerHTML = `\n        <div style=\"text-align: center; margin-bottom: 1.5rem;\">\n            <h2 style=\"color: #3498db; margin: 0 0 0.5rem 0; font-size: 1.8rem;\">🚴 Web Bluetooth Power Meter</h2>\n            <p style=\"color: #cccccc; margin: 0; font-size: 1rem;\">Real-time cycling data analysis</p>\n        </div>\n\n        <div style=\"color: #ffffff; line-height: 1.6;\">\n            <h3 style=\"color: #f39c12; margin: 1.5rem 0 1rem 0;\">📱 What is this app?</h3>\n            <p style=\"margin-bottom: 1rem;\">\n                This is a web-based power meter application that connects to Bluetooth cycling devices \n                to provide real-time power, heart rate, and cadence data analysis. Perfect for indoor \n                training, data logging, and performance tracking.\n            </p>\n\n            <h3 style=\"color: #f39c12; margin: 1.5rem 0 1rem 0;\">🔗 How to connect devices:</h3>\n            <ol style=\"margin-bottom: 1rem; padding-left: 1.5rem;\">\n                <li><strong>Power Meter:</strong> Click \"Connect Power Meter\" and select your cycling power device</li>\n                <li><strong>Heart Rate:</strong> Click \"Connect Heart Rate\" to pair your HR monitor</li>\n                <li><strong>Cadence:</strong> Click \"Connect Cadence\" for speed/cadence sensors</li>\n            </ol>\n\n            <h3 style=\"color: #f39c12; margin: 1.5rem 0 1rem 0;\">📊 Features:</h3>\n            <ul style=\"margin-bottom: 1rem; padding-left: 1.5rem;\">\n                <li><strong>Real-time Metrics:</strong> Live power, heart rate, and cadence display</li>\n                <li><strong>Power Averages:</strong> 10s, 20s, 30s, 40s, 50s, 1m, 2m, 3m, 4m, and 5m rolling averages</li>\n                <li><strong>Data Export:</strong> JSON, CSV, TCX, and visual summary image formats</li>\n                <li><strong>Session Persistence:</strong> Data automatically saved and restored</li>\n                <li><strong>Custom Dashboard:</strong> Toggle metrics and sections via hamburger menu</li>\n            </ul>\n\n            <h3 style=\"color: #f39c12; margin: 1.5rem 0 1rem 0;\">⚙️ Using the hamburger menu:</h3>\n            <ul style=\"margin-bottom: 1rem; padding-left: 1.5rem;\">\n                <li><strong>Toggle Sections:</strong> Show/hide different parts of the interface</li>\n                <li><strong>Load Debug Data:</strong> Generate 1000 test data points for testing</li>\n                <li><strong>Customize View:</strong> Control which metrics are visible</li>\n            </ul>\n\n            <h3 style=\"color: #f39c12; margin: 1.5rem 0 1rem 0;\">🌐 Browser Support:</h3>\n            <p style=\"margin-bottom: 1rem;\">\n                Requires a browser with Web Bluetooth support:\n                <br>• Chrome 56+ • Edge 79+ • Opera 43+\n            </p>\n\n            <h3 style=\"color: #f39c12; margin: 1.5rem 0 1rem 0;\">💡 Tips:</h3>\n            <ul style=\"margin-bottom: 1.5rem; padding-left: 1.5rem;\">\n                <li>Make sure your devices are in pairing mode before connecting</li>\n                <li>Data is automatically saved to your browser's local storage</li>\n                <li>Use the export functions to save your workout data</li>\n                <li>The app works offline once loaded</li>\n            </ul>\n        </div>\n\n        <div style=\"text-align: center; margin-top: 2rem;\">\n            <button id=\"closeInfoModal\" style=\"\n                background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);\n                color: white;\n                border: none;\n                padding: 12px 24px;\n                border-radius: 8px;\n                font-size: 16px;\n                font-weight: 600;\n                cursor: pointer;\n                transition: all 0.3s ease;\n            \">Got it!</button>\n        </div>\n    `;\n\n    modal.appendChild(modalContent);\n    document.body.appendChild(modal);\n\n    // Close modal event listeners\n    const closeButton = modalContent.querySelector('#closeInfoModal');\n    const closeModal = () => {\n        document.body.removeChild(modal);\n    };\n\n    closeButton.addEventListener('click', closeModal);\n    modal.addEventListener('click', (e) => {\n        if (e.target === modal) {\n            closeModal();\n        }\n    });\n\n    // Close on Escape key\n    const handleEscape = (e) => {\n        if (e.key === 'Escape') {\n            closeModal();\n            document.removeEventListener('keydown', handleEscape);\n        }\n    };\n    document.addEventListener('keydown', handleEscape);\n\n    // Add hover effect to button\n    closeButton.addEventListener('mouseenter', () => {\n        closeButton.style.transform = 'translateY(-2px)';\n        closeButton.style.boxShadow = '0 8px 24px rgba(52, 152, 219, 0.4)';\n    });\n\n    closeButton.addEventListener('mouseleave', () => {\n        closeButton.style.transform = 'translateY(0)';\n        closeButton.style.boxShadow = 'none';\n    });\n}\n\nexport { showAppInfo };","\n/**\n * Show QR code modal with link to the app\n */\nfunction showQrCodeModal() {\n    const appUrl = 'https://colscoding.github.io/power-saver/';\n\n    const modal = document.createElement('div');\n    modal.className = 'modal-backdrop';\n    modal.style.cssText = `\n        position: fixed;\n        top: 0;\n        left: 0;\n        width: 100%;\n        height: 100%;\n        background: rgba(0, 0, 0, 0.8);\n        display: flex;\n        justify-content: center;\n        align-items: center;\n        z-index: 1000;\n    `;\n\n    const modalContent = document.createElement('div');\n    modalContent.className = 'modal';\n    modalContent.style.cssText = `\n        background: #1a1a2e;\n        border-radius: 12px;\n        padding: 2rem;\n        max-width: 400px;\n        max-height: 80vh;\n        overflow-y: auto;\n        margin: 20px;\n        border: 1px solid rgba(255, 255, 255, 0.2);\n        text-align: center;\n    `;\n\n    // Create QR code canvas\n    const qrCanvas = document.createElement('canvas');\n    qrCanvas.width = 256;\n    qrCanvas.height = 256;\n    qrCanvas.style.cssText = `\n        background: white;\n        border-radius: 8px;\n        margin: 1rem 0;\n        max-width: 100%;\n        height: auto;\n    `;\n\n    // Generate QR code\n    generateQRCode(qrCanvas, appUrl);\n\n    modalContent.innerHTML = `\n        <div style=\"margin-bottom: 1.5rem;\">\n            <h2 style=\"color: #9b59b6; margin: 0 0 0.5rem 0; font-size: 1.8rem;\">📱 Share Power Meter App</h2>\n            <p style=\"color: #cccccc; margin: 0; font-size: 1rem;\">Scan to access the app on any device</p>\n        </div>\n        \n        <div id=\"qr-container\" style=\"margin: 1.5rem 0;\"></div>\n        \n        <div style=\"margin: 1.5rem 0;\">\n            <p style=\"color: #ffffff; margin: 0 0 0.5rem 0; font-weight: 600;\">Or visit directly:</p>\n            <a href=\"${appUrl}\" target=\"_blank\" style=\"\n                color: #9b59b6; \n                text-decoration: none; \n                font-size: 0.9rem;\n                word-break: break-all;\n                line-height: 1.4;\n            \">${appUrl}</a>\n        </div>\n\n        <div style=\"text-align: center; margin-top: 2rem;\">\n            <button id=\"closeQrModal\" style=\"\n                background: linear-gradient(135deg, #9b59b6 0%, #8e44ad 100%);\n                color: white;\n                border: none;\n                padding: 12px 24px;\n                border-radius: 8px;\n                font-size: 16px;\n                font-weight: 600;\n                cursor: pointer;\n                transition: all 0.3s ease;\n            \">Close</button>\n        </div>\n    `;\n\n    // Insert QR code canvas\n    const qrContainer = modalContent.querySelector('#qr-container');\n    qrContainer.appendChild(qrCanvas);\n\n    modal.appendChild(modalContent);\n    document.body.appendChild(modal);\n\n    // Close modal event listeners\n    const closeButton = modalContent.querySelector('#closeQrModal');\n    const closeModal = () => {\n        document.body.removeChild(modal);\n    };\n\n    closeButton.addEventListener('click', closeModal);\n    modal.addEventListener('click', (e) => {\n        if (e.target === modal) {\n            closeModal();\n        }\n    });\n\n    // Close on Escape key\n    const handleEscape = (e) => {\n        if (e.key === 'Escape') {\n            closeModal();\n            document.removeEventListener('keydown', handleEscape);\n        }\n    };\n    document.addEventListener('keydown', handleEscape);\n\n    // Add hover effect to button\n    closeButton.addEventListener('mouseenter', () => {\n        closeButton.style.transform = 'translateY(-2px)';\n        closeButton.style.boxShadow = '0 8px 24px rgba(155, 89, 182, 0.4)';\n    });\n\n    closeButton.addEventListener('mouseleave', () => {\n        closeButton.style.transform = 'translateY(0)';\n        closeButton.style.boxShadow = 'none';\n    });\n}\n\n/**\n * Generate QR code on canvas using a simple QR code generation algorithm\n */\nfunction generateQRCode(canvas, text) {\n    const ctx = canvas.getContext('2d');\n    const size = canvas.width;\n\n    // Clear canvas with white background\n    ctx.fillStyle = '#ffffff';\n    ctx.fillRect(0, 0, size, size);\n\n    // Simple QR code generation using an online QR code API as fallback\n    // For a production app, you'd want to include a proper QR code library\n    const qrApiUrl = `https://api.qrserver.com/v1/create-qr-code/?size=${size}x${size}&data=${encodeURIComponent(text)}`;\n\n    const img = new Image();\n    img.crossOrigin = 'anonymous';\n\n    img.onload = function () {\n        ctx.drawImage(img, 0, 0, size, size);\n    };\n\n    img.onerror = function () {\n        // Fallback: draw a simple pattern if QR API fails\n        drawFallbackQR(ctx, size);\n    };\n\n    img.src = qrApiUrl;\n}\n\n/**\n * Fallback QR code representation when API is unavailable\n */\nfunction drawFallbackQR(ctx, size) {\n    ctx.fillStyle = '#000000';\n    ctx.font = '12px Arial';\n    ctx.textAlign = 'center';\n\n    // Draw a simple grid pattern\n    const cellSize = size / 25;\n    for (let i = 0; i < 25; i++) {\n        for (let j = 0; j < 25; j++) {\n            if ((i + j) % 3 === 0 || i === 0 || i === 24 || j === 0 || j === 24) {\n                ctx.fillRect(i * cellSize, j * cellSize, cellSize, cellSize);\n            }\n        }\n    }\n\n    // Add text in center\n    ctx.fillStyle = '#ffffff';\n    ctx.fillRect(size * 0.2, size * 0.4, size * 0.6, size * 0.2);\n    ctx.fillStyle = '#000000';\n    ctx.fillText('QR Code', size / 2, size / 2 - 10);\n    ctx.fillText('Unavailable', size / 2, size / 2 + 10);\n}\n\nexport { showQrCodeModal };"],"names":["$d8d8e1ee9f4f63bb$var$avg10sCurrentElement","$d8d8e1ee9f4f63bb$var$avg10sBestElement","$d8d8e1ee9f4f63bb$var$avg20sCurrentElement","$d8d8e1ee9f4f63bb$var$avg20sBestElement","$d8d8e1ee9f4f63bb$var$avg30sCurrentElement","$d8d8e1ee9f4f63bb$var$avg30sBestElement","$d8d8e1ee9f4f63bb$var$avg40sCurrentElement","$d8d8e1ee9f4f63bb$var$avg40sBestElement","$d8d8e1ee9f4f63bb$var$avg50sCurrentElement","$d8d8e1ee9f4f63bb$var$avg50sBestElement","$d8d8e1ee9f4f63bb$var$avg1mCurrentElement","$d8d8e1ee9f4f63bb$var$avg1mBestElement","$d8d8e1ee9f4f63bb$var$avg2mCurrentElement","$d8d8e1ee9f4f63bb$var$avg2mBestElement","$d8d8e1ee9f4f63bb$var$avg3mCurrentElement","$d8d8e1ee9f4f63bb$var$avg3mBestElement","$d8d8e1ee9f4f63bb$var$avg4mCurrentElement","$d8d8e1ee9f4f63bb$var$avg4mBestElement","$d8d8e1ee9f4f63bb$var$avg5mCurrentElement","$d8d8e1ee9f4f63bb$var$avg5mBestElement","$cc35ee5c64337d79$var$SESSION_STORAGE_KEY","$cc35ee5c64337d79$export$3b97cfd23e0d13d8","dataStore","sessionData","timestamp","Date","now","powerData","heartData","cadenceData","rawPowerMeasurements","powerReadings","getPowerReadings","powerAverages","getPowerAverages","lastPowerValue","lastHeartRateValue","lastCadenceValue","sessionStartTime","localStorage","setItem","JSON","stringify","error","console","warn","$cc35ee5c64337d79$export$37b6cafab9b29f47","removeItem","$d8d8e1ee9f4f63bb$var$powerReadings","$d8d8e1ee9f4f63bb$var$powerAverages","current","best","$d8d8e1ee9f4f63bb$var$updatePowerAveragesDisplay","textContent","$d8d8e1ee9f4f63bb$export$153010588d52d05c","period","Object","keys","$26bf0f38c1315f82$export$7a5d735b2ab6389d","powerValueElement","hrValueElement","cadenceValueElement","deviceNameElement","hrDeviceName","cadenceDeviceName","statusText","hrStatusText","cadenceStatusText","hrConnectionStatus","cadenceConnectionStatus","powerMeterConnectButton","hrConnectButton","speedCadenceConnectButton","exportButtons","json","csv","tcx","rawJson","rawCsv","image","clearSession","googleDocs","googleSheets","googleAuth","configureGoogleApi","intervals","configureIntervals","powerAveragesSection","hamburgerBtn","menuDropdown","powerAveragesToggle","powerMetricToggle","heartRateMetricToggle","cadenceMetricToggle","showInfoMenuItem","showQrCodeMenuItem","spyModeToggle","powerCard","heartRateCard","cadenceCard","spyCard","spyModeSection","spyValueElement","spyStatusElement","spyInstructionsElement","$26bf0f38c1315f82$export$38408f60e368349d","value","displayValue","setAttribute","$26bf0f38c1315f82$export$d9870def68db0ffb","$26bf0f38c1315f82$export$b5051178064abb72","year","getFullYear","month","String","getMonth","padStart","day","getDate","$ee8dba17fe5eb4b4$export$1d0d101be0e1eace","navigator","$ee8dba17fe5eb4b4$var$wakeLock","wakeLock","request","addEventListener","log","err","name","message","$305aaf8b9a43c26d$var$CYCLING_POWER_SERVICE_UUID","$305aaf8b9a43c26d$var$CYCLING_POWER_MEASUREMENT_CHARACTERISTIC_UUID","$305aaf8b9a43c26d$var$CYCLING_CADENCE_SERVICE_UUID","$305aaf8b9a43c26d$var$powerMeterDevice","$305aaf8b9a43c26d$var$hrBluetoothDevice","$305aaf8b9a43c26d$var$speedCadenceBluetoothDevice","$305aaf8b9a43c26d$var$spyMeterDevice","$305aaf8b9a43c26d$var$lastCrankRevs","$305aaf8b9a43c26d$var$lastCrankTime","$305aaf8b9a43c26d$var$cadenceResetTimer","$305aaf8b9a43c26d$export$7cd63989f2e13954","callbacks","elements","bluetooth","onStatusUpdate","requestDevice","filters","services","$305aaf8b9a43c26d$var$onPowerMeterDisconnected","server","gatt","connect","service","getPrimaryService","characteristic","getCharacteristic","featureCharacteristic","readValue","startNotifications","event","target","rawMeasurement","flags","getUint16","rawBytes","Array","from","Uint8Array","buffer","map","b","toString","join","dataLength","byteLength","power","getInt16","instantaneousPower","onPowerMeasurement","disabled","removeEventListener","$305aaf8b9a43c26d$export$830e9b592dbab083","onHeartRateChange","hrServer","hrService","hrCharacteristic","heartRate","getUint8","$305aaf8b9a43c26d$export$15696ad475844a91","clearTimeout","onCadenceChange","$305aaf8b9a43c26d$var$handleSpeedCadenceMeasurement","offset","wheelRevsPresent","cumulativeCrankRevolutions","lastCrankEventTime","revs","time","roundedCadence","Math","round","setTimeout","$305aaf8b9a43c26d$export$bee1a28fa3cc4e9a","style","display","$305aaf8b9a43c26d$var$onSpyDisconnected","data","length","$305aaf8b9a43c26d$export$f8a9e6c57769fd82","connected","disconnect","onDisconnected","$bdf94e4d5edca10a$var$createTrackpoint","dataPoint","translations","toISOString","hr","trim","cadence","cad","pw","contents","key","undefined","filter","x","$d219c9d45f0beb41$export$a7718992a1148ad7","dataPoints","hrDataPoints","d","cadenceDataPoints","powerDataPoints","canvas","document","createElement","ctx","getContext","requiredHeight","values","some","avg","height","max","width","fillStyle","fillRect","font","textAlign","fillText","toLocaleDateString","toLocaleTimeString","durationMinutes","sessionSeconds","sessionEnd","yOffset","avgData","label","i","xBase","y","row","heartRates","maxHR","minHR","min","avgHR","reduce","a","cadences","maxCadence","minCadence","avgCadence","$d219c9d45f0beb41$var$drawTimelineChart","chartHeight","valueKey","color","unit","strokeStyle","lineWidth","strokeRect","v","minValue","maxValue","range","labelY","beginPath","firstPoint","point","chartX","chartY","moveTo","lineTo","stroke","floor","arc","PI","fill","gridY","startTime","endTime","middleTime","$8ca4b0f2a2d350fa$var$INTERVALS_CONFIG","BASE_URL","API_KEY","ATHLETE_ID","$8ca4b0f2a2d350fa$var$cloudExportState","isGoogleApiLoaded","isUserSignedIn","authInstance","lastError","isConfigured","apiKey","athleteId","lastUpload","$8ca4b0f2a2d350fa$export$ee1eca645500f8af","Error","Promise","resolve","reject","toBlob","blob","$8ca4b0f2a2d350fa$var$downloadFile","filename","Blob","url","URL","createObjectURL","href","download","body","appendChild","click","removeChild","revokeObjectURL","$8ca4b0f2a2d350fa$export$e4bd7e369fe3a1ee","signIn","isSignedIn","get","$8ca4b0f2a2d350fa$export$6ec42103ddca7218","signOut","$8ca4b0f2a2d350fa$export$abbccf31f198d0dc","$8ca4b0f2a2d350fa$export$7eff8e3a92135016","activityName","description","tcxContent","$8ca4b0f2a2d350fa$var$generateIntervalsCompatibleTCX","lapStats","$8ca4b0f2a2d350fa$var$calculateLapStatistics","totalTime","distance","maxSpeed","calories","avgHeartRate","maxHeartRate","avgPower","maxPower","getTime","powers","p","estimatedSpeed","sqrt","forEach","activityId","$8ca4b0f2a2d350fa$var$uploadToIntervals","type","metadata","formData","FormData","tcxBlob","append","response","fetch","method","headers","btoa","ok","errorText","text","status","result","id","activity_id","$8ca4b0f2a2d350fa$export$33ba7bf2bc167957","sessionDate","documentTitle","documentContent","$8ca4b0f2a2d350fa$var$generateGoogleDocsContent","requests","insertIndex","headerText","push","insertText","location","index","updateTextStyle","startIndex","endIndex","indexOf","textStyle","bold","fontSize","magnitude","fields","summaryText","$8ca4b0f2a2d350fa$var$generateSessionSummary","duration","$8ca4b0f2a2d350fa$var$calculateSessionDuration","firstTimestamp","lastTimestamp","stats","$8ca4b0f2a2d350fa$var$calculateSessionStats","minPower","c","summary","$8ca4b0f2a2d350fa$var$formatDuration","seconds","minutes","hours","toFixed","fiveSecond","thirtySecond","oneMinute","fiveMinute","tableData","$8ca4b0f2a2d350fa$var$generateDocumentTable","table","slice","insertTable","rows","columns","documentId","window","gapi","client","docs","documents","create","resource","title","batchUpdate","documentUrl","open","$8ca4b0f2a2d350fa$export$c2a66907bba54045","rawMeasurements","spreadsheetTitle","spreadsheetId","sheets","spreadsheets","properties","gridProperties","rowCount","columnCount","summaryData","$8ca4b0f2a2d350fa$var$generateSheetsData","rawData","valueInputOption","$8ca4b0f2a2d350fa$var$formatGoogleSheet","spreadsheetUrl","$8ca4b0f2a2d350fa$var$generateSummarySheetData","$8ca4b0f2a2d350fa$var$generateRawSheetData","measurement","repeatCell","sheetId","startRowIndex","endRowIndex","cell","userEnteredFormat","backgroundColor","red","green","blue","textFormat","autoResizeDimensions","dimensions","dimension","$8ca4b0f2a2d350fa$var$testIntervalsConnection","success","athleteData","athleteName","username","$1fea2fc27e5705f2$var$createExportModal","modal","className","innerHTML","closeBtn","querySelector","$1fea2fc27e5705f2$var$closeModal","e","$1fea2fc27e5705f2$var$addButtonsToModal","buttons","buttonsContainer","buttonConfig","button","onClick","$1fea2fc27e5705f2$var$showModal","requestAnimationFrame","classList","add","remove","parentNode","$d455cb11b3bc64fd$var$manageCollapsedSectionsLayout","dashboard","existingRow","sectionsInRow","querySelectorAll","section","insertBefore","nextSibling","$b63be9b0371e788c$var$powerData","$b63be9b0371e788c$var$rawPowerMeasurements","$b63be9b0371e788c$var$heartData","$b63be9b0371e788c$var$cadenceData","$b63be9b0371e788c$var$lastPowerValue","$b63be9b0371e788c$var$lastHeartRateValue","$b63be9b0371e788c$var$lastCadenceValue","$b63be9b0371e788c$var$sessionStartTime","$b63be9b0371e788c$var$dataLoggerInterval","$b63be9b0371e788c$var$dataStore","resetAllSessionData","$b63be9b0371e788c$var$powerMeterCallbacks","fiveMinutesAgo","reading","$d8d8e1ee9f4f63bb$var$calculatePowerAverages","periodKey","periodMs","entries","cutoffTime","relevantReadings","average","sum","total","clearInterval","$b63be9b0371e788c$var$heartRateCallbacks","$b63be9b0371e788c$var$cadenceCallbacks","$b63be9b0371e788c$var$initializeApp","getElementById","powerAveragesHidden","contains","closest","powerAveragesVisible","powerMetricVisible","heartRateMetricVisible","cadenceMetricVisible","disconnectSpyCallback","spyModeVisible","cssText","modalContent","closeButton","closeModal","handleEscape","transform","boxShadow","appUrl","qrCanvas","$0efb00cee77cf568$var$generateQRCode","size","qrApiUrl","encodeURIComponent","img","Image","crossOrigin","onload","drawImage","onerror","cellSize","j","src","qrContainer","setInterval","$1fea2fc27e5705f2$var$initializeExportSection","exportSection","$1fea2fc27e5705f2$var$setupExportSectionToggle","toggleHeader","toggle","basicMenuItem","isArray","csvContent","validDataPoints","isNaN","processedData","item","sort","isEmptyPower","shift","pop","trackpoints","startTimeISO","alert","cloudMenuItem","$1fea2fc27e5705f2$export$bcd78b1167a6af4b","backdrop","currentClientId","getItem","currentApiKey","clientId","reload","focus","servicesMenuItem","currentAthleteId","testResult","$8ca4b0f2a2d350fa$export$1aa14f7a5d6e27b0","cleanApiKey","cleanAthleteId","utilsMenuItem","confirm","savedData","parse","sessionAge","dataCount","$b63be9b0371e788c$var$restoreSessionData","averages","assign","dataPointCount","notification","head","animation"],"version":3,"file":"power-saver.2f5402b7.js.map"}